<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="https://ros-infrastructure.github.io/index.ros.org//r/turtlebot2_demo/">
    
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/sphinx.css">
    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie-1.4.1/jquery.cookie.js type="text/javascript"></script>

    <script type="text/javascript" src=/js/ga.js async></script>
    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">

      <div align="center">
        <br>
        <table id="topnav-table">
          <tr>
            <td valign="middle">
                ROS Resources:
              <a href="http://wiki.ros.org/">Documentation</a>
              |
              <a href="http://wiki.ros.org/Support">Support</a>
              |
              <a href="http://discourse.ros.org/">Discussion Forum</a>
              |
              <a href="http://status.ros.org/">Service Status</a>
              |
              <a href="http://answers.ros.org/">Q&A answers.ros.org</a>
            </td>
          </tr>
        </table> <!-- topnav-table -->
      </div>

      <div class="row">

        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/ros-infrastructure/rosindex/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <ul class="list-inline" style="margin-bottom:0px;">
                <li><a class="btn btn-link" href="/about">About</a></li>

                <li class="dropdown">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Index <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li><a href="/packages/page/1/time/">Package List</a></li>
                    <li><a href="/repos/page/1/time/">Repository List</a></li>

                    <li class="hidden" class="divider"></li>


                    <li class="hidden"><a href="/srvs/">Nodes</a></li>
                    <li class="hidden"><a href="/msgs/">Messages</a></li>
                    <li class="hidden"><a href="/srvs/">Services</a></li>
                    <li class="hidden"><a href="/srvs/">Plugins</a></li>

                    <li class="divider"></li>

                    <li><a href="/deps/">System Dependencies</a></li>
                  </ul>
                </li>

                <li class="dropdown disabled">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Doc <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    
                    <li>
                      <a href="/doc/ros2">
                        ROS2 Overview
                      </a>
                    </li>
                    
                    <li class="hidden" class="divider"></li>

                    <li class="hidden"><a href="/doc/tutorials">Tutorials</a></li>
                    <li class="hidden"><a href="/doc/readmes">Readmes</a></li>
                    <li class="hidden"><a href="/doc/apis">APIs</a></li>
                  </ul>
                </li>

                <li><a class="btn btn-link" href="/contribute">Contribute</a></li>
                <li><a class="btn btn-link" href="/stats">Stats</a></li>
              </ul>

            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form id="top-searchbox" action="/search/" role="form" method="get">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="term" placeholder="Search ROS">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" title="Search ROS" type="submit">
                  <span class="glyphicon glyphicon-search"></span>
                </button>
                <a href="https://lunrjs.com/guides/searching.html"
                   title="Help to Search" class="btn btn-default btn-sm">
                  <span class="glyphicon glyphicon-question-sign"></span>
                </a>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>
  <script type="text/javascript">
    $('#top-searchbox').submit(function() {
        return $('#top-searchbox input:text').filter(function() {
          return $(this).val() == "";
        }).length == 0;
    });
  </script>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">turtlebot2_demo</li>
        <!--<li class="active">turtlebot2_demo</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="crystal-option" class="distro-button btn btn-xs btn-default" href="#crystal" data="crystal">
      <input type="radio" name="options" id="crystal-radio" autocomplete="off"> crystal
    </label>
  
    <label id="bouncy-option" class="distro-button btn btn-xs btn-primary" href="#bouncy" data="bouncy">
      <input type="radio" name="options" id="bouncy-radio" autocomplete="off"> bouncy
    </label>
  
    <label id="melodic-option" class="distro-button btn btn-xs btn-default" href="#melodic" data="melodic">
      <input type="radio" name="options" id="melodic-radio" autocomplete="off"> melodic
    </label>
  
    <label id="lunar-option" class="distro-button btn btn-xs btn-default" href="#lunar" data="lunar">
      <input type="radio" name="options" id="lunar-radio" autocomplete="off"> lunar
    </label>
  
    <label id="kinetic-option" class="distro-button btn btn-xs btn-default" href="#kinetic" data="kinetic">
      <input type="radio" name="options" id="kinetic-radio" autocomplete="off"> kinetic
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-default" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="ardent" id="ardent-option" class=" older-distro-option"  href="#ardent">
          <a href="#ardent" data="ardent" id="ardent-button">ardent</a>
        </li>
      
        <li data="jade" id="jade-option" class="disabled older-distro-option"  href="#jade">
          <a href="#jade" data="jade" id="jade-button">jade</a>
        </li>
      
        <li data="hydro" id="hydro-option" class="disabled older-distro-option"  href="#hydro">
          <a href="#hydro" data="hydro" id="hydro-button">hydro</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/turtlebot2_demo">turtlebot2_demo</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/turtlebot2_demo"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-turtlebot2_demo
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-turtlebot2_demo" role="menuitem" tabindex="-1" href="/r/turtlebot2_demo/github-ros2-turtlebot2_demo" data="github-ros2-turtlebot2_demo">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-turtlebot2_demo
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-crystal">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>crystal</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-bouncy">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/turtlebot2_demo.git">https://github.com/ros2/turtlebot2_demo.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">bouncy</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-07-20
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/depthimage_to_pointcloud2/github-ros2-turtlebot2_demo">depthimage_to_pointcloud2</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_amcl/github-ros2-turtlebot2_demo">turtlebot2_amcl</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_cartographer/github-ros2-turtlebot2_demo">turtlebot2_cartographer</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_demo/github-ros2-turtlebot2_demo">turtlebot2_demo</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_drivers/github-ros2-turtlebot2_demo">turtlebot2_drivers</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_follower/github-ros2-turtlebot2_demo">turtlebot2_follower</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_teleop/github-ros2-turtlebot2_demo">turtlebot2_teleop</a></td>
                    <td>0.5.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>This repository contains the code and supporting files to run TurtleBot 2 demos using ROS 2. Due to reliance on existing Linux-only code and dependencies, these demos are intended for use only on Linux (that could change in the future).</p>

<!-- Here's a video of the very first successful run of ROS 2 follower: https://www.youtube.com/watch?v=YTlls9yHZog.

This is very much a work in progress and there's plenty of functionality present in the ROS 1 equivalent system that's currently missing or disabled, but it's an important step. -->

<p>This demo assumes that you have an Orbbec Astra depth camera. Extra work would be required to use the Kinect or Asus Xtion Pro. Without an Astra, you can still do joystick teleop.
For instructions on how to setup your turtlebot please see <a href="https://github.com/ros2/turtlebot2_demo/blob/master/Turtlebot_Setup.md">Setup your turtlebot2</a></p>

<h1 id="installation">Installation</h1>

<h2 id="installation-from-binaries">Installation from binaries</h2>

<p>First, install ROS2 from binaries following <a href="https://github.com/ros2/ros2/wiki/Linux-Install-Debians">these instructions</a></p>

<p>Then install the turtlebo2 demo specific packages:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt install ros-ardent-turtlebot2* ros-kinetic-kobuki-ftdi

</code></pre></div>
<h2 id="installation-from-source">Installation from source</h2>

<p>This assumes that you have ROS Kinetic installed (or at lease have the ros apt repository in your sources)</p>

<p>First, install ROS2 from source following <a href="https://github.com/ros2/ros2/wiki/Linux-Development-Setup">these instructions</a></p>

<p>Then get the turtlebo2 demos specific code:</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd &lt;YOUR_ROS2_WORKSPACE&gt;
wget https://raw.githubusercontent.com/ros2/turtlebot2_demo/ardent/turtlebot2_demo.repos
vcs import src &lt; turtlebot2_demo.repos

</code></pre></div>
<h3 id="install-some-dependencies">Install some dependencies:</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">--no-install-recommends</span> <span class="nt">-y</span> libboost-iostreams-dev libboost-regex-dev libboost-system-dev libboost-thread-dev libceres-dev libgoogle-glog-dev liblua5.2-dev libpcl-dev libprotobuf-dev libsdl1.2-dev libsdl-image1.2-dev libsuitesparse-dev libudev-dev libusb-1.0-0-dev libyaml-cpp-dev protobuf-compiler python-sphinx ros-kinetic-kobuki-driver ros-kinetic-kobuki-ftdi

</code></pre></div>
<p>Reason for each dependency:
* <code>ros-kinetic-kobuki-driver</code> : our ROS 2 kobuki driver builds on top of this package (and its dependencies)
* <code>ros-kinetic-kobuki-ftdi</code> : we use a <code>udev</code> rule from this package
* <code>ros-kinetic-common-msgs</code> : to support use of the <code>ros1_bridge</code>, we need the ROS 1 messages available (TODO: document use of the bridge to view depth images and other stuff)
* <code>ros-kinetic-astra-camera</code> : we're compiling our own ROS 2 fork of this package, so we don't actually need the ROS 1 version; we're installing it as a convenient way to ensure that all of its dependencies are installed</p>

<h3 id="build-the-ros2-code">Build the ros2 code</h3>

<p>For resource constrained platforms we will split the build into 2 steps to make sure not to overflow the memory</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">src/ament/ament_tools/scripts/ament.py build <span class="nt">--isolated</span> <span class="nt">--symlink-install</span> <span class="nt">--parallel</span> <span class="nt">--skip-packages</span> cartographer cartographer_ros ros1_bridge turtlebot2_amcl turtlebot2_drivers turtlebot2_follower turtlebot2_cartographer turtlebot2_teleop

</code></pre></div>
<p>Now the resource intensive packages and the ones depending on ROS1 packages:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
src/ament/ament_tools/scripts/ament.py build <span class="nt">--isolated</span> <span class="nt">--symlink-install</span> <span class="nt">--parallel</span> <span class="nt">--only</span> cartographer cartographer_ros turtlebot2_amcl turtlebot2_cartographer turtlebot2_drivers turtlebot2_follower turtlebot2_teleop <span class="nt">--make-flags</span> <span class="nt">-j2</span> <span class="nt">-l2</span>

</code></pre></div>
<p>Go grab a coffee (or a meal if you compile on ARM)</p>

<h1 id="configure-a-couple-of-things">Configure a couple of things</h1>

<h2 id="setup-the-udev-rules">Setup the udev rules</h2>

<h3 id="copy-the-astra-udev-rules">Copy the astra udev rules</h3>

<h4 id="if-you-installed-from-binaries">If you installed from binaries</h4>

<p>If you installed from binary you'll need to download the udev rule by hand:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">wget https://raw.githubusercontent.com/ros2/ros_astra_camera/ros2/56-orbbec-usb.rules

</code></pre></div>
<h4 id="if-you-installed-from-source">If you installed from source</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/ros2_ws/src/ros2/ros_astra_camera

</code></pre></div>
<h4 id="copy-the-rules-file">Copy the rules file</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo cp </span>56-orbbec-usb.rules /etc/udev/rules.d

</code></pre></div>
<h3 id="copy-the-kobuki-udev-rule">Copy the kobuki udev rule</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo cp</span> <span class="sb">`</span>rospack find kobuki_ftdi<span class="sb">`</span>/57-kobuki.rules /etc/udev/rules.d

</code></pre></div>
<h3 id="restart-the-udev-service">Restart the udev service</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>service udev reload
<span class="nb">sudo </span>service udev restart

</code></pre></div>
<h2 id="source-your-workspace">Source your workspace</h2>

<p>If installed from Debian packages</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
<span class="nb">source</span> /opt/ros/ardent/setup.bash

</code></pre></div>
<p>If installed from source</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
<span class="nb">source</span> ~/ros2_ws/install/local_setup.bash

</code></pre></div>
<p>You'll need to do this step for every terminal you use for these demos</p>

<h1 id="run-the-demos">Run the demos</h1>

<h2 id="joystick-teleop">Joystick teleop</h2>

<p>This is a classic teleoperation demo where the robot can be driven around using a gamepad controller. Thie demo has been tested with logitech controllers and uses <code>RB</code> as a deadman, the left joystick for driving forward/backward and the right joystick for rotation.
Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_teleop`/share/turtlebot2_teleop/launch/turtlebot_joy.py

</code></pre></div>
<p>Or, run the nodes separately:</p>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_drivers kobuki_node

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run joy joy_node

</code></pre></div>
<p>Note: this demo assumes that your controller is in D mode (switch on the back) and that the MODE led is on. </p>

<h2 id="follower">Follower</h2>

<p>This demo uses the astra camera to detect blobs in the depthimage and follow them
Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_follower`/share/turtlebot2_follower/launch/turtlebot_follow.py

</code></pre></div>
<p>Or, run the nodes separately.</p>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_drivers kobuki_node

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run astra_camera astra_camera_node -- -dw 320 -dh 240 -C -I

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_follower follower

</code></pre></div>
<h2 id="cartographer-mapping">Cartographer (mapping)</h2>

<p>This demo is using Google cartographer to build a map of the environment. The resulting map can be visualized in RViz using the ros1_bridge (more information below).</p>

<h3 id="run-the-demo">Run the demo</h3>

<p>Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_cartographer`/share/turtlebot2_cartographer/launch/turtlebot_carto_2d.py

</code></pre></div>
<h3 id="visualize-the-results">Visualize the results</h3>

<p>The created map can be visualized in Rviz on a remote computer by using the dynamic bridge that converts messages between ROS1 and ROS2.
This assumes that you have a ROS2 dynamic bridge on your system.</p>

<h4 id="installing-the-bridge">Installing the bridge</h4>

<h5 id="from-binaries">From binaries:</h5>

<p>Setup your sources as explained on the <a href="https://github.com/ros2/ros2/wiki/Linux-Install-Debians#setup-sources">setup sources section</a> and then run</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>ros-ardent-ros1-bridge

</code></pre></div>
<h5 id="from-source">From source:</h5>

<p>Build your ROS2 workspace as explained in <a href="https://github.com/ros2/ros1_bridge/blob/master/README.md#build-the-bridge-from-source">these instructions</a>.</p>

<h4 id="run-the-bridge">Run the bridge</h4>

<p>Terminal A:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
roscore

</code></pre></div>
<p>Terminal B:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
<span class="nb">.</span> &lt;YOUR_ROS2_WORKSPACE&gt;
ros2 run ros1_bridge dynamic_bridge

</code></pre></div>
<p>Terminal C:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
rosrun rviz rviz

</code></pre></div>
<p>Topics you can visualize in Rviz:
- the map on the topic <code>/map</code>
- the transforms on the topic <code>/tf</code>
- the depth images on the topic <code>/depth</code>
- the laserscans on the topic <code>/scans</code></p>

<h2 id="amcl-localization">AMCL (localization)</h2>

<p>See the <a href="https://github.com/ros2/turtlebot2_demo/blob/master/turtlebot2_amcl/README.md">AMCL demo README</a></p>

<h1 id="discussion">Discussion</h1>

<p>What's happening here compared to the ROS 1 versions of these demos? Well, it's 100% ROS 2, with no bridge or shim. We took 4 different
approaches in building the different pieces:</p>

<ol>
<li>Kobuki driver: we wrote a new, very small rclcpp node that calls into the existing kobuki driver packages, which are organized to be roscpp-independent. In this case, we're building on top of ROS 1 packages, but they don't use <code>roscpp</code> or other parts of the ROS 1 middleware, so we're just using them as supporting libraries.</li>
<li>Astra driver: we forked and ported the existing ROS 1 package (there's no roscpp-independent package separation).</li>
<li>Joystick driver: we wrote a simple rclcpp node from scratch (Linux-only for now).</li>
<li>Follower node: we created a new package into which we copied and then ported the ROS 1 follower nodelet.</li>
</ol>

<p>As we start migrating more code to ROS 2, we'll discover more about these kinds of techniques and arrive at some best practices that we can recommend for similar projects.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-lunar">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>lunar</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kinetic">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>kinetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>indigo</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-ardent">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/turtlebot2_demo.git">https://github.com/ros2/turtlebot2_demo.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ardent</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-07-20
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/depthimage_to_pointcloud2/github-ros2-turtlebot2_demo">depthimage_to_pointcloud2</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_amcl/github-ros2-turtlebot2_demo">turtlebot2_amcl</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_cartographer/github-ros2-turtlebot2_demo">turtlebot2_cartographer</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_demo/github-ros2-turtlebot2_demo">turtlebot2_demo</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_drivers/github-ros2-turtlebot2_demo">turtlebot2_drivers</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_follower/github-ros2-turtlebot2_demo">turtlebot2_follower</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/turtlebot2_teleop/github-ros2-turtlebot2_demo">turtlebot2_teleop</a></td>
                    <td>0.4.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>This repository contains the code and supporting files to run TurtleBot 2 demos using ROS 2. Due to reliance on existing Linux-only code and dependencies, these demos are intended for use only on Linux (that could change in the future).</p>

<!-- Here's a video of the very first successful run of ROS 2 follower: https://www.youtube.com/watch?v=YTlls9yHZog.

This is very much a work in progress and there's plenty of functionality present in the ROS 1 equivalent system that's currently missing or disabled, but it's an important step. -->

<p>This demo assumes that you have an Orbbec Astra depth camera. Extra work would be required to use the Kinect or Asus Xtion Pro. Without an Astra, you can still do joystick teleop.
For instructions on how to setup your turtlebot please see <a href="https://github.com/ros2/turtlebot2_demo/blob/master/Turtlebot_Setup.md">Setup your turtlebot2</a></p>

<h1 id="installation">Installation</h1>

<h2 id="installation-from-binaries">Installation from binaries</h2>

<p>First, install ROS2 from binaries following <a href="https://github.com/ros2/ros2/wiki/Linux-Install-Debians">these instructions</a></p>

<p>Then install the turtlebo2 demo specific packages:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt install ros-r2b2-turtlebot2* ros-kinetic-kobuki-ftdi

</code></pre></div>
<h2 id="installation-from-source">Installation from source</h2>

<p>This assumes that you have ROS Kinetic installed (or at lease have the ros apt repository in your sources)</p>

<p>First, install ROS2 from source following <a href="https://github.com/ros2/ros2/wiki/Linux-Development-Setup">these instructions</a></p>

<p>Then get the turtlebo2 demos specific code:</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd &lt;YOUR_ROS2_WORKSPACE&gt;
wget https://raw.githubusercontent.com/ros2/turtlebot2_demo/release-latest/turtlebot2_demo.repos
vcs import src &lt; turtlebot2_demo.repos

</code></pre></div>
<h3 id="install-some-dependencies">Install some dependencies:</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">--no-install-recommends</span> <span class="nt">-y</span> libboost-iostreams-dev libboost-regex-dev libboost-system-dev libboost-thread-dev libceres-dev libgoogle-glog-dev liblua5.2-dev libpcl-dev libprotobuf-dev libsdl1.2-dev libsdl-image1.2-dev libsuitesparse-dev libudev-dev libusb-1.0.0-dev libyaml-cpp-dev protobuf-compiler python-sphinx ros-kinetic-kobuki-driver ros-kinetic-kobuki-ftdi

</code></pre></div>
<p>Reason for each dependency:
* <code>ros-kinetic-kobuki-driver</code> : our ROS 2 kobuki driver builds on top of this package (and its dependencies)
* <code>ros-kinetic-kobuki-ftdi</code> : we use a <code>udev</code> rule from this package
* <code>ros-kinetic-common-msgs</code> : to support use of the <code>ros1_bridge</code>, we need the ROS 1 messages available (TODO: document use of the bridge to view depth images and other stuff)
* <code>ros-kinetic-astra-camera</code> : we're compiling our own ROS 2 fork of this package, so we don't actually need the ROS 1 version; we're installing it as a convenient way to ensure that all of its dependencies are installed</p>

<h3 id="build-the-ros2-code">Build the ros2 code</h3>

<p>For resource constrained platforms we will split the build into 2 steps to make sure not to overflow the memory</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">src/ament/ament_tools/scripts/ament.py build <span class="nt">--isolated</span> <span class="nt">--symlink-install</span> <span class="nt">--parallel</span> <span class="nt">--skip-packages</span> cartographer cartographer_ros ros1_bridge turtlebot2_amcl turtlebot2_drivers turtlebot2_follower turtlebot2_cartographer turtlebot2_teleop

</code></pre></div>
<p>Now the resource intensive packages and the ones depending on ROS1 packages:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
src/ament/ament_tools/scripts/ament.py build <span class="nt">--isolated</span> <span class="nt">--symlink-install</span> <span class="nt">--parallel</span> <span class="nt">--only</span> cartographer cartographer_ros turtlebot2_amcl turtlebot2_cartographer turtlebot2_drivers turtlebot2_follower turtlebot2_teleop <span class="nt">--make-flags</span> <span class="nt">-j2</span> <span class="nt">-l2</span>

</code></pre></div>
<p>Go grab a coffee (or a meal if you compile on ARM)</p>

<h1 id="configure-a-couple-of-things">Configure a couple of things</h1>

<h2 id="setup-the-udev-rules">Setup the udev rules</h2>

<h3 id="copy-the-astra-udev-rules">Copy the astra udev rules</h3>

<h4 id="if-you-installed-from-binaries">If you installed from binaries</h4>

<p>If you installed from binary you'll need to download the udev rule by hand:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">wget https://raw.githubusercontent.com/ros2/ros_astra_camera/ros2/56-orbbec-usb.rules

</code></pre></div>
<h4 id="if-you-installed-from-source">If you installed from source</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/ros2_ws/src/ros_astra_camera

</code></pre></div>
<h4 id="copy-the-rules-file">Copy the rules file</h4>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo cp </span>56-orbbec-usb.rules /etc/udev/rules.d

</code></pre></div>
<h3 id="copy-the-kobuki-udev-rule">Copy the kobuki udev rule</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo cp</span> <span class="sb">`</span>rospack find kobuki_ftdi<span class="sb">`</span>/57-kobuki.rules /etc/udev/rules.d

</code></pre></div>
<h3 id="restart-the-udev-service">Restart the udev service</h3>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>service udev reload
<span class="nb">sudo </span>service udev restart

</code></pre></div>
<h2 id="source-your-workspace">Source your workspace</h2>

<p>If installed from Debian packages</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
<span class="nb">source</span> /opt/ros/r2b2/setup.bash

</code></pre></div>
<p>If installed from source</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">source</span> /opt/ros/kinetic/setup.bash
<span class="nb">source</span> ~/ros2_ws/install/local_setup.bash

</code></pre></div>
<p>You'll need to do this step for every terminal you use for these demos</p>

<h1 id="run-the-demos">Run the demos</h1>

<h2 id="joystick-teleop">Joystick teleop</h2>

<p>This is a classic teleoperation demo where the robot can be driven around using a gamepad controller. Thie demo has been tested with logitech controllers and uses <code>RB</code> as a deadman, the left joystick for driving forward/backward and the right joystick for rotation.
Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_teleop`/share/turtlebot2_teleop/launch/turtlebot_joy.py

</code></pre></div>
<p>Or, run the nodes separately:</p>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_drivers kobuki_node

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run joy joy_node

</code></pre></div>
<p>Note: this demo assumes that your controller is in D mode (switch on the back) and that the MODE led is on. </p>

<h2 id="follower">Follower</h2>

<p>This demo uses the astra camera to detect blobs in the depthimage and follow them
Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_follower`/share/turtlebot2_follower/launch/turtlebot_follow.py

</code></pre></div>
<p>Or, run the nodes separately.</p>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_drivers kobuki_node

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run astra_camera astra_camera_node -- -dw 320 -dh 240 -C -I

</code></pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">ros2 run turtlebot2_follower follower

</code></pre></div>
<h2 id="cartographer-mapping">Cartographer (mapping)</h2>

<p>This demo is using Google cartographer to build a map of the environment. The resulting map can be visualized in RViz using the ros1_bridge (more information below).</p>

<h3 id="run-the-demo">Run the demo</h3>

<p>Try the launch file:</p>
<div class="highlight"><pre><code class="language-" data-lang="">launch `ros2 pkg prefix turtlebot2_cartographer`/share/turtlebot2_cartographer/launch/turtlebot_carto_2d.py

</code></pre></div>
<h3 id="visualize-the-results">Visualize the results</h3>

<p>The created map can be visualized in Rviz on a remote computer by using the dynamic bridge that converts messages between ROS1 and ROS2.
This assumes that you have a ROS2 dynamic bridge on your system.</p>

<h4 id="installing-the-bridge">Installing the bridge</h4>

<h5 id="from-binaries">From binaries:</h5>

<p>Setup your sources as explained on the <a href="https://github.com/ros2/ros2/wiki/Linux-Install-Debians#setup-sources">setup sources section</a> and then run</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>ros-r2b2-ros1-bridge

</code></pre></div>
<h5 id="from-source">From source:</h5>

<p>Build your ROS2 workspace as explained in <a href="https://github.com/ros2/ros1_bridge/blob/master/README.md#build-the-bridge-from-source">these instructions</a>.</p>

<h4 id="run-the-bridge">Run the bridge</h4>

<p>Terminal A:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
roscore

</code></pre></div>
<p>Terminal B:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
<span class="nb">.</span> &lt;YOUR_ROS2_WORKSPACE&gt;
ros2 run ros1_bridge dynamic_bridge

</code></pre></div>
<p>Terminal C:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">.</span> /opt/ros/kinetic/setup.bash
rosrun rviz rviz

</code></pre></div>
<p>Topics you can visualize in Rviz:
- the map on the topic <code>/map</code>
- the transforms on the topic <code>/tf</code>
- the depth images on the topic <code>/depth</code>
- the laserscans on the topic <code>/scans</code></p>

<h2 id="amcl-localization">AMCL (localization)</h2>

<p>See the <a href="https://github.com/ros2/turtlebot2_demo/blob/master/turtlebot2_amcl/README.md">AMCL demo README</a></p>

<h1 id="discussion">Discussion</h1>

<p>What's happening here compared to the ROS 1 versions of these demos? Well, it's 100% ROS 2, with no bridge or shim. We took 4 different
approaches in building the different pieces:</p>

<ol>
<li>Kobuki driver: we wrote a new, very small rclcpp node that calls into the existing kobuki driver packages, which are organized to be roscpp-independent. In this case, we're building on top of ROS 1 packages, but they don't use <code>roscpp</code> or other parts of the ROS 1 middleware, so we're just using them as supporting libraries.</li>
<li>Astra driver: we forked and ported the existing ROS 1 package (there's no roscpp-independent package separation).</li>
<li>Joystick driver: we wrote a simple rclcpp node from scratch (Linux-only for now).</li>
<li>Follower node: we created a new package into which we copied and then ported the ROS 1 follower nodelet.</li>
</ol>

<p>As we start migrating more code to ROS 2, we'll discover more about these kinds of techniques and arrive at some best practices that we can recommend for similar projects.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("crystal");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/ros-infrastructure" title="Find rosindex in Github">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">ros-infrastructure</span>
          </a>
          |
          <em>generated on 2019-05-24</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
