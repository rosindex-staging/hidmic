<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="https://ros-infrastructure.github.io/index.ros.org//r/qb_hand/">
    
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/sphinx.css">
    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie-1.4.1/jquery.cookie.js type="text/javascript"></script>

    <script type="text/javascript" src=/js/ga.js async></script>
    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">

      <div align="center">
        <br>
        <table id="topnav-table">
          <tr>
            <td valign="middle">
                ROS Resources:
              <a href="http://wiki.ros.org/">Documentation</a>
              |
              <a href="http://wiki.ros.org/Support">Support</a>
              |
              <a href="http://discourse.ros.org/">Discussion Forum</a>
              |
              <a href="http://status.ros.org/">Service Status</a>
              |
              <a href="http://answers.ros.org/">Q&A answers.ros.org</a>
            </td>
          </tr>
        </table> <!-- topnav-table -->
      </div>

      <div class="row">

        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/ros-infrastructure/rosindex/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <ul class="list-inline" style="margin-bottom:0px;">
                <li><a class="btn btn-link" href="/about">About</a></li>

                <li class="dropdown">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Index <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li><a href="/packages/page/1/time/">Package List</a></li>
                    <li><a href="/repos/page/1/time/">Repository List</a></li>

                    <li class="hidden" class="divider"></li>


                    <li class="hidden"><a href="/srvs/">Nodes</a></li>
                    <li class="hidden"><a href="/msgs/">Messages</a></li>
                    <li class="hidden"><a href="/srvs/">Services</a></li>
                    <li class="hidden"><a href="/srvs/">Plugins</a></li>

                    <li class="divider"></li>

                    <li><a href="/deps/">System Dependencies</a></li>
                  </ul>
                </li>

                <li class="dropdown disabled">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Doc <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    
                    <li>
                      <a href="/doc/ros2">
                        ROS2 Overview
                      </a>
                    </li>
                    
                    <li class="hidden" class="divider"></li>

                    <li class="hidden"><a href="/doc/tutorials">Tutorials</a></li>
                    <li class="hidden"><a href="/doc/readmes">Readmes</a></li>
                    <li class="hidden"><a href="/doc/apis">APIs</a></li>
                  </ul>
                </li>

                <li><a class="btn btn-link" href="/contribute">Contribute</a></li>
                <li><a class="btn btn-link" href="/stats">Stats</a></li>
              </ul>

            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form id="top-searchbox" action="/search/" role="form" method="get">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="term" placeholder="Search ROS">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" title="Search ROS" type="submit">
                  <span class="glyphicon glyphicon-search"></span>
                </button>
                <a href="https://lunrjs.com/guides/searching.html"
                   title="Help to Search" class="btn btn-default btn-sm">
                  <span class="glyphicon glyphicon-question-sign"></span>
                </a>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>
  <script type="text/javascript">
    $('#top-searchbox').submit(function() {
        return $('#top-searchbox input:text').filter(function() {
          return $(this).val() == "";
        }).length == 0;
    });
  </script>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">qb_hand</li>
        <!--<li class="active">qb_hand</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="crystal-option" class="distro-button btn btn-xs btn-default" href="#crystal" data="crystal">
      <input type="radio" name="options" id="crystal-radio" autocomplete="off"> crystal
    </label>
  
    <label id="bouncy-option" class="distro-button btn btn-xs btn-default" href="#bouncy" data="bouncy">
      <input type="radio" name="options" id="bouncy-radio" autocomplete="off"> bouncy
    </label>
  
    <label id="melodic-option" class="distro-button btn btn-xs btn-primary" href="#melodic" data="melodic">
      <input type="radio" name="options" id="melodic-radio" autocomplete="off"> melodic
    </label>
  
    <label id="lunar-option" class="distro-button btn btn-xs btn-primary" href="#lunar" data="lunar">
      <input type="radio" name="options" id="lunar-radio" autocomplete="off"> lunar
    </label>
  
    <label id="kinetic-option" class="distro-button btn btn-xs btn-primary" href="#kinetic" data="kinetic">
      <input type="radio" name="options" id="kinetic-radio" autocomplete="off"> kinetic
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-default" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="ardent" id="ardent-option" class="disabled older-distro-option"  href="#ardent">
          <a href="#ardent" data="ardent" id="ardent-button">ardent</a>
        </li>
      
        <li data="jade" id="jade-option" class="disabled older-distro-option"  href="#jade">
          <a href="#jade" data="jade" id="jade-button">jade</a>
        </li>
      
        <li data="hydro" id="hydro-option" class="disabled older-distro-option"  href="#hydro">
          <a href="#hydro" data="hydro" id="hydro-button">hydro</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/qb_hand">qb_hand</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/qb_hand"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  bitbucket-qbrobotics-qbhand-ros
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="bitbucket-qbrobotics-qbhand-ros" role="menuitem" tabindex="-1" href="/r/qb_hand/bitbucket-qbrobotics-qbhand-ros" data="bitbucket-qbrobotics-qbhand-ros">
                    <span class="glyphicon glyphicon-star"></span>
                    bitbucket-qbrobotics-qbhand-ros
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-crystal">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>crystal</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-bouncy">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>bouncy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://bitbucket.org/qbrobotics/qbhand-ros.git">https://bitbucket.org/qbrobotics/qbhand-ros.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">production-melodic</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-09
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/qb_hand/bitbucket-qbrobotics-qbhand-ros">qb_hand</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_control/bitbucket-qbrobotics-qbhand-ros">qb_hand_control</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_description/bitbucket-qbrobotics-qbhand-ros">qb_hand_description</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_hardware_interface/bitbucket-qbrobotics-qbhand-ros">qb_hand_hardware_interface</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p><img src="https://www.qbrobotics.com/wp-content/themes/qbrobotics/img/logo-qbsofthand.svg" alt="qbhand logo"></p>

<p><a href="https://www.qbrobotics.com/products/qb-softhand/"><em>qb SoftHand</em></a> is an <strong>adaptable yet robust robotic hand</strong> gripper for collaborative robotic arms and for humanoid robots. It is in scale 1:1 with the average human hand and it is similarily composed by 19 completely desensorized phalanges and a flat palm.</p>

<p>The specific system of tendons connected to just a single motor provides the mechanical adaptability of the grasp to the shape and softness of any object without damaging it, i.e. exploiting the intrinsic capability of soft robots to continuously deform in a huge variety of possible configurations through interaction with external items.</p>

<p>In addition, the single actuator fixed directly on the back of the hand barely affects the total encumbrance and weight (only 480 grams) of the device.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/render.png" alt="render"></p>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-installation">Installation</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-requirements">Requirements</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-ubuntu-packages">Ubuntu Packages</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-sources">Sources</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-device-setup">Device Setup</a></li>
</ol>
</li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-usage">Usage</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-details">Details</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-communication-handler">Communication Handler</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-control">Control</a></li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-control-modes">Control Modes</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-1.-gui-control">GUI Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-2.-waypoint-control">Waypoint Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-3.-api-control">API Control</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-demo-applications">Demo Applications</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-ros-packages-overview">ROS Packages Overview</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-support">Support, Bugs and Contribution</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-purchase">Purchase</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-roadmap">Roadmap</a></li>
</ol>

<blockquote>
<p>This <code>README</code> is basically a mirror of the <a href="http://wiki.ros.org/Robots/qbhand"><em>qb SoftHand</em> ROS wiki</a> and it is supplied only for offline documentation. Please, refer to the online wiki whenever you can; it is our main and most updated reference for <em>qb SoftHand</em> ROS related application.</p>
</blockquote>

<h2 id="installation">Installation</h2>

<h3 id="requirements">Requirements</h3>

<p>If you have never set it up, you probably need to add your linux user to the <code>dialout</code> group to grant right access to the serial port resources. To do so, just open a terminal and execute the following command:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo gpasswd -a &lt;user_name&gt; dialout

</code></pre></div>
<p>where you need to replace the <code>&lt;user_name&gt;</code> with your current linux username.</p>

<p><em>Note: don't forget to logout or reboot.</em></p>

<h3 id="ubuntu-packages">Ubuntu Packages</h3>

<p>If you prefer to leave your catkin workspace as it is, you can simply install all the ROS packages from the Ubuntu official repositories:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt update
sudo apt install ros-kinetic-qb-hand

</code></pre></div>
<h3 id="sources">Sources</h3>

<blockquote>
<p>Since you are interested in the ROS interfaces for our devices, it is assumed that you are familiar at least with the very basics of the ROS environment. If not, it might be useful to spend some of your time with <a href="http://wiki.ros.org/ROS/Tutorials">ROS</a> and <a href="http://wiki.ros.org/catkin/Tutorials">catkin</a> tutorials. After that, don't forget to come back here and start having fun with our Nodes.</p>
</blockquote>

<p>Install the <em>qb SoftHand</em> packages for a ROS user is straightforward. Nonetheless the following are the detailed steps which should be easy to understand even for ROS beginners:</p>

<ol>
<li>Clone both the <code>qb_device</code> and <code>qb_hand</code> packages to your Catkin Workspace, e.g. <code>~/catkin_ws</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws/src`
   git clone https://bitbucket.org/qbrobotics/qbdevice-ros.git
   git clone https://bitbucket.org/qbrobotics/qbhand-ros.git

</code></pre></div>
<ol>
<li>Compile the packages using <code>catkin</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws`
   catkin_make

</code></pre></div>
<p><strong>Note:</strong> depending on your ROS installation, you may need some extra packages to properly compile the code. Please, be sure that you have already installed at least <code>ros-kinetic-ros-controllers</code>, <code>ros-kinetic-transmission-interface</code>, <code>ros-kinetic-joint-limits-interface</code>, and their dependencies (<em>e.g. use <code>sudo apt install &lt;ros-pkg&gt;</code></em>).</p>

<ol>
<li>If you were not familiar with ROS you should be happy now: everything is done! Nonetheless, if you encounter some troubles during the compilation, feel free to ask for support on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
</ol>

<h3 id="device-setup">Device Setup</h3>

<p>Connect a <em>qb SoftHand</em> to your system is basically a matter of plugging in a USB cable. Nonetheless, <strong>read carefully</strong> the <a href="https://www.qbrobotics.com/products/qb-softhand-research/">manual</a> to understand all the requirements and advices about either single-device or chained configurations.</p>

<h2 id="usage">Usage</h2>

<p>As shown in the following picture there are two distinct configurations to control several <em>qb SoftHand</em> devices connected to the system:
- The first (and recommended) groups all the Hardware Interfaces together (thanks to the <a href="http://wiki.ros.org/combined_robot_hw">combined_robot_hw</a>) and exploits them as a unique robot system. We have called it <em>"synchronous"</em> just to point out that every sequence of reads and writes is always done in the same predefined order.
- The second mode threats every device as an independent Hardware Interface with its dedicated ROS Node which executes the control loop independently w.r.t. the rest of the system, i.e. <em>"asynchronously"</em>.</p>

<p>Mixed configurations can be also achieved through a proper setup. In such a case we can think of synchronous sub-systems which execute asynchronously w.r.t. each other.</p>

<blockquote>
<p>Note that in a single-device system the synchronous mode is a nonsense. </p>
</blockquote>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/overview_setup.svg" alt="overview_setup"></p>

<p>In both cases there is always one central Node which manages the shared resources for the serial communication (e.g. one or many USB ports) and which provides several ROS services to whom wants to interact with the connected devices. This Node is called <em>Communication Handler</em> and it is usually started in a separate terminal.</p>

<blockquote>
<p>Please remember that in a multi-device configuration, each <em>qbrobotics速</em> device connected to your system <strong>must have a unique ID</strong>.</p>
</blockquote>

<h3 id="details">Details</h3>

<p>To understand what is hiding under the hood, have a look at the C++ classes overview which sums up all the main concepts of our ROS packages:</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/overview_classes.svg" alt="overview_classes"></p>

<h3 id="communication-handler">Communication Handler</h3>

<p>The Communication Handler Node has no parameters to be set, therefore it is always launched like this:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_device_driver communication_handler.launch

</code></pre></div>
<p>On start, it scans the serial communication resources connected to your system and shows a list of the devices it has found. By default, it never scans again for new devices, apart from asking it explicitly during the initialization of a control Node.</p>

<p>This is a simple example when starting the Communication Handler with two <em>qbrobotics速</em> devices connected on two distinct USB ports:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[ INFO] [1524044523.511369300]: [CommunicationHandler] handles [/dev/ttyUSB1].
[ INFO] [1524044524.426984697]: [CommunicationHandler] handles [/dev/ttyUSB0].
[ INFO] [1524044525.218613760]: [CommunicationHandler] has found [2] devices connected:
[ INFO] [1524044525.218696997]:                        - device [1] connected through [/dev/ttyUSB0]
[ INFO] [1524044525.218736612]:                        - device [2] connected through [/dev/ttyUSB1]

</code></pre></div>
<p>When the Communication Handler is on, it provides all the Services required to interact with the connected devices: e.g. <em>get info or measurements, activate or deactivate motors, set commands</em>, and even more... A detailed description of the services can be found in the <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a> package wiki.</p>

<h3 id="control">Control</h3>

<p>As shown in <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/#markdown-header-details">Details</a> the control Node exploits the <a href="http://wiki.ros.org/ros_control">ros_control</a> Controller Manager which loads and runs the device controllers. Each controller provides an Action Server that, together with the Hardware Interface structure, allows the user to send commands to the relative device and get its measurements.</p>

<p>From an API point of view, it is implemented an Action Client which matches the relative trajectory controller and provides a method to send Goals, i.e. command references, directly to the given device. Additionally the Action Client is subscribed to a Topic (<code>*_controller/command</code>) that can be used to send reference commands from outside the code, e.g. asynchronously from the command line, or from a higher level control Node, e.g. as a result of a planning algorithm.</p>

<blockquote>
<p>It is recommended not to mix these two control modes: choose either to control the device directly from the code by extending our API or through this command Topic.</p>
</blockquote>

<p>Regardless the control mode chosen for the given application, and apart form a customization of the API, the following launch file templates can be used respectively to control several devices or a single one: </p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/overview_launch.svg" alt="overview_launch"></p>

<h3 id="control-modes">Control Modes</h3>

<p>For the sake of simplicity, we are going to cover all the control modes for a single <em>qb SoftHand</em>, but it is just a matter of putting things together and set the launch file parameters properly to control several devices together (<a href="http://wiki.ros.org/qb_chain_control">qb_chain_control</a> is dedicated for such a scope). </p>

<p>All the control modes are initialized in the same manner but with distinct command line arguments. The default single-device control Node which brings everything up and simply waits for commands on the above-mentioned Action topic is the following:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_hand_control control.launch standalone:=true activate_on_initialization:=true device_id:=&lt;actual_device_id&gt;

</code></pre></div>
<h6 id="the-arguments-explained">The arguments explained</h6>

<ul>
<li>
<code>activate_on_initialization [false]</code>: Activates the motor at startup (the device will not move since the first command reference is received).</li>
<li>
<code>device_id [1]</code>: Each device has its own ID, you need to set the one of the actual device connect to your system. </li>
<li>
<code>standalone [false]</code>: Starts the Communication Handler together with the control Node. If you set this to <code>false</code> (or remove it since the default value is <code>false</code>), you need to launch the Communication Handler in a separate terminal.</li>
</ul>

<p>It is worth noting that the activation of the motor can be postponed to improved safety if you are not aware of the state of the system at startup. To do so just set <code>activate_on_initialization:=false</code> (or remove it since the default value is <code>false</code>) and make a call to the Communication Handler <code>activate_motors</code> Service, when your system is ready, e.g. as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosservice call /communication_handler/activate_motors {"id: &lt;actual_device_id&gt;, max_repeats: 0"}

</code></pre></div>
<h6 id="additional-arguments">Additional arguments</h6>

<ul>
<li>
<code>control_duration [0.01]</code>: The duration of the control loop expressed in seconds.</li>
<li>
<code>get_currents [true]</code>: Choose whether or not to retrieve current measurements from the device.</li>
<li>
<code>get_positions [true]</code>: Choose whether or not to retrieve position measurements from the device.</li>
<li>
<code>get_distinct_packages [true]</code>: Choose whether or not to retrieve current and position measurements from the device in two distinct packages.</li>
<li>
<code>max_repeats [3]</code>: The maximum number of consecutive repetitions to mark retrieved data as corrupted.</li>
<li>
<code>set_commands [true]</code>: Choose whether or not to send command positions to the device.</li>
<li>
<code>set_commands_async [true]</code>: Choose whether or not to send commands without waiting for ack.</li>
<li>
<code>use_rviz [false]</code>: Choose whether or not to use rviz. If enabled you should see a virtual hand on screen performing a similar behavior.</li>
</ul>

<blockquote>
<p>Be aware that the <em>qb SoftHand</em> is desensorized and therefore it is not possible to know exactly the position of each finger: the screen visualization is just the result of an estimation of the closure value and may differ from the real configuration of your <em>qb SoftHand</em> (e.g. when grasping an object).</p>
</blockquote>

<p>The followings are particular control modes which are enabled with few parameters, but the concepts of this paragraph hold for all of them.</p>

<h4 id="1-gui-control">1. GUI Control</h4>

<p>This control mode is the one suggested to test that everything is working as expected. You are able to open and close the <em>qb SoftHand</em> interactively, but nothing more than this.</p>

<blockquote>
<p>You will probably need this only the very first times and for debugging.</p>
</blockquote>

<p>To start this mode just add <code>use_controller_gui:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_waypoints</code> is not used).</p>

<p>After a while a GUI should appear to screen with two empty dropdown menus, a red enable button below them, and a <em>speed scaling</em> slider at the bottom.
1. Select the <em>Controller Manager</em> namespace from the left menu, e.g. <code>/&lt;robot_namespace&gt;/control/controller_manager</code> (where <code>&lt;robot_namespace&gt;</code> is an additional argument of the launch file needed with several devices). This enables the right menu which provides all the controllers available for the connected device.
1. Select the <em>qb SoftHand</em> controller from the second dropdown menu and enable it through the circular button.
1. A single slider will appear in the GUI to control the closure of the hand, which ranges from <code>0</code> (hand completely open) to <code>1</code> (hand completely closed). Move the slider to perform a complete grasp or to partially open/close the <em>qb SoftHand</em>. You can also vary the speed through the bottom <em>speed scaling</em> slider if you like a faster/slower motion. No other timing constraints can be set in this mode.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/screen_gui.png" alt="screen_gui"></p>

<h4 id="2-waypoint-control">2. Waypoint Control</h4>

<p>This control mode is a bit more structured and useful than the previous: it allows to set a fixed trajectory of any number of position waypoints (with timing constraints) and set the robot to cycle infinitely on it (because of the loop it is recommended to set the first and last waypoint in a similar configuration to avoid unwanted sudden changes).</p>

<p>To start this mode just add <code>use_waypoints:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_controller_gui</code> is not used). You won't see any control interface in this case but the <em>qb SoftHand</em> should start moving according to the given trajectory, parsed from a yaml file located at</p>
<div class="highlight"><pre><code class="language-" data-lang="">&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml

</code></pre></div>
<p>where <code>robot_name</code> and <code>robot_package</code> are two additional launch file arguments.</p>

<h5 id="customization">Customization</h5>

<p>You can modify the waypoint trajectory to replicate the behavior you want: either change the <code>&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml</code> or add another custom application-specific file in the <code>config</code> directory. In the second case you need to set the argument <code>robot_name</code> properly when launching the command from the terminal.</p>

<p>The waypoint configuration is as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang=""># Waypoints describe the desired motion trajectory:
#  - time [s]: can be either a single value or an interval for which joint_positions hold
#  - joint_positions:
#     - hand closure [0,1];
#  - joint_velocities: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s;
#  - joint_accelerations: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s^2;
#
# It is worth noting that, if specified, joint_positions, joint_velocities and joint_accelerations must be of size one.

waypoints:
 -
   time: [1.0]
   joint_positions:
     &lt;device_name&gt;: [0.0]
 -
   time: [2.25, 2.75]
   joint_positions:
     &lt;device_name&gt;: [0.8]
  -
    time: [4.0]
    joint_positions:
      &lt;device_name&gt;: [0.5]
    joint_velocities:
      &lt;device_name&gt;: [-0.5]
 -
   ...

</code></pre></div>
<h4 id="3-api-control">3. API Control</h4>

<p>If you need a complex (i.e. real) control application, e.g. the <em>qb SoftHand</em> is mounted on a robot which uses computer vision aid to grasp objects, the previous two control modes don't really help much. What we provide for real applications is the full ROS libraries to manage and control the <em>qb SoftHand</em>.</p>

<p>You have to dig into the <a href="http://wiki.ros.org/qb_hand">qb_hand</a> package documentation and find what better suits for your needs, e.g. extend the <code>qbDeviceControl</code> class provided, or even redesign some of its parts by following an approach similar to ours.</p>

<blockquote>
<p>Our recommendation is to use as much as possible our resources, classes and macros to help you while developing your application. Don't reinvent the wheel!</p>
</blockquote>

<p>At last, if you come up with a something useful for the whole community, it will be amazing if you propose your improvement with a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</p>

<h2 id="demo-applications">Demo Applications</h2>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-melodic/qb_hand_media/example.png" alt="example"></p>

<h2 id="ros-packages-overview">ROS Packages Overview</h2>

<table>
<thead>
<tr>
<th style="text-align: right"></th>
<th>Packages</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_device">qb_device</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_device_bringup">qb_device_bringup</a>, <a href="http://wiki.ros.org/qb_device_control">qb_device_control</a>, <a href="http://wiki.ros.org/qb_device_description">qb_device_description</a>, <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a>, <a href="http://wiki.ros.org/qb_device_hardware_interface">qb_device_hardware_interface</a>, <a href="http://wiki.ros.org/qb_device_msgs">qb_device_msgs</a>, <a href="http://wiki.ros.org/qb_device_srvs">qb_device_srvs</a>, <a href="http://wiki.ros.org/qb_device_utils">qb_device_utils</a>
</td>
</tr>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_hand">qb_hand</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_hand_control">qb_hand_control</a>, <a href="http://wiki.ros.org/qb_hand_description">qb_hand_description</a>, <a href="http://wiki.ros.org/qb_hand_hardware_interface">qb_hand_hardware_interface</a>
</td>
</tr>
</tbody>
</table>

<h2 id="support-bugs-and-contribution">Support, Bugs and Contribution</h2>

<p>Since we are not only focused on this project it might happen that you encounter some trouble once in a while. Maybe we have just forget to think about your specific use case or we have not seen a terrible bug inside our code. In such a case, we are really sorry for the inconvenience and we will provide any support you need.</p>

<p>To help you in the best way we can, we are asking you to do the most suitable of the following steps:</p>

<ol>
<li>It is the first time you are holding a <em>qb SoftHand</em>, or the first time you are using ROS, or even both: it is always a pleasure for us to solve your problems, but please consider first to read again the instructions above and the ROS tutorials. If you have ROS related questions the right place to ask is <a href="http://answers.ros.org/questions/">ROS Answers</a>.</li>
<li>You are a beginner user stuck on something you completely don't know how to solve or you are experiencing unexpected behaviour: feel free to contact us at <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-melodic/support+ros@qbrobotics.com">support+ros at qbrobotics.com</a>, you will receive the specific support you need as fast as we can handle it.</li>
<li>You are quite an expert user, everything has always worked fine, but now you have founded something strange and you don't know how to fix it: we will be glad if you open an Issue in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
<li>You are definitely an expert user, you have found a bug in our code and you have also correct it: it will be amazing if you open a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>; we will merge it as soon as possible.</li>
<li>You are comfortable with <em>qbrobotics速</em> products but you are wondering whether is possible to add some additional software features: feel free to open respectively an Issue or a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>, according to whether it is just an idea or you have already provided your solution.</li>
</ol>

<p>In any case, thank you for using <a href="https://www.qbrobotics.com"><em>qbrobotics速</em></a> solutions.</p>

<h2 id="purchase">Purchase</h2>

<p>If you have just found out our company and you are interested in our products, come to <a href="https://www.qbrobotics.com">visit us</a> and feel free to ask for a quote.</p>

<h2 id="roadmap">Roadmap</h2>

<p>Features to be implemented in the future:</p>

<ul>
<li>Improve stability</li>
<li>CI an tests</li>
<li>Gazebo simulation</li>
<li>Improved controller to better replicate the real grasp</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-lunar">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://bitbucket.org/qbrobotics/qbhand-ros.git">https://bitbucket.org/qbrobotics/qbhand-ros.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">production-lunar</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-09
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/qb_hand/bitbucket-qbrobotics-qbhand-ros">qb_hand</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_control/bitbucket-qbrobotics-qbhand-ros">qb_hand_control</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_description/bitbucket-qbrobotics-qbhand-ros">qb_hand_description</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_hardware_interface/bitbucket-qbrobotics-qbhand-ros">qb_hand_hardware_interface</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p><img src="https://www.qbrobotics.com/wp-content/themes/qbrobotics/img/logo-qbsofthand.svg" alt="qbhand logo"></p>

<p><a href="https://www.qbrobotics.com/products/qb-softhand/"><em>qb SoftHand</em></a> is an <strong>adaptable yet robust robotic hand</strong> gripper for collaborative robotic arms and for humanoid robots. It is in scale 1:1 with the average human hand and it is similarily composed by 19 completely desensorized phalanges and a flat palm.</p>

<p>The specific system of tendons connected to just a single motor provides the mechanical adaptability of the grasp to the shape and softness of any object without damaging it, i.e. exploiting the intrinsic capability of soft robots to continuously deform in a huge variety of possible configurations through interaction with external items.</p>

<p>In addition, the single actuator fixed directly on the back of the hand barely affects the total encumbrance and weight (only 480 grams) of the device.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/render.png" alt="render"></p>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-installation">Installation</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-requirements">Requirements</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-ubuntu-packages">Ubuntu Packages</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-sources">Sources</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-device-setup">Device Setup</a></li>
</ol>
</li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-usage">Usage</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-details">Details</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-communication-handler">Communication Handler</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-control">Control</a></li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-control-modes">Control Modes</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-1.-gui-control">GUI Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-2.-waypoint-control">Waypoint Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-3.-api-control">API Control</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-demo-applications">Demo Applications</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-ros-packages-overview">ROS Packages Overview</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-support">Support, Bugs and Contribution</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-purchase">Purchase</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-roadmap">Roadmap</a></li>
</ol>

<blockquote>
<p>This <code>README</code> is basically a mirror of the <a href="http://wiki.ros.org/Robots/qbhand"><em>qb SoftHand</em> ROS wiki</a> and it is supplied only for offline documentation. Please, refer to the online wiki whenever you can; it is our main and most updated reference for <em>qb SoftHand</em> ROS related application.</p>
</blockquote>

<h2 id="installation">Installation</h2>

<h3 id="requirements">Requirements</h3>

<p>If you have never set it up, you probably need to add your linux user to the <code>dialout</code> group to grant right access to the serial port resources. To do so, just open a terminal and execute the following command:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo gpasswd -a &lt;user_name&gt; dialout

</code></pre></div>
<p>where you need to replace the <code>&lt;user_name&gt;</code> with your current linux username.</p>

<p><em>Note: don't forget to logout or reboot.</em></p>

<h3 id="ubuntu-packages">Ubuntu Packages</h3>

<p>If you prefer to leave your catkin workspace as it is, you can simply install all the ROS packages from the Ubuntu official repositories:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt update
sudo apt install ros-kinetic-qb-hand

</code></pre></div>
<h3 id="sources">Sources</h3>

<blockquote>
<p>Since you are interested in the ROS interfaces for our devices, it is assumed that you are familiar at least with the very basics of the ROS environment. If not, it might be useful to spend some of your time with <a href="http://wiki.ros.org/ROS/Tutorials">ROS</a> and <a href="http://wiki.ros.org/catkin/Tutorials">catkin</a> tutorials. After that, don't forget to come back here and start having fun with our Nodes.</p>
</blockquote>

<p>Install the <em>qb SoftHand</em> packages for a ROS user is straightforward. Nonetheless the following are the detailed steps which should be easy to understand even for ROS beginners:</p>

<ol>
<li>Clone both the <code>qb_device</code> and <code>qb_hand</code> packages to your Catkin Workspace, e.g. <code>~/catkin_ws</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws/src`
   git clone https://bitbucket.org/qbrobotics/qbdevice-ros.git
   git clone https://bitbucket.org/qbrobotics/qbhand-ros.git

</code></pre></div>
<ol>
<li>Compile the packages using <code>catkin</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws`
   catkin_make

</code></pre></div>
<p><strong>Note:</strong> depending on your ROS installation, you may need some extra packages to properly compile the code. Please, be sure that you have already installed at least <code>ros-kinetic-ros-controllers</code>, <code>ros-kinetic-transmission-interface</code>, <code>ros-kinetic-joint-limits-interface</code>, and their dependencies (<em>e.g. use <code>sudo apt install &lt;ros-pkg&gt;</code></em>).</p>

<ol>
<li>If you were not familiar with ROS you should be happy now: everything is done! Nonetheless, if you encounter some troubles during the compilation, feel free to ask for support on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
</ol>

<h3 id="device-setup">Device Setup</h3>

<p>Connect a <em>qb SoftHand</em> to your system is basically a matter of plugging in a USB cable. Nonetheless, <strong>read carefully</strong> the <a href="https://www.qbrobotics.com/products/qb-softhand-research/">manual</a> to understand all the requirements and advices about either single-device or chained configurations.</p>

<h2 id="usage">Usage</h2>

<p>As shown in the following picture there are two distinct configurations to control several <em>qb SoftHand</em> devices connected to the system:
- The first (and recommended) groups all the Hardware Interfaces together (thanks to the <a href="http://wiki.ros.org/combined_robot_hw">combined_robot_hw</a>) and exploits them as a unique robot system. We have called it <em>"synchronous"</em> just to point out that every sequence of reads and writes is always done in the same predefined order.
- The second mode threats every device as an independent Hardware Interface with its dedicated ROS Node which executes the control loop independently w.r.t. the rest of the system, i.e. <em>"asynchronously"</em>.</p>

<p>Mixed configurations can be also achieved through a proper setup. In such a case we can think of synchronous sub-systems which execute asynchronously w.r.t. each other.</p>

<blockquote>
<p>Note that in a single-device system the synchronous mode is a nonsense. </p>
</blockquote>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/overview_setup.svg" alt="overview_setup"></p>

<p>In both cases there is always one central Node which manages the shared resources for the serial communication (e.g. one or many USB ports) and which provides several ROS services to whom wants to interact with the connected devices. This Node is called <em>Communication Handler</em> and it is usually started in a separate terminal.</p>

<blockquote>
<p>Please remember that in a multi-device configuration, each <em>qbrobotics速</em> device connected to your system <strong>must have a unique ID</strong>.</p>
</blockquote>

<h3 id="details">Details</h3>

<p>To understand what is hiding under the hood, have a look at the C++ classes overview which sums up all the main concepts of our ROS packages:</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/overview_classes.svg" alt="overview_classes"></p>

<h3 id="communication-handler">Communication Handler</h3>

<p>The Communication Handler Node has no parameters to be set, therefore it is always launched like this:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_device_driver communication_handler.launch

</code></pre></div>
<p>On start, it scans the serial communication resources connected to your system and shows a list of the devices it has found. By default, it never scans again for new devices, apart from asking it explicitly during the initialization of a control Node.</p>

<p>This is a simple example when starting the Communication Handler with two <em>qbrobotics速</em> devices connected on two distinct USB ports:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[ INFO] [1524044523.511369300]: [CommunicationHandler] handles [/dev/ttyUSB1].
[ INFO] [1524044524.426984697]: [CommunicationHandler] handles [/dev/ttyUSB0].
[ INFO] [1524044525.218613760]: [CommunicationHandler] has found [2] devices connected:
[ INFO] [1524044525.218696997]:                        - device [1] connected through [/dev/ttyUSB0]
[ INFO] [1524044525.218736612]:                        - device [2] connected through [/dev/ttyUSB1]

</code></pre></div>
<p>When the Communication Handler is on, it provides all the Services required to interact with the connected devices: e.g. <em>get info or measurements, activate or deactivate motors, set commands</em>, and even more... A detailed description of the services can be found in the <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a> package wiki.</p>

<h3 id="control">Control</h3>

<p>As shown in <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/#markdown-header-details">Details</a> the control Node exploits the <a href="http://wiki.ros.org/ros_control">ros_control</a> Controller Manager which loads and runs the device controllers. Each controller provides an Action Server that, together with the Hardware Interface structure, allows the user to send commands to the relative device and get its measurements.</p>

<p>From an API point of view, it is implemented an Action Client which matches the relative trajectory controller and provides a method to send Goals, i.e. command references, directly to the given device. Additionally the Action Client is subscribed to a Topic (<code>*_controller/command</code>) that can be used to send reference commands from outside the code, e.g. asynchronously from the command line, or from a higher level control Node, e.g. as a result of a planning algorithm.</p>

<blockquote>
<p>It is recommended not to mix these two control modes: choose either to control the device directly from the code by extending our API or through this command Topic.</p>
</blockquote>

<p>Regardless the control mode chosen for the given application, and apart form a customization of the API, the following launch file templates can be used respectively to control several devices or a single one: </p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/overview_launch.svg" alt="overview_launch"></p>

<h3 id="control-modes">Control Modes</h3>

<p>For the sake of simplicity, we are going to cover all the control modes for a single <em>qb SoftHand</em>, but it is just a matter of putting things together and set the launch file parameters properly to control several devices together (<a href="http://wiki.ros.org/qb_chain_control">qb_chain_control</a> is dedicated for such a scope). </p>

<p>All the control modes are initialized in the same manner but with distinct command line arguments. The default single-device control Node which brings everything up and simply waits for commands on the above-mentioned Action topic is the following:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_hand_control control.launch standalone:=true activate_on_initialization:=true device_id:=&lt;actual_device_id&gt;

</code></pre></div>
<h6 id="the-arguments-explained">The arguments explained</h6>

<ul>
<li>
<code>activate_on_initialization [false]</code>: Activates the motor at startup (the device will not move since the first command reference is received).</li>
<li>
<code>device_id [1]</code>: Each device has its own ID, you need to set the one of the actual device connect to your system. </li>
<li>
<code>standalone [false]</code>: Starts the Communication Handler together with the control Node. If you set this to <code>false</code> (or remove it since the default value is <code>false</code>), you need to launch the Communication Handler in a separate terminal.</li>
</ul>

<p>It is worth noting that the activation of the motor can be postponed to improved safety if you are not aware of the state of the system at startup. To do so just set <code>activate_on_initialization:=false</code> (or remove it since the default value is <code>false</code>) and make a call to the Communication Handler <code>activate_motors</code> Service, when your system is ready, e.g. as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosservice call /communication_handler/activate_motors {"id: &lt;actual_device_id&gt;, max_repeats: 0"}

</code></pre></div>
<h6 id="additional-arguments">Additional arguments</h6>

<ul>
<li>
<code>control_duration [0.01]</code>: The duration of the control loop expressed in seconds.</li>
<li>
<code>get_currents [true]</code>: Choose whether or not to retrieve current measurements from the device.</li>
<li>
<code>get_positions [true]</code>: Choose whether or not to retrieve position measurements from the device.</li>
<li>
<code>get_distinct_packages [true]</code>: Choose whether or not to retrieve current and position measurements from the device in two distinct packages.</li>
<li>
<code>max_repeats [3]</code>: The maximum number of consecutive repetitions to mark retrieved data as corrupted.</li>
<li>
<code>set_commands [true]</code>: Choose whether or not to send command positions to the device.</li>
<li>
<code>set_commands_async [true]</code>: Choose whether or not to send commands without waiting for ack.</li>
<li>
<code>use_rviz [false]</code>: Choose whether or not to use rviz. If enabled you should see a virtual hand on screen performing a similar behavior.</li>
</ul>

<blockquote>
<p>Be aware that the <em>qb SoftHand</em> is desensorized and therefore it is not possible to know exactly the position of each finger: the screen visualization is just the result of an estimation of the closure value and may differ from the real configuration of your <em>qb SoftHand</em> (e.g. when grasping an object).</p>
</blockquote>

<p>The followings are particular control modes which are enabled with few parameters, but the concepts of this paragraph hold for all of them.</p>

<h4 id="1-gui-control">1. GUI Control</h4>

<p>This control mode is the one suggested to test that everything is working as expected. You are able to open and close the <em>qb SoftHand</em> interactively, but nothing more than this.</p>

<blockquote>
<p>You will probably need this only the very first times and for debugging.</p>
</blockquote>

<p>To start this mode just add <code>use_controller_gui:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_waypoints</code> is not used).</p>

<p>After a while a GUI should appear to screen with two empty dropdown menus, a red enable button below them, and a <em>speed scaling</em> slider at the bottom.
1. Select the <em>Controller Manager</em> namespace from the left menu, e.g. <code>/&lt;robot_namespace&gt;/control/controller_manager</code> (where <code>&lt;robot_namespace&gt;</code> is an additional argument of the launch file needed with several devices). This enables the right menu which provides all the controllers available for the connected device.
1. Select the <em>qb SoftHand</em> controller from the second dropdown menu and enable it through the circular button.
1. A single slider will appear in the GUI to control the closure of the hand, which ranges from <code>0</code> (hand completely open) to <code>1</code> (hand completely closed). Move the slider to perform a complete grasp or to partially open/close the <em>qb SoftHand</em>. You can also vary the speed through the bottom <em>speed scaling</em> slider if you like a faster/slower motion. No other timing constraints can be set in this mode.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/screen_gui.png" alt="screen_gui"></p>

<h4 id="2-waypoint-control">2. Waypoint Control</h4>

<p>This control mode is a bit more structured and useful than the previous: it allows to set a fixed trajectory of any number of position waypoints (with timing constraints) and set the robot to cycle infinitely on it (because of the loop it is recommended to set the first and last waypoint in a similar configuration to avoid unwanted sudden changes).</p>

<p>To start this mode just add <code>use_waypoints:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_controller_gui</code> is not used). You won't see any control interface in this case but the <em>qb SoftHand</em> should start moving according to the given trajectory, parsed from a yaml file located at</p>
<div class="highlight"><pre><code class="language-" data-lang="">&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml

</code></pre></div>
<p>where <code>robot_name</code> and <code>robot_package</code> are two additional launch file arguments.</p>

<h5 id="customization">Customization</h5>

<p>You can modify the waypoint trajectory to replicate the behavior you want: either change the <code>&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml</code> or add another custom application-specific file in the <code>config</code> directory. In the second case you need to set the argument <code>robot_name</code> properly when launching the command from the terminal.</p>

<p>The waypoint configuration is as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang=""># Waypoints describe the desired motion trajectory:
#  - time [s]: can be either a single value or an interval for which joint_positions hold
#  - joint_positions:
#     - hand closure [0,1];
#  - joint_velocities: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s;
#  - joint_accelerations: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s^2;
#
# It is worth noting that, if specified, joint_positions, joint_velocities and joint_accelerations must be of size one.

waypoints:
 -
   time: [1.0]
   joint_positions:
     &lt;device_name&gt;: [0.0]
 -
   time: [2.25, 2.75]
   joint_positions:
     &lt;device_name&gt;: [0.8]
  -
    time: [4.0]
    joint_positions:
      &lt;device_name&gt;: [0.5]
    joint_velocities:
      &lt;device_name&gt;: [-0.5]
 -
   ...

</code></pre></div>
<h4 id="3-api-control">3. API Control</h4>

<p>If you need a complex (i.e. real) control application, e.g. the <em>qb SoftHand</em> is mounted on a robot which uses computer vision aid to grasp objects, the previous two control modes don't really help much. What we provide for real applications is the full ROS libraries to manage and control the <em>qb SoftHand</em>.</p>

<p>You have to dig into the <a href="http://wiki.ros.org/qb_hand">qb_hand</a> package documentation and find what better suits for your needs, e.g. extend the <code>qbDeviceControl</code> class provided, or even redesign some of its parts by following an approach similar to ours.</p>

<blockquote>
<p>Our recommendation is to use as much as possible our resources, classes and macros to help you while developing your application. Don't reinvent the wheel!</p>
</blockquote>

<p>At last, if you come up with a something useful for the whole community, it will be amazing if you propose your improvement with a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</p>

<h2 id="demo-applications">Demo Applications</h2>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-lunar/qb_hand_media/example.png" alt="example"></p>

<h2 id="ros-packages-overview">ROS Packages Overview</h2>

<table>
<thead>
<tr>
<th style="text-align: right"></th>
<th>Packages</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_device">qb_device</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_device_bringup">qb_device_bringup</a>, <a href="http://wiki.ros.org/qb_device_control">qb_device_control</a>, <a href="http://wiki.ros.org/qb_device_description">qb_device_description</a>, <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a>, <a href="http://wiki.ros.org/qb_device_hardware_interface">qb_device_hardware_interface</a>, <a href="http://wiki.ros.org/qb_device_msgs">qb_device_msgs</a>, <a href="http://wiki.ros.org/qb_device_srvs">qb_device_srvs</a>, <a href="http://wiki.ros.org/qb_device_utils">qb_device_utils</a>
</td>
</tr>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_hand">qb_hand</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_hand_control">qb_hand_control</a>, <a href="http://wiki.ros.org/qb_hand_description">qb_hand_description</a>, <a href="http://wiki.ros.org/qb_hand_hardware_interface">qb_hand_hardware_interface</a>
</td>
</tr>
</tbody>
</table>

<h2 id="support-bugs-and-contribution">Support, Bugs and Contribution</h2>

<p>Since we are not only focused on this project it might happen that you encounter some trouble once in a while. Maybe we have just forget to think about your specific use case or we have not seen a terrible bug inside our code. In such a case, we are really sorry for the inconvenience and we will provide any support you need.</p>

<p>To help you in the best way we can, we are asking you to do the most suitable of the following steps:</p>

<ol>
<li>It is the first time you are holding a <em>qb SoftHand</em>, or the first time you are using ROS, or even both: it is always a pleasure for us to solve your problems, but please consider first to read again the instructions above and the ROS tutorials. If you have ROS related questions the right place to ask is <a href="http://answers.ros.org/questions/">ROS Answers</a>.</li>
<li>You are a beginner user stuck on something you completely don't know how to solve or you are experiencing unexpected behaviour: feel free to contact us at <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-lunar/support+ros@qbrobotics.com">support+ros at qbrobotics.com</a>, you will receive the specific support you need as fast as we can handle it.</li>
<li>You are quite an expert user, everything has always worked fine, but now you have founded something strange and you don't know how to fix it: we will be glad if you open an Issue in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
<li>You are definitely an expert user, you have found a bug in our code and you have also correct it: it will be amazing if you open a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>; we will merge it as soon as possible.</li>
<li>You are comfortable with <em>qbrobotics速</em> products but you are wondering whether is possible to add some additional software features: feel free to open respectively an Issue or a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>, according to whether it is just an idea or you have already provided your solution.</li>
</ol>

<p>In any case, thank you for using <a href="https://www.qbrobotics.com"><em>qbrobotics速</em></a> solutions.</p>

<h2 id="purchase">Purchase</h2>

<p>If you have just found out our company and you are interested in our products, come to <a href="https://www.qbrobotics.com">visit us</a> and feel free to ask for a quote.</p>

<h2 id="roadmap">Roadmap</h2>

<p>Features to be implemented in the future:</p>

<ul>
<li>Improve stability</li>
<li>CI an tests</li>
<li>Gazebo simulation</li>
<li>Improved controller to better replicate the real grasp</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-kinetic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://bitbucket.org/qbrobotics/qbhand-ros.git">https://bitbucket.org/qbrobotics/qbhand-ros.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">production-kinetic</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-09
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/qb_hand/bitbucket-qbrobotics-qbhand-ros">qb_hand</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_control/bitbucket-qbrobotics-qbhand-ros">qb_hand_control</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_description/bitbucket-qbrobotics-qbhand-ros">qb_hand_description</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/qb_hand_hardware_interface/bitbucket-qbrobotics-qbhand-ros">qb_hand_hardware_interface</a></td>
                    <td>2.1.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p><img src="https://www.qbrobotics.com/wp-content/themes/qbrobotics/img/logo-qbsofthand.svg" alt="qbhand logo"></p>

<p><a href="https://www.qbrobotics.com/products/qb-softhand/"><em>qb SoftHand</em></a> is an <strong>adaptable yet robust robotic hand</strong> gripper for collaborative robotic arms and for humanoid robots. It is in scale 1:1 with the average human hand and it is similarily composed by 19 completely desensorized phalanges and a flat palm.</p>

<p>The specific system of tendons connected to just a single motor provides the mechanical adaptability of the grasp to the shape and softness of any object without damaging it, i.e. exploiting the intrinsic capability of soft robots to continuously deform in a huge variety of possible configurations through interaction with external items.</p>

<p>In addition, the single actuator fixed directly on the back of the hand barely affects the total encumbrance and weight (only 480 grams) of the device.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/render.png" alt="render"></p>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-installation">Installation</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-requirements">Requirements</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-ubuntu-packages">Ubuntu Packages</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-sources">Sources</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-device-setup">Device Setup</a></li>
</ol>
</li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-usage">Usage</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-details">Details</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-communication-handler">Communication Handler</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-control">Control</a></li>
<li>
<a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-control-modes">Control Modes</a>

<ol>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-1.-gui-control">GUI Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-2.-waypoint-control">Waypoint Control</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-3.-api-control">API Control</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-demo-applications">Demo Applications</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-ros-packages-overview">ROS Packages Overview</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-support">Support, Bugs and Contribution</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-purchase">Purchase</a></li>
<li><a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-roadmap">Roadmap</a></li>
</ol>

<blockquote>
<p>This <code>README</code> is basically a mirror of the <a href="http://wiki.ros.org/Robots/qbhand"><em>qb SoftHand</em> ROS wiki</a> and it is supplied only for offline documentation. Please, refer to the online wiki whenever you can; it is our main and most updated reference for <em>qb SoftHand</em> ROS related application.</p>
</blockquote>

<h2 id="installation">Installation</h2>

<h3 id="requirements">Requirements</h3>

<p>If you have never set it up, you probably need to add your linux user to the <code>dialout</code> group to grant right access to the serial port resources. To do so, just open a terminal and execute the following command:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo gpasswd -a &lt;user_name&gt; dialout

</code></pre></div>
<p>where you need to replace the <code>&lt;user_name&gt;</code> with your current linux username.</p>

<p><em>Note: don't forget to logout or reboot.</em></p>

<h3 id="ubuntu-packages">Ubuntu Packages</h3>

<p>If you prefer to leave your catkin workspace as it is, you can simply install all the ROS packages from the Ubuntu official repositories:</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt update
sudo apt install ros-kinetic-qb-hand

</code></pre></div>
<h3 id="sources">Sources</h3>

<blockquote>
<p>Since you are interested in the ROS interfaces for our devices, it is assumed that you are familiar at least with the very basics of the ROS environment. If not, it might be useful to spend some of your time with <a href="http://wiki.ros.org/ROS/Tutorials">ROS</a> and <a href="http://wiki.ros.org/catkin/Tutorials">catkin</a> tutorials. After that, don't forget to come back here and start having fun with our Nodes.</p>
</blockquote>

<p>Install the <em>qb SoftHand</em> packages for a ROS user is straightforward. Nonetheless the following are the detailed steps which should be easy to understand even for ROS beginners:</p>

<ol>
<li>Clone both the <code>qb_device</code> and <code>qb_hand</code> packages to your Catkin Workspace, e.g. <code>~/catkin_ws</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws/src`
   git clone https://bitbucket.org/qbrobotics/qbdevice-ros.git
   git clone https://bitbucket.org/qbrobotics/qbhand-ros.git

</code></pre></div>
<ol>
<li>Compile the packages using <code>catkin</code>:</li>
</ol>
<div class="highlight"><pre><code class="language-" data-lang="">   cd `~/catkin_ws`
   catkin_make

</code></pre></div>
<p><strong>Note:</strong> depending on your ROS installation, you may need some extra packages to properly compile the code. Please, be sure that you have already installed at least <code>ros-kinetic-ros-controllers</code>, <code>ros-kinetic-transmission-interface</code>, <code>ros-kinetic-joint-limits-interface</code>, and their dependencies (<em>e.g. use <code>sudo apt install &lt;ros-pkg&gt;</code></em>).</p>

<ol>
<li>If you were not familiar with ROS you should be happy now: everything is done! Nonetheless, if you encounter some troubles during the compilation, feel free to ask for support on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
</ol>

<h3 id="device-setup">Device Setup</h3>

<p>Connect a <em>qb SoftHand</em> to your system is basically a matter of plugging in a USB cable. Nonetheless, <strong>read carefully</strong> the <a href="https://www.qbrobotics.com/products/qb-softhand-research/">manual</a> to understand all the requirements and advices about either single-device or chained configurations.</p>

<h2 id="usage">Usage</h2>

<p>As shown in the following picture there are two distinct configurations to control several <em>qb SoftHand</em> devices connected to the system:
- The first (and recommended) groups all the Hardware Interfaces together (thanks to the <a href="http://wiki.ros.org/combined_robot_hw">combined_robot_hw</a>) and exploits them as a unique robot system. We have called it <em>"synchronous"</em> just to point out that every sequence of reads and writes is always done in the same predefined order.
- The second mode threats every device as an independent Hardware Interface with its dedicated ROS Node which executes the control loop independently w.r.t. the rest of the system, i.e. <em>"asynchronously"</em>.</p>

<p>Mixed configurations can be also achieved through a proper setup. In such a case we can think of synchronous sub-systems which execute asynchronously w.r.t. each other.</p>

<blockquote>
<p>Note that in a single-device system the synchronous mode is a nonsense. </p>
</blockquote>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/overview_setup.svg" alt="overview_setup"></p>

<p>In both cases there is always one central Node which manages the shared resources for the serial communication (e.g. one or many USB ports) and which provides several ROS services to whom wants to interact with the connected devices. This Node is called <em>Communication Handler</em> and it is usually started in a separate terminal.</p>

<blockquote>
<p>Please remember that in a multi-device configuration, each <em>qbrobotics速</em> device connected to your system <strong>must have a unique ID</strong>.</p>
</blockquote>

<h3 id="details">Details</h3>

<p>To understand what is hiding under the hood, have a look at the C++ classes overview which sums up all the main concepts of our ROS packages:</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/overview_classes.svg" alt="overview_classes"></p>

<h3 id="communication-handler">Communication Handler</h3>

<p>The Communication Handler Node has no parameters to be set, therefore it is always launched like this:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_device_driver communication_handler.launch

</code></pre></div>
<p>On start, it scans the serial communication resources connected to your system and shows a list of the devices it has found. By default, it never scans again for new devices, apart from asking it explicitly during the initialization of a control Node.</p>

<p>This is a simple example when starting the Communication Handler with two <em>qbrobotics速</em> devices connected on two distinct USB ports:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[ INFO] [1524044523.511369300]: [CommunicationHandler] handles [/dev/ttyUSB1].
[ INFO] [1524044524.426984697]: [CommunicationHandler] handles [/dev/ttyUSB0].
[ INFO] [1524044525.218613760]: [CommunicationHandler] has found [2] devices connected:
[ INFO] [1524044525.218696997]:                        - device [1] connected through [/dev/ttyUSB0]
[ INFO] [1524044525.218736612]:                        - device [2] connected through [/dev/ttyUSB1]

</code></pre></div>
<p>When the Communication Handler is on, it provides all the Services required to interact with the connected devices: e.g. <em>get info or measurements, activate or deactivate motors, set commands</em>, and even more... A detailed description of the services can be found in the <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a> package wiki.</p>

<h3 id="control">Control</h3>

<p>As shown in <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/#markdown-header-details">Details</a> the control Node exploits the <a href="http://wiki.ros.org/ros_control">ros_control</a> Controller Manager which loads and runs the device controllers. Each controller provides an Action Server that, together with the Hardware Interface structure, allows the user to send commands to the relative device and get its measurements.</p>

<p>From an API point of view, it is implemented an Action Client which matches the relative trajectory controller and provides a method to send Goals, i.e. command references, directly to the given device. Additionally the Action Client is subscribed to a Topic (<code>*_controller/command</code>) that can be used to send reference commands from outside the code, e.g. asynchronously from the command line, or from a higher level control Node, e.g. as a result of a planning algorithm.</p>

<blockquote>
<p>It is recommended not to mix these two control modes: choose either to control the device directly from the code by extending our API or through this command Topic.</p>
</blockquote>

<p>Regardless the control mode chosen for the given application, and apart form a customization of the API, the following launch file templates can be used respectively to control several devices or a single one: </p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/overview_launch.svg" alt="overview_launch"></p>

<h3 id="control-modes">Control Modes</h3>

<p>For the sake of simplicity, we are going to cover all the control modes for a single <em>qb SoftHand</em>, but it is just a matter of putting things together and set the launch file parameters properly to control several devices together (<a href="http://wiki.ros.org/qb_chain_control">qb_chain_control</a> is dedicated for such a scope). </p>

<p>All the control modes are initialized in the same manner but with distinct command line arguments. The default single-device control Node which brings everything up and simply waits for commands on the above-mentioned Action topic is the following:</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch qb_hand_control control.launch standalone:=true activate_on_initialization:=true device_id:=&lt;actual_device_id&gt;

</code></pre></div>
<h6 id="the-arguments-explained">The arguments explained</h6>

<ul>
<li>
<code>activate_on_initialization [false]</code>: Activates the motor at startup (the device will not move since the first command reference is received).</li>
<li>
<code>device_id [1]</code>: Each device has its own ID, you need to set the one of the actual device connect to your system. </li>
<li>
<code>standalone [false]</code>: Starts the Communication Handler together with the control Node. If you set this to <code>false</code> (or remove it since the default value is <code>false</code>), you need to launch the Communication Handler in a separate terminal.</li>
</ul>

<p>It is worth noting that the activation of the motor can be postponed to improved safety if you are not aware of the state of the system at startup. To do so just set <code>activate_on_initialization:=false</code> (or remove it since the default value is <code>false</code>) and make a call to the Communication Handler <code>activate_motors</code> Service, when your system is ready, e.g. as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosservice call /communication_handler/activate_motors {"id: &lt;actual_device_id&gt;, max_repeats: 0"}

</code></pre></div>
<h6 id="additional-arguments">Additional arguments</h6>

<ul>
<li>
<code>control_duration [0.01]</code>: The duration of the control loop expressed in seconds.</li>
<li>
<code>get_currents [true]</code>: Choose whether or not to retrieve current measurements from the device.</li>
<li>
<code>get_positions [true]</code>: Choose whether or not to retrieve position measurements from the device.</li>
<li>
<code>get_distinct_packages [true]</code>: Choose whether or not to retrieve current and position measurements from the device in two distinct packages.</li>
<li>
<code>max_repeats [3]</code>: The maximum number of consecutive repetitions to mark retrieved data as corrupted.</li>
<li>
<code>set_commands [true]</code>: Choose whether or not to send command positions to the device.</li>
<li>
<code>set_commands_async [true]</code>: Choose whether or not to send commands without waiting for ack.</li>
<li>
<code>use_rviz [false]</code>: Choose whether or not to use rviz. If enabled you should see a virtual hand on screen performing a similar behavior.</li>
</ul>

<blockquote>
<p>Be aware that the <em>qb SoftHand</em> is desensorized and therefore it is not possible to know exactly the position of each finger: the screen visualization is just the result of an estimation of the closure value and may differ from the real configuration of your <em>qb SoftHand</em> (e.g. when grasping an object).</p>
</blockquote>

<p>The followings are particular control modes which are enabled with few parameters, but the concepts of this paragraph hold for all of them.</p>

<h4 id="1-gui-control">1. GUI Control</h4>

<p>This control mode is the one suggested to test that everything is working as expected. You are able to open and close the <em>qb SoftHand</em> interactively, but nothing more than this.</p>

<blockquote>
<p>You will probably need this only the very first times and for debugging.</p>
</blockquote>

<p>To start this mode just add <code>use_controller_gui:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_waypoints</code> is not used).</p>

<p>After a while a GUI should appear to screen with two empty dropdown menus, a red enable button below them, and a <em>speed scaling</em> slider at the bottom.
1. Select the <em>Controller Manager</em> namespace from the left menu, e.g. <code>/&lt;robot_namespace&gt;/control/controller_manager</code> (where <code>&lt;robot_namespace&gt;</code> is an additional argument of the launch file needed with several devices). This enables the right menu which provides all the controllers available for the connected device.
1. Select the <em>qb SoftHand</em> controller from the second dropdown menu and enable it through the circular button.
1. A single slider will appear in the GUI to control the closure of the hand, which ranges from <code>0</code> (hand completely open) to <code>1</code> (hand completely closed). Move the slider to perform a complete grasp or to partially open/close the <em>qb SoftHand</em>. You can also vary the speed through the bottom <em>speed scaling</em> slider if you like a faster/slower motion. No other timing constraints can be set in this mode.</p>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/screen_gui.png" alt="screen_gui"></p>

<h4 id="2-waypoint-control">2. Waypoint Control</h4>

<p>This control mode is a bit more structured and useful than the previous: it allows to set a fixed trajectory of any number of position waypoints (with timing constraints) and set the robot to cycle infinitely on it (because of the loop it is recommended to set the first and last waypoint in a similar configuration to avoid unwanted sudden changes).</p>

<p>To start this mode just add <code>use_waypoints:=true</code> to the general <code>roslaunch</code> command (be sure that the opposite <code>use_controller_gui</code> is not used). You won't see any control interface in this case but the <em>qb SoftHand</em> should start moving according to the given trajectory, parsed from a yaml file located at</p>
<div class="highlight"><pre><code class="language-" data-lang="">&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml

</code></pre></div>
<p>where <code>robot_name</code> and <code>robot_package</code> are two additional launch file arguments.</p>

<h5 id="customization">Customization</h5>

<p>You can modify the waypoint trajectory to replicate the behavior you want: either change the <code>&lt;robot_package&gt;_control/config/&lt;robot_name&gt;_waypoints.yaml</code> or add another custom application-specific file in the <code>config</code> directory. In the second case you need to set the argument <code>robot_name</code> properly when launching the command from the terminal.</p>

<p>The waypoint configuration is as follows:</p>
<div class="highlight"><pre><code class="language-" data-lang=""># Waypoints describe the desired motion trajectory:
#  - time [s]: can be either a single value or an interval for which joint_positions hold
#  - joint_positions:
#     - hand closure [0,1];
#  - joint_velocities: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s;
#  - joint_accelerations: optional, use it only if you want a nonzero value
#     - hand closure [0,1]/s^2;
#
# It is worth noting that, if specified, joint_positions, joint_velocities and joint_accelerations must be of size one.

waypoints:
 -
   time: [1.0]
   joint_positions:
     &lt;device_name&gt;: [0.0]
 -
   time: [2.25, 2.75]
   joint_positions:
     &lt;device_name&gt;: [0.8]
  -
    time: [4.0]
    joint_positions:
      &lt;device_name&gt;: [0.5]
    joint_velocities:
      &lt;device_name&gt;: [-0.5]
 -
   ...

</code></pre></div>
<h4 id="3-api-control">3. API Control</h4>

<p>If you need a complex (i.e. real) control application, e.g. the <em>qb SoftHand</em> is mounted on a robot which uses computer vision aid to grasp objects, the previous two control modes don't really help much. What we provide for real applications is the full ROS libraries to manage and control the <em>qb SoftHand</em>.</p>

<p>You have to dig into the <a href="http://wiki.ros.org/qb_hand">qb_hand</a> package documentation and find what better suits for your needs, e.g. extend the <code>qbDeviceControl</code> class provided, or even redesign some of its parts by following an approach similar to ours.</p>

<blockquote>
<p>Our recommendation is to use as much as possible our resources, classes and macros to help you while developing your application. Don't reinvent the wheel!</p>
</blockquote>

<p>At last, if you come up with a something useful for the whole community, it will be amazing if you propose your improvement with a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</p>

<h2 id="demo-applications">Demo Applications</h2>

<p><img src="https://bitbucket.org//qbrobotics/qbhand-ros.git/raw/production-kinetic/qb_hand_media/example.png" alt="example"></p>

<h2 id="ros-packages-overview">ROS Packages Overview</h2>

<table>
<thead>
<tr>
<th style="text-align: right"></th>
<th>Packages</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_device">qb_device</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_device_bringup">qb_device_bringup</a>, <a href="http://wiki.ros.org/qb_device_control">qb_device_control</a>, <a href="http://wiki.ros.org/qb_device_description">qb_device_description</a>, <a href="http://wiki.ros.org/qb_device_driver">qb_device_driver</a>, <a href="http://wiki.ros.org/qb_device_hardware_interface">qb_device_hardware_interface</a>, <a href="http://wiki.ros.org/qb_device_msgs">qb_device_msgs</a>, <a href="http://wiki.ros.org/qb_device_srvs">qb_device_srvs</a>, <a href="http://wiki.ros.org/qb_device_utils">qb_device_utils</a>
</td>
</tr>
<tr>
<td style="text-align: right">
<a href="http://wiki.ros.org/qb_hand">qb_hand</a>:</td>
<td>
<a href="http://wiki.ros.org/qb_hand_control">qb_hand_control</a>, <a href="http://wiki.ros.org/qb_hand_description">qb_hand_description</a>, <a href="http://wiki.ros.org/qb_hand_hardware_interface">qb_hand_hardware_interface</a>
</td>
</tr>
</tbody>
</table>

<h2 id="support-bugs-and-contribution">Support, Bugs and Contribution</h2>

<p>Since we are not only focused on this project it might happen that you encounter some trouble once in a while. Maybe we have just forget to think about your specific use case or we have not seen a terrible bug inside our code. In such a case, we are really sorry for the inconvenience and we will provide any support you need.</p>

<p>To help you in the best way we can, we are asking you to do the most suitable of the following steps:</p>

<ol>
<li>It is the first time you are holding a <em>qb SoftHand</em>, or the first time you are using ROS, or even both: it is always a pleasure for us to solve your problems, but please consider first to read again the instructions above and the ROS tutorials. If you have ROS related questions the right place to ask is <a href="http://answers.ros.org/questions/">ROS Answers</a>.</li>
<li>You are a beginner user stuck on something you completely don't know how to solve or you are experiencing unexpected behaviour: feel free to contact us at <a href="https://bitbucket.org//qbrobotics/qbhand-ros.git/src/production-kinetic/support+ros@qbrobotics.com">support+ros at qbrobotics.com</a>, you will receive the specific support you need as fast as we can handle it.</li>
<li>You are quite an expert user, everything has always worked fine, but now you have founded something strange and you don't know how to fix it: we will be glad if you open an Issue in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>.</li>
<li>You are definitely an expert user, you have found a bug in our code and you have also correct it: it will be amazing if you open a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>; we will merge it as soon as possible.</li>
<li>You are comfortable with <em>qbrobotics速</em> products but you are wondering whether is possible to add some additional software features: feel free to open respectively an Issue or a Pull Request in the package of interest on <a href="https://bitbucket.org/account/user/qbrobotics/projects/ROS">our Bitbucket</a>, according to whether it is just an idea or you have already provided your solution.</li>
</ol>

<p>In any case, thank you for using <a href="https://www.qbrobotics.com"><em>qbrobotics速</em></a> solutions.</p>

<h2 id="purchase">Purchase</h2>

<p>If you have just found out our company and you are interested in our products, come to <a href="https://www.qbrobotics.com">visit us</a> and feel free to ask for a quote.</p>

<h2 id="roadmap">Roadmap</h2>

<p>Features to be implemented in the future:</p>

<ul>
<li>Improve stability</li>
<li>CI an tests</li>
<li>Gazebo simulation</li>
<li>Improved controller to better replicate the real grasp</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>indigo</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-ardent">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>ardent</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("crystal");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/ros-infrastructure" title="Find rosindex in Github">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">ros-infrastructure</span>
          </a>
          |
          <em>generated on 2019-05-24</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
