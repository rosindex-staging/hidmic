<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="https://ros-infrastructure.github.io/index.ros.org//r/movie_publisher/">
    
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/sphinx.css">
    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie-1.4.1/jquery.cookie.js type="text/javascript"></script>

    <script type="text/javascript" src=/js/ga.js async></script>
    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">

      <div align="center">
        <br>
        <table id="topnav-table">
          <tr>
            <td valign="middle">
                ROS Resources:
              <a href="http://wiki.ros.org/">Documentation</a>
              |
              <a href="http://wiki.ros.org/Support">Support</a>
              |
              <a href="http://discourse.ros.org/">Discussion Forum</a>
              |
              <a href="http://status.ros.org/">Service Status</a>
              |
              <a href="http://answers.ros.org/">Q&A answers.ros.org</a>
            </td>
          </tr>
        </table> <!-- topnav-table -->
      </div>

      <div class="row">

        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/ros-infrastructure/rosindex/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <ul class="list-inline" style="margin-bottom:0px;">
                <li><a class="btn btn-link" href="/about">About</a></li>

                <li class="dropdown">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Index <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li><a href="/packages/page/1/time/">Package List</a></li>
                    <li><a href="/repos/page/1/time/">Repository List</a></li>

                    <li class="hidden" class="divider"></li>


                    <li class="hidden"><a href="/srvs/">Nodes</a></li>
                    <li class="hidden"><a href="/msgs/">Messages</a></li>
                    <li class="hidden"><a href="/srvs/">Services</a></li>
                    <li class="hidden"><a href="/srvs/">Plugins</a></li>

                    <li class="divider"></li>

                    <li><a href="/deps/">System Dependencies</a></li>
                  </ul>
                </li>

                <li class="dropdown disabled">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Doc <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    
                    <li>
                      <a href="/doc/ros2">
                        ROS2 Overview
                      </a>
                    </li>
                    
                    <li class="hidden" class="divider"></li>

                    <li class="hidden"><a href="/doc/tutorials">Tutorials</a></li>
                    <li class="hidden"><a href="/doc/readmes">Readmes</a></li>
                    <li class="hidden"><a href="/doc/apis">APIs</a></li>
                  </ul>
                </li>

                <li><a class="btn btn-link" href="/contribute">Contribute</a></li>
                <li><a class="btn btn-link" href="/stats">Stats</a></li>
              </ul>

            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form id="top-searchbox" action="/search/" role="form" method="get">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="term" placeholder="Search ROS">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" title="Search ROS" type="submit">
                  <span class="glyphicon glyphicon-search"></span>
                </button>
                <a href="https://lunrjs.com/guides/searching.html"
                   title="Help to Search" class="btn btn-default btn-sm">
                  <span class="glyphicon glyphicon-question-sign"></span>
                </a>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>
  <script type="text/javascript">
    $('#top-searchbox').submit(function() {
        return $('#top-searchbox input:text').filter(function() {
          return $(this).val() == "";
        }).length == 0;
    });
  </script>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">movie_publisher</li>
        <!--<li class="active">movie_publisher</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="crystal-option" class="distro-button btn btn-xs btn-default" href="#crystal" data="crystal">
      <input type="radio" name="options" id="crystal-radio" autocomplete="off"> crystal
    </label>
  
    <label id="bouncy-option" class="distro-button btn btn-xs btn-default" href="#bouncy" data="bouncy">
      <input type="radio" name="options" id="bouncy-radio" autocomplete="off"> bouncy
    </label>
  
    <label id="melodic-option" class="distro-button btn btn-xs btn-primary" href="#melodic" data="melodic">
      <input type="radio" name="options" id="melodic-radio" autocomplete="off"> melodic
    </label>
  
    <label id="lunar-option" class="distro-button btn btn-xs btn-default" href="#lunar" data="lunar">
      <input type="radio" name="options" id="lunar-radio" autocomplete="off"> lunar
    </label>
  
    <label id="kinetic-option" class="distro-button btn btn-xs btn-primary" href="#kinetic" data="kinetic">
      <input type="radio" name="options" id="kinetic-radio" autocomplete="off"> kinetic
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-primary" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="ardent" id="ardent-option" class="disabled older-distro-option"  href="#ardent">
          <a href="#ardent" data="ardent" id="ardent-button">ardent</a>
        </li>
      
        <li data="jade" id="jade-option" class="disabled older-distro-option"  href="#jade">
          <a href="#jade" data="jade" id="jade-button">jade</a>
        </li>
      
        <li data="hydro" id="hydro-option" class="disabled older-distro-option"  href="#hydro">
          <a href="#hydro" data="hydro" id="hydro-button">hydro</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/movie_publisher">movie_publisher</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/movie_publisher"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-peci1-movie_publisher
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-peci1-movie_publisher" role="menuitem" tabindex="-1" href="/r/movie_publisher/github-peci1-movie_publisher" data="github-peci1-movie_publisher">
                    <span class="glyphicon glyphicon-star"></span>
                    github-peci1-movie_publisher
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-crystal">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>crystal</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-bouncy">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>bouncy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/peci1/movie_publisher.git">https://github.com/peci1/movie_publisher.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">melodic-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-03-17
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/movie_publisher/github-peci1-movie_publisher">movie_publisher</a></td>
                    <td>1.3.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="movie_publisher">movie_publisher</h1>

<p>This package contains several tools for using movie files in ROS (playback, conversion to bag files etc.).</p>

<p>It handles any file formats the system installation of ffmpeg can decode.</p>

<p><strong>Important: This package is meant to work with moviepy. However, due to packaging issues, moviepy cannot be installed
automatically as a dependency. There's a fallback using OpenCV, which is however worse. Please, install moviepy manually
calling:</strong></p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo pip install moviepy
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosdep install python-moviepy-pip
</code></pre></div>
<h2 id="main-tools">Main tools</h2>

<ul>
<li>
<code>movie_publisher_node</code>: A ROS node that serves a video file as video topic source (<code>sensor_msgs/Image</code> and friends).</li>
<li>
<code>movie_publisher.launch</code>: A launch file for convenient usage of the node. It also allows starting an 
<code>image_transport/republish</code> node that converts the video stream from raw to compressed/theora.
In the <code>immediate</code> mode, it can also be used to convert video files to bagfiles in a batch.</li>
<li>
<code>movie_to_bag</code>: A batch script that takes a video as input and transforms it into a bag file.</li>
<li>
<code>add_movie_to_bag</code>: A batch script that adds a video as a topic into an existing bag file.</li>
</ul>

<h3 id="helper-tools">Helper tools</h3>

<ul>
<li>
<code>fix_bag_timestamps</code>: A batch script that rewrites bag files so that the message publication time is taken from the 
message header. This allows you to generate bagfile data at high speed and then reprocess them to have more suitable
publication timestamps.</li>
<li>
<code>merge.py</code>: A copy of <a href="https://github.com/srv/srv_tools/blob/kinetic/bag_tools/scripts/merge.py">srv_tools/merge.py</a> 
which is not available in indigo.</li>
</ul>

<h2 id="movie_publisher_node">movie_publisher_node</h2>

<p>The node can run with either of two backends - <code>moviepy</code> and <code>opencv</code>. <code>moviepy</code> is strongly recommended, as it uses
<code>ffmpeg</code>, which is quite versatile and efficient. Is you do not set the <code>backend</code> param, autodetection is run.</p>

<h3 id="published-topics">Published topics</h3>

<ul>
<li>
<code>movie</code> (<code>sensor_msgs/Image</code>): The published movie, in raw format.</li>
</ul>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie_file</code> (string, required): Path to the movie to play. Any format that ffmpeg can decode.</li>
<li>
<code>fps</code> (float, optional): If set, the playback will be at the specified FPS (speeding up/slowing down the movie).</li>
<li>
<code>start</code> (float|tuple|string, optional): If set, playback will start from the specified time.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>end</code> and <code>duration</code>.</li>
<li>
<code>end</code> (float|tuple|string, optional): If set, playback will stop at the specified time (not affected by start).
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>duration</code>.</li>
<li>
<code>duration</code> (float|tuple|string, optional): If set, playback will have this duration. If end is also set, the
  duration is counted from the end of the clip, otherwise, it is the duration from the start of the clip.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>end</code>.</li>
<li>
<code>loop</code> (bool, default False): Whether to loop the movie until the node is shut down. Exludes <code>immediate</code>.</li>
<li>
<code>immediate</code> (bool, default False): If True, the movie will be processed and published as quickly as possible not
  waiting for the real time. The timestamps in the resulting messages act "real-world-like" (i.e. 15 FPS means
  the frames' timestamps will be 1/15 sec apart). You can set <code>fake_time_start</code> if you want these timestamps to
  begin from a non-zero time. Excludes <code>loop</code>.</li>
<li>
<code>playback_rate</code> (float, optional): If set to a number, immediate mode will not play as fast as possible, but at this
  rate (set the rate to a number where you do not lose any messages, e.g. in image_transport/republish).</li>
<li>
<code>fake_time_start</code> (float, default 0.0): Used with <code>immediate</code> to specify the timestamp of the first message.</li>
<li>
<code>frame_id</code> (string, default ""): The frame_id used in the messages' headers.</li>
<li>
<code>spin_after_end</code> (bool, default False): If True, a rospy.spin() is called after the movie has been published.</li>
<li>
<code>verbose</code> (bool, default False): If True, logs info about every frame played.</li>
<li>
<code>wait_after_publisher_created</code> (float, default 1.0): A workaround for the case where you need to give your
  subscribers some time after the publisher was created. Tweak this number until you get no missing start
  messages.</li>
<li>
<code>publisher_queue_size</code> (int, default 1000 in immediate mode, 10 otherwise): <code>queue_size</code> of the movie publisher.</li>
<li>
<code>backend</code> (string, default "moviepy"): The backend to use for reading video. Either <code>moviepy</code> or <code>opencv</code>. If
  <code>moviepy</code> is selected and not found, <code>opencv</code> will be used (which might support less codecs).</li>
<li>
<code>ffmpeg</code> (string, default ""): If nonempty, specifies the (absolute) path to the ffmpeg binary to use.</li>
</ul>

<h2 id="movie_publisher-launch">movie_publisher.launch</h2>

<p>This launch file takes arguments with the same name as the node's parameters.</p>

<p>Additionally, it takes these arguments:</p>

<ul>
<li>
<code>transport</code> (string, default <code>'raw'</code>): Type of the image transport. The
  launch file will start up an <code>image_transport/republish</code> node that publishes the video
  encoded to this transport type.</li>
<li>
<code>republished_topic_basename</code> (string, default <code>movie_$(arg transport)</code>): Base name of the
  topic that will serve the republished messages. Full name of the topic will be
  <code>$(arg republished_topic_basename)/$(arg transport)</code> (or <code>$(arg republished_topic_basename)</code> in case of <code>raw</code> 
  transport). The base name cannot be the same as the topic the <code>movie_publisher_node</code> subscribes to (<code>movie</code> by 
  default).</li>
</ul>

<h2 id="movie_to_bag">movie_to_bag</h2>

<p>Convert a movie file to a bag file with video topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): name of the movie's topic in the bag file</li>
<li>
<code>overwrite_bag</code> (bool, default false): If true, overwrites existing <code>bag</code> file, otherwise exits with error if <code>bag</code> 
exists.</li>
<li>
<code>tmp_bag</code> (string, default <code>/tmp/movie.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher movie_to_bag _movie:=movie.mp4 _bag:=movie.bag _topic:="/movie" start:=5 fake_time_start:=1548323340.24
</code></pre></div>
<h2 id="add_movie_to_bag">add_movie_to_bag</h2>

<p>Add a movie file to an existing bagfile as a topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag_in</code> (string): Path to the source bag file.</li>
<li>
<code>bag_out</code> (string, default: <code>output.bag</code>): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): Name of the movie's topic in the bag file.</li>
<li>
<code>movie_delay</code> (int, default <code>0</code>): Delay (in seconds) of the movie file from the bag file start. May be negative.</li>
<li>
<code>overwrite_out_bag</code> (bool, default false): If true, overwrites existing <code>bag_out</code> file, otherwise exits with error if 
<code>bag_out</code> exists.</li>
<li>
<code>bag_tmp</code> (string, default <code>/tmp/movie_add_to.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher add_movie_to_bag _movie:=movie.mp4 _bag_in:=movie_in.bag _bag_out:=movie_out.bag _topic:="/movie" start:=5 movie_delay:=-1
</code></pre></div>
<h2 id="fix_bag_timestamps">fix_bag_timestamps</h2>

<p>Goes through <code>in_bag</code> and for all messages with a header field sets their publication time to the time stored in their 
<code>header.stamp</code> plus <code>delay</code>. If <code>topics</code> are set, only works on messages on the listed topics. Reading timestamps from 
<code>/tf</code> is also supported.</p>

<p>It is a Python script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>in_bag</code> (string): Path to the source bag file.</li>
<li>
<code>out_bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topics</code> (string, default: <code>''</code>): If nonempty, rewrite only timestamps of the listed topics. Pass a comma-separated 
list of topics. </li>
<li>
<code>delay</code> (int, default <code>0</code>): Delay (in seconds) which is added to the timestamp read from header. May be negative.</li>
<li>
<code>overwrite_existing</code> (bool, default false): If true, overwrites existing <code>out_bag</code> file, otherwise exits with error if 
<code>out_bag</code> exists.</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-lunar">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>lunar</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kinetic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/peci1/movie_publisher.git">https://github.com/peci1/movie_publisher.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">kinetic-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-03-17
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/movie_publisher/github-peci1-movie_publisher">movie_publisher</a></td>
                    <td>1.2.2</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="movie_publisher">movie_publisher</h1>

<p>This package contains several tools for using movie files in ROS (playback, conversion to bag files etc.).</p>

<p>It handles any file formats the system installation of ffmpeg can decode.</p>

<p><strong>Important: This package is meant to work with moviepy. However, due to packaging issues, moviepy cannot be installed
automatically as a dependency. There's a fallback using OpenCV, which is however worse. Please, install moviepy manually
calling:</strong></p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo pip install moviepy
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosdep install python-moviepy-pip
</code></pre></div>
<h2 id="main-tools">Main tools</h2>

<ul>
<li>
<code>movie_publisher_node</code>: A ROS node that serves a video file as video topic source (<code>sensor_msgs/Image</code> and friends).</li>
<li>
<code>movie_publisher.launch</code>: A launch file for convenient usage of the node. It also allows starting an 
<code>image_transport/republish</code> node that converts the video stream from raw to compressed/theora.
In the <code>immediate</code> mode, it can also be used to convert video files to bagfiles in a batch.</li>
<li>
<code>movie_to_bag</code>: A batch script that takes a video as input and transforms it into a bag file.</li>
<li>
<code>add_movie_to_bag</code>: A batch script that adds a video as a topic into an existing bag file.</li>
</ul>

<h3 id="helper-tools">Helper tools</h3>

<ul>
<li>
<code>fix_bag_timestamps</code>: A batch script that rewrites bag files so that the message publication time is taken from the 
message header. This allows you to generate bagfile data at high speed and then reprocess them to have more suitable
publication timestamps.</li>
<li>
<code>merge.py</code>: A copy of <a href="https://github.com/srv/srv_tools/blob/kinetic/bag_tools/scripts/merge.py">srv_tools/merge.py</a> 
which is not available in indigo.</li>
</ul>

<h2 id="movie_publisher_node">movie_publisher_node</h2>

<p>The node can run with either of two backends - <code>moviepy</code> and <code>opencv</code>. <code>moviepy</code> is strongly recommended, as it uses
<code>ffmpeg</code>, which is quite versatile and efficient. Is you do not set the <code>backend</code> param, autodetection is run.</p>

<h3 id="published-topics">Published topics</h3>

<ul>
<li>
<code>movie</code> (<code>sensor_msgs/Image</code>): The published movie, in raw format.</li>
</ul>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie_file</code> (string, required): Path to the movie to play. Any format that ffmpeg can decode.</li>
<li>
<code>fps</code> (float, optional): If set, the playback will be at the specified FPS (speeding up/slowing down the movie).</li>
<li>
<code>start</code> (float|tuple|string, optional): If set, playback will start from the specified time.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>end</code> and <code>duration</code>.</li>
<li>
<code>end</code> (float|tuple|string, optional): If set, playback will stop at the specified time (not affected by start).
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>duration</code>.</li>
<li>
<code>duration</code> (float|tuple|string, optional): If set, playback will have this duration. If end is also set, the
  duration is counted from the end of the clip, otherwise, it is the duration from the start of the clip.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>end</code>.</li>
<li>
<code>loop</code> (bool, default False): Whether to loop the movie until the node is shut down. Exludes <code>immediate</code>.</li>
<li>
<code>immediate</code> (bool, default False): If True, the movie will be processed and published as quickly as possible not
  waiting for the real time. The timestamps in the resulting messages act "real-world-like" (i.e. 15 FPS means
  the frames' timestamps will be 1/15 sec apart). You can set <code>fake_time_start</code> if you want these timestamps to
  begin from a non-zero time. Excludes <code>loop</code>.</li>
<li>
<code>playback_rate</code> (float, optional): If set to a number, immediate mode will not play as fast as possible, but at this
  rate (set the rate to a number where you do not lose any messages, e.g. in image_transport/republish).</li>
<li>
<code>fake_time_start</code> (float, default 0.0): Used with <code>immediate</code> to specify the timestamp of the first message.</li>
<li>
<code>frame_id</code> (string, default ""): The frame_id used in the messages' headers.</li>
<li>
<code>spin_after_end</code> (bool, default False): If True, a rospy.spin() is called after the movie has been published.</li>
<li>
<code>verbose</code> (bool, default False): If True, logs info about every frame played.</li>
<li>
<code>wait_after_publisher_created</code> (float, default 1.0): A workaround for the case where you need to give your
  subscribers some time after the publisher was created. Tweak this number until you get no missing start
  messages.</li>
<li>
<code>publisher_queue_size</code> (int, default 1000 in immediate mode, 10 otherwise): <code>queue_size</code> of the movie publisher.</li>
<li>
<code>backend</code> (string, default "moviepy"): The backend to use for reading video. Either <code>moviepy</code> or <code>opencv</code>. If
  <code>moviepy</code> is selected and not found, <code>opencv</code> will be used (which might support less codecs).</li>
<li>
<code>ffmpeg</code> (string, default ""): If nonempty, specifies the (absolute) path to the ffmpeg binary to use.</li>
</ul>

<h2 id="movie_publisher-launch">movie_publisher.launch</h2>

<p>This launch file takes arguments with the same name as the node's parameters.</p>

<p>Additionally, it takes these arguments:</p>

<ul>
<li>
<code>transport</code> (string, default <code>'raw'</code>): Type of the image transport. The
  launch file will start up an <code>image_transport/republish</code> node that publishes the video
  encoded to this transport type.</li>
<li>
<code>republished_topic_basename</code> (string, default <code>movie_$(arg transport)</code>): Base name of the
  topic that will serve the republished messages. Full name of the topic will be
  <code>$(arg republished_topic_basename)/$(arg transport)</code> (or <code>$(arg republished_topic_basename)</code> in case of <code>raw</code> 
  transport). The base name cannot be the same as the topic the <code>movie_publisher_node</code> subscribes to (<code>movie</code> by 
  default).</li>
</ul>

<h2 id="movie_to_bag">movie_to_bag</h2>

<p>Convert a movie file to a bag file with video topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): name of the movie's topic in the bag file</li>
<li>
<code>overwrite_bag</code> (bool, default false): If true, overwrites existing <code>bag</code> file, otherwise exits with error if <code>bag</code> 
exists.</li>
<li>
<code>tmp_bag</code> (string, default <code>/tmp/movie.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher movie_to_bag _movie:=movie.mp4 _bag:=movie.bag _topic:="/movie" start:=5 fake_time_start:=1548323340.24
</code></pre></div>
<h2 id="add_movie_to_bag">add_movie_to_bag</h2>

<p>Add a movie file to an existing bagfile as a topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag_in</code> (string): Path to the source bag file.</li>
<li>
<code>bag_out</code> (string, default: <code>output.bag</code>): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): Name of the movie's topic in the bag file.</li>
<li>
<code>movie_delay</code> (int, default <code>0</code>): Delay (in seconds) of the movie file from the bag file start. May be negative.</li>
<li>
<code>overwrite_out_bag</code> (bool, default false): If true, overwrites existing <code>bag_out</code> file, otherwise exits with error if 
<code>bag_out</code> exists.</li>
<li>
<code>bag_tmp</code> (string, default <code>/tmp/movie_add_to.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher add_movie_to_bag _movie:=movie.mp4 _bag_in:=movie_in.bag _bag_out:=movie_out.bag _topic:="/movie" start:=5 movie_delay:=-1
</code></pre></div>
<h2 id="fix_bag_timestamps">fix_bag_timestamps</h2>

<p>Goes through <code>in_bag</code> and for all messages with a header field sets their publication time to the time stored in their 
<code>header.stamp</code> plus <code>delay</code>. If <code>topics</code> are set, only works on messages on the listed topics. Reading timestamps from 
<code>/tf</code> is also supported.</p>

<p>It is a Python script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>in_bag</code> (string): Path to the source bag file.</li>
<li>
<code>out_bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topics</code> (string, default: <code>''</code>): If nonempty, rewrite only timestamps of the listed topics. Pass a comma-separated 
list of topics. </li>
<li>
<code>delay</code> (int, default <code>0</code>): Delay (in seconds) which is added to the timestamp read from header. May be negative.</li>
<li>
<code>overwrite_existing</code> (bool, default false): If true, overwrites existing <code>out_bag</code> file, otherwise exits with error if 
<code>out_bag</code> exists.</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/peci1/movie_publisher.git">https://github.com/peci1/movie_publisher.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">indigo-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-03-17
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/movie_publisher/github-peci1-movie_publisher">movie_publisher</a></td>
                    <td>1.1.2</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="movie_publisher">movie_publisher</h1>

<p>This package contains several tools for using movie files in ROS (playback, conversion to bag files etc.).</p>

<p>It handles any file formats the system installation of ffmpeg can decode.</p>

<p><strong>Important: This package is meant to work with moviepy. However, due to packaging issues, moviepy cannot be installed
automatically as a dependency. There's a fallback using OpenCV, which is however worse. Please, install moviepy manually
calling:</strong></p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo pip install moviepy
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosdep install python-moviepy-pip
</code></pre></div>
<h2 id="main-tools">Main tools</h2>

<ul>
<li>
<code>movie_publisher_node</code>: A ROS node that serves a video file as video topic source (<code>sensor_msgs/Image</code> and friends).</li>
<li>
<code>movie_publisher.launch</code>: A launch file for convenient usage of the node. It also allows starting an 
<code>image_transport/republish</code> node that converts the video stream from raw to compressed/theora.
In the <code>immediate</code> mode, it can also be used to convert video files to bagfiles in a batch.</li>
<li>
<code>movie_to_bag</code>: A batch script that takes a video as input and transforms it into a bag file.</li>
<li>
<code>add_movie_to_bag</code>: A batch script that adds a video as a topic into an existing bag file.</li>
</ul>

<h3 id="helper-tools">Helper tools</h3>

<ul>
<li>
<code>fix_bag_timestamps</code>: A batch script that rewrites bag files so that the message publication time is taken from the 
message header. This allows you to generate bagfile data at high speed and then reprocess them to have more suitable
publication timestamps.</li>
<li>
<code>merge.py</code>: A copy of <a href="https://github.com/srv/srv_tools/blob/kinetic/bag_tools/scripts/merge.py">srv_tools/merge.py</a> 
which is not available in indigo.</li>
</ul>

<h2 id="movie_publisher_node">movie_publisher_node</h2>

<p>The node can run with either of two backends - <code>moviepy</code> and <code>opencv</code>. <code>moviepy</code> is strongly recommended, as it uses
<code>ffmpeg</code>, which is quite versatile and efficient. Is you do not set the <code>backend</code> param, autodetection is run.</p>

<h3 id="published-topics">Published topics</h3>

<ul>
<li>
<code>movie</code> (<code>sensor_msgs/Image</code>): The published movie, in raw format.</li>
</ul>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie_file</code> (string, required): Path to the movie to play. Any format that ffmpeg can decode.</li>
<li>
<code>fps</code> (float, optional): If set, the playback will be at the specified FPS (speeding up/slowing down the movie).</li>
<li>
<code>start</code> (float|tuple|string, optional): If set, playback will start from the specified time.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>end</code> and <code>duration</code>.</li>
<li>
<code>end</code> (float|tuple|string, optional): If set, playback will stop at the specified time (not affected by start).
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>duration</code>.</li>
<li>
<code>duration</code> (float|tuple|string, optional): If set, playback will have this duration. If end is also set, the
  duration is counted from the end of the clip, otherwise, it is the duration from the start of the clip.
  Can be expressed in seconds <code>(15.35)</code>, in <code>(min, sec)</code>, in <code>(hour, min, sec)</code>,
  or as a string: <code>'01:03:05.35'</code>.
  Cannot be set together with <code>start</code> and <code>end</code>.</li>
<li>
<code>loop</code> (bool, default False): Whether to loop the movie until the node is shut down. Exludes <code>immediate</code>.</li>
<li>
<code>immediate</code> (bool, default False): If True, the movie will be processed and published as quickly as possible not
  waiting for the real time. The timestamps in the resulting messages act "real-world-like" (i.e. 15 FPS means
  the frames' timestamps will be 1/15 sec apart). You can set <code>fake_time_start</code> if you want these timestamps to
  begin from a non-zero time. Excludes <code>loop</code>.</li>
<li>
<code>playback_rate</code> (float, optional): If set to a number, immediate mode will not play as fast as possible, but at this
  rate (set the rate to a number where you do not lose any messages, e.g. in image_transport/republish).</li>
<li>
<code>fake_time_start</code> (float, default 0.0): Used with <code>immediate</code> to specify the timestamp of the first message.</li>
<li>
<code>frame_id</code> (string, default ""): The frame_id used in the messages' headers.</li>
<li>
<code>spin_after_end</code> (bool, default False): If True, a rospy.spin() is called after the movie has been published.</li>
<li>
<code>verbose</code> (bool, default False): If True, logs info about every frame played.</li>
<li>
<code>wait_after_publisher_created</code> (float, default 1.0): A workaround for the case where you need to give your
  subscribers some time after the publisher was created. Tweak this number until you get no missing start
  messages.</li>
<li>
<code>publisher_queue_size</code> (int, default 1000 in immediate mode, 10 otherwise): <code>queue_size</code> of the movie publisher.</li>
<li>
<code>backend</code> (string, default "moviepy"): The backend to use for reading video. Either <code>moviepy</code> or <code>opencv</code>. If
  <code>moviepy</code> is selected and not found, <code>opencv</code> will be used (which might support less codecs).</li>
<li>
<code>ffmpeg</code> (string, default ""): If nonempty, specifies the (absolute) path to the ffmpeg binary to use.</li>
</ul>

<h2 id="movie_publisher-launch">movie_publisher.launch</h2>

<p>This launch file takes arguments with the same name as the node's parameters.</p>

<p>Additionally, it takes these arguments:</p>

<ul>
<li>
<code>transport</code> (string, default <code>'raw'</code>): Type of the image transport. The
  launch file will start up an <code>image_transport/republish</code> node that publishes the video
  encoded to this transport type.</li>
<li>
<code>republished_topic_basename</code> (string, default <code>movie_$(arg transport)</code>): Base name of the
  topic that will serve the republished messages. Full name of the topic will be
  <code>$(arg republished_topic_basename)/$(arg transport)</code> (or <code>$(arg republished_topic_basename)</code> in case of <code>raw</code> 
  transport). The base name cannot be the same as the topic the <code>movie_publisher_node</code> subscribes to (<code>movie</code> by 
  default).</li>
</ul>

<h2 id="movie_to_bag">movie_to_bag</h2>

<p>Convert a movie file to a bag file with video topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): name of the movie's topic in the bag file</li>
<li>
<code>overwrite_bag</code> (bool, default false): If true, overwrites existing <code>bag</code> file, otherwise exits with error if <code>bag</code> 
exists.</li>
<li>
<code>tmp_bag</code> (string, default <code>/tmp/movie.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher movie_to_bag _movie:=movie.mp4 _bag:=movie.bag _topic:="/movie" start:=5 fake_time_start:=1548323340.24
</code></pre></div>
<h2 id="add_movie_to_bag">add_movie_to_bag</h2>

<p>Add a movie file to an existing bagfile as a topic.</p>

<p>It is a Bash script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline or via ROS param
server. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>movie</code> (string): Path to the source movie file.</li>
<li>
<code>bag_in</code> (string): Path to the source bag file.</li>
<li>
<code>bag_out</code> (string, default: <code>output.bag</code>): Path where the result should be stored.</li>
<li>
<code>topic</code> (string): Name of the movie's topic in the bag file.</li>
<li>
<code>movie_delay</code> (int, default <code>0</code>): Delay (in seconds) of the movie file from the bag file start. May be negative.</li>
<li>
<code>overwrite_out_bag</code> (bool, default false): If true, overwrites existing <code>bag_out</code> file, otherwise exits with error if 
<code>bag_out</code> exists.</li>
<li>
<code>bag_tmp</code> (string, default <code>/tmp/movie_add_to.bag</code>): Path where a temporary bag file might be stored.</li>
<li>
<code>transport</code> (string, default <code>compressed</code>): Name of the image transport to use for encoding the image. Either <code>raw</code>,
<code>compressed</code>, <code>theora</code> or any other installed image transport.</li>
</ul>

<h3 id="usage">Usage</h3>

<p>Call this script from commandline setting the node-private parameters, and pass any other <code>arg:=value</code> arguments - 
these will be relayed to <code>movie_publisher.launch</code> as is. Do not pass arguments that would collide with the node-private
parameters of this script (e.g. <code>movie_file</code>).</p>

<p>Example:</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun movie_publisher add_movie_to_bag _movie:=movie.mp4 _bag_in:=movie_in.bag _bag_out:=movie_out.bag _topic:="/movie" start:=5 movie_delay:=-1
</code></pre></div>
<h2 id="fix_bag_timestamps">fix_bag_timestamps</h2>

<p>Goes through <code>in_bag</code> and for all messages with a header field sets their publication time to the time stored in their 
<code>header.stamp</code> plus <code>delay</code>. If <code>topics</code> are set, only works on messages on the listed topics. Reading timestamps from 
<code>/tf</code> is also supported.</p>

<p>It is a Python script with ROS node-like API - you pass it parameters via <code>_param:=value</code> on commandline. </p>

<h3 id="node-private-parameters">Node-private parameters:</h3>

<ul>
<li>
<code>in_bag</code> (string): Path to the source bag file.</li>
<li>
<code>out_bag</code> (string): Path where the result should be stored.</li>
<li>
<code>topics</code> (string, default: <code>''</code>): If nonempty, rewrite only timestamps of the listed topics. Pass a comma-separated 
list of topics. </li>
<li>
<code>delay</code> (int, default <code>0</code>): Delay (in seconds) which is added to the timestamp read from header. May be negative.</li>
<li>
<code>overwrite_existing</code> (bool, default false): If true, overwrites existing <code>out_bag</code> file, otherwise exits with error if 
<code>out_bag</code> exists.</li>
</ul>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-ardent">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>ardent</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("crystal");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/ros-infrastructure" title="Find rosindex in Github">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">ros-infrastructure</span>
          </a>
          |
          <em>generated on 2019-05-24</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
