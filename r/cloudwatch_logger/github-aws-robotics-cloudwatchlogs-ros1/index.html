<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="https://ros-infrastructure.github.io/index.ros.org//r/cloudwatch_logger/github-aws-robotics-cloudwatchlogs-ros1/">
    
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/sphinx.css">
    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie-1.4.1/jquery.cookie.js type="text/javascript"></script>

    <script type="text/javascript" src=/js/ga.js async></script>
    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">

      <div align="center">
        <br>
        <table id="topnav-table">
          <tr>
            <td valign="middle">
                ROS Resources:
              <a href="http://wiki.ros.org/">Documentation</a>
              |
              <a href="http://wiki.ros.org/Support">Support</a>
              |
              <a href="http://discourse.ros.org/">Discussion Forum</a>
              |
              <a href="http://status.ros.org/">Service Status</a>
              |
              <a href="http://answers.ros.org/">Q&A answers.ros.org</a>
            </td>
          </tr>
        </table> <!-- topnav-table -->
      </div>

      <div class="row">

        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/ros-infrastructure/rosindex/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <ul class="list-inline" style="margin-bottom:0px;">
                <li><a class="btn btn-link" href="/about">About</a></li>

                <li class="dropdown">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Index <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li><a href="/packages/page/1/time/">Package List</a></li>
                    <li><a href="/repos/page/1/time/">Repository List</a></li>

                    <li class="hidden" class="divider"></li>


                    <li class="hidden"><a href="/srvs/">Nodes</a></li>
                    <li class="hidden"><a href="/msgs/">Messages</a></li>
                    <li class="hidden"><a href="/srvs/">Services</a></li>
                    <li class="hidden"><a href="/srvs/">Plugins</a></li>

                    <li class="divider"></li>

                    <li><a href="/deps/">System Dependencies</a></li>
                  </ul>
                </li>

                <li class="dropdown disabled">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Doc <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    
                    <li>
                      <a href="/doc/ros2">
                        ROS2 Overview
                      </a>
                    </li>
                    
                    <li class="hidden" class="divider"></li>

                    <li class="hidden"><a href="/doc/tutorials">Tutorials</a></li>
                    <li class="hidden"><a href="/doc/readmes">Readmes</a></li>
                    <li class="hidden"><a href="/doc/apis">APIs</a></li>
                  </ul>
                </li>

                <li><a class="btn btn-link" href="/contribute">Contribute</a></li>
                <li><a class="btn btn-link" href="/stats">Stats</a></li>
              </ul>

            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form id="top-searchbox" action="/search/" role="form" method="get">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="term" placeholder="Search ROS">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" title="Search ROS" type="submit">
                  <span class="glyphicon glyphicon-search"></span>
                </button>
                <a href="https://lunrjs.com/guides/searching.html"
                   title="Help to Search" class="btn btn-default btn-sm">
                  <span class="glyphicon glyphicon-question-sign"></span>
                </a>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>
  <script type="text/javascript">
    $('#top-searchbox').submit(function() {
        return $('#top-searchbox input:text').filter(function() {
          return $(this).val() == "";
        }).length == 0;
    });
  </script>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">cloudwatch_logger</li>
        <!--<li class="active">cloudwatch_logger</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="crystal-option" class="distro-button btn btn-xs btn-default" href="#crystal" data="crystal">
      <input type="radio" name="options" id="crystal-radio" autocomplete="off"> crystal
    </label>
  
    <label id="bouncy-option" class="distro-button btn btn-xs btn-default" href="#bouncy" data="bouncy">
      <input type="radio" name="options" id="bouncy-radio" autocomplete="off"> bouncy
    </label>
  
    <label id="melodic-option" class="distro-button btn btn-xs btn-primary" href="#melodic" data="melodic">
      <input type="radio" name="options" id="melodic-radio" autocomplete="off"> melodic
    </label>
  
    <label id="lunar-option" class="distro-button btn btn-xs btn-default" href="#lunar" data="lunar">
      <input type="radio" name="options" id="lunar-radio" autocomplete="off"> lunar
    </label>
  
    <label id="kinetic-option" class="distro-button btn btn-xs btn-primary" href="#kinetic" data="kinetic">
      <input type="radio" name="options" id="kinetic-radio" autocomplete="off"> kinetic
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-default" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="ardent" id="ardent-option" class="disabled older-distro-option"  href="#ardent">
          <a href="#ardent" data="ardent" id="ardent-button">ardent</a>
        </li>
      
        <li data="jade" id="jade-option" class="disabled older-distro-option"  href="#jade">
          <a href="#jade" data="jade" id="jade-button">jade</a>
        </li>
      
        <li data="hydro" id="hydro-option" class="disabled older-distro-option"  href="#hydro">
          <a href="#hydro" data="hydro" id="hydro-button">hydro</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/cloudwatch_logger">cloudwatch_logger</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/cloudwatch_logger"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aws-robotics-cloudwatchlogs-ros1
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aws-robotics-cloudwatchlogs-ros1" role="menuitem" tabindex="-1" href="/r/cloudwatch_logger/github-aws-robotics-cloudwatchlogs-ros1" data="github-aws-robotics-cloudwatchlogs-ros1">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aws-robotics-cloudwatchlogs-ros1
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-crystal">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>crystal</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-bouncy">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>bouncy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aws-robotics/cloudwatchlogs-ros1.git">https://github.com/aws-robotics/cloudwatchlogs-ros1.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-05-20
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/cloudwatch_logger/github-aws-robotics-cloudwatchlogs-ros1">cloudwatch_logger</a></td>
                    <td>2.0.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="cloudwatch_logger">cloudwatch_logger</h1>

<h2 id="overview">Overview</h2>

<p>The <strong><code>cloudwatch_logger</code></strong> node enables logs generated in a ROS system to get sent to AWS CloudWatch Logs. Out of the box, this node provides the ability to subscribe to the <strong><code>/rosout_agg</code></strong>  (rosout aggregated) topic, which all logs using the ROS logging framework will be published to, and sends logs to the AWS CloudWatch Logs service. Logs can be sent to AWS CloudWatch Logs selectively based on log severity. The <strong><code>cloudwatch_logger</code></strong> node can also subscribe to other topics if logs are not sent to <strong><code>/rosout_agg</code></strong>, and it is able to unsubscribe to the rosout_agg topic for getting logs.</p>

<p>The <strong><code>cloudwatch_logger</code></strong> node wraps the <a href="https://github.com/aws/aws-sdk-cpp">aws-sdk-c++</a> in a ROS service API.</p>

<p><strong>Amazon CloudWatch Logs Summary</strong>: AWS CloudWatch Logs can monitor applications and systems using log data. You can create alarms in CloudWatch and receive notifications of particular API activity as captured by CloudTrail and use the notification to perform troubleshooting. By default, logs are kept indefinitely and never expire. You can adjust the retention policy for each log group, keeping the indefinite retention, or choosing a retention periods between 10 years and one day. AWS CloudWatch Logs stores your log data in highly durable storage.</p>

<p><strong>Features in Active Development</strong>:
- Offline caching: now, a batch of logs will be dropped if the node fails to send them to AWS CloudWatch Logs. We will enable offline caching and try to save logs.
- Send logs to different log groups/streams: now, one node will send logs to one log stream within one log group. We will enable a node to send logs to different log groups/streams.</p>

<p><strong>Keywords</strong>: ROS Application logs, System logs, AWS CloudWatch Logs service</p>

<h3 id="license">License</h3>

<p>The source code is released under an <a href="https://aws.amazon.com/apache-2-0/">Apache 2.0</a>.</p>

<p><strong>Author</strong>: AWS RoboMaker<br>
<strong>Affiliation</strong>: <a href="https://aws.amazon.com/">Amazon Web Services (AWS)</a><br>
<strong>Maintainer</strong>: AWS RoboMaker, <a href="mailto:ros-contributions@amazon.com">ros-contributions@amazon.com</a></p>

<h3 id="supported-ros-distributions">Supported ROS Distributions</h3>

<ul>
<li>Kinetic</li>
<li>Melodic</li>
</ul>

<h3 id="build-status">Build status</h3>

<ul>
<li>Travis CI: <a href="https://travis-ci.org/aws-robotics/cloudwatchlogs-ros1"><img src="https://travis-ci.org/aws-robotics/cloudwatchlogs-ros1.svg?branch=master" alt="Build Status"></a>

<ul>
<li>ROS build farm:</li>
<li>ROS Kinetic @ u16.04 Xenial <a href="http://build.ros.org/job/Kbin_uX64__cloudwatch_logger__ubuntu_xenial_amd64__binary"><img src="http://build.ros.org/job/Kbin_uX64__cloudwatch_logger__ubuntu_xenial_amd64__binary/badge/icon" alt="Build Status"></a>
</li>
<li>ROS Melodic @ u18.04 Bionic <a href="http://build.ros.org/job/Mbin_uB64__cloudwatch_logger__ubuntu_bionic_amd64__binary"><img src="http://build.ros.org/job/Mbin_uB64__cloudwatch_logger__ubuntu_bionic_amd64__binary/badge/icon" alt="Build Status"></a>
## Installation</li>
</ul>
</li>
</ul>

<h3 id="aws-credentials">AWS Credentials</h3>

<p>You will need to create an AWS Account and configure the credentials to be able to communicate with AWS services. You may find <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-config-files.html">AWS Configuration and Credential Files</a> helpful.</p>

<p>This node will require the following AWS account IAM role permissions:
- <code>logs:PutLogEvents</code>
- <code>logs:DescribeLogStreams</code>
- <code>logs:CreateLogStream</code>
- <code>logs:CreateLogGroup</code></p>

<h3 id="binaries">Binaries</h3>

<p>On Ubuntu you can install the latest version of this package using the following command</p>
<div class="highlight"><pre><code class="language-" data-lang="">    sudo apt-get update
    sudo apt-get install -y ros-$ROS_DISTRO-cloudwatch-logger
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<p>To build from source you'll need to create a new workspace, clone and checkout the latest release branch of this repository, install all the dependencies, and compile. If you need the latest development features you can clone from the <code>master</code> branch instead of the latest release branch. While we guarantee the release branches are stable, <strong>the <code>master</code> should be considered to have an unstable build</strong> due to ongoing development. </p>

<ul>
<li>
<p>Create a ROS workspace and a source directory</p>
<div class="highlight"><pre><code class="language-" data-lang="">mkdir -p ~/ros-workspace/src
</code></pre></div>
</li>
<li>
<p>Clone the package into the source directory . </p>

<p><em>Note: Replace _</em><code>{MAJOR.VERSION}</code>__ below with the latest major version number to get the latest release branch._</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace/src
git clone https://github.com/aws-robotics/cloudwatchlogs-ros1.git -b release-v{MAJOR.VERSION}
</code></pre></div>
</li>
<li>
<p>Install dependencies</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace 
sudo apt-get update &amp;&amp; rosdep update
rosdep install --from-paths src --ignore-src -r -y
</code></pre></div>
</li>
</ul>

<p><em>Note: If building the master branch instead of a release branch you may need to also checkout and build the master branches of the packages this package depends on.</em></p>

<ul>
<li>
<p>Build the packages</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace &amp;&amp; colcon build
</code></pre></div>
</li>
<li>
<p>Configure ROS library Path</p>
<div class="highlight"><pre><code class="language-" data-lang="">source ~/ros-workspace/install/setup.bash
</code></pre></div>
</li>
<li>
<p>Build and run the unit tests</p>
<div class="highlight"><pre><code class="language-" data-lang="">colcon test --packages-select cloudwatch_logs_common &amp;&amp; colcon test-result --all
</code></pre></div>
</li>
</ul>

<h2 id="launch-files">Launch Files</h2>

<p>An example launch file called <code>sample_application.launch</code> is provided.</p>

<h2 id="usage">Usage</h2>

<h3 id="run-the-node">Run the node</h3>

<ul>
<li>
<p><strong>With</strong> launch file using parameters in .yaml format (example provided)</p>

<ul>
<li>ROS: <code>roslaunch cloudwatch_logger sample_application.launch</code>
</li>
</ul>
</li>
<li>
<p><strong>Without</strong> launch file using default values</p>

<ul>
<li>ROS: <code>rosrun cloudwatch_logger cloudwatch_logger</code>
</li>
</ul>
</li>
</ul>

<h3 id="send-a-test-log-message">Send a test log message</h3>

<ul>
<li><code>rostopic pub -1 /rosout rosgraph_msgs/Log '{header: auto, level: 2, name: test_log, msg: test_cloudwatch_logger, function: test_logs, line: 1}'</code></li>
</ul>

<h3 id="verify-that-the-test-log-message-was-successfully-sent-to-cloudwatch-logs">Verify that the test log message was successfully sent to CloudWatch Logs</h3>

<ul>
<li>Go to your AWS account</li>
<li>Find CloudWatch and click into CloudWatch</li>
<li>On the upper right corner, change region to <code>Oregon</code> if you launched the node using the launch file, or change to <code>N. Virginia</code> if you launched the node without using the launch file</li>
<li>Select <code>Logs</code> from the left-hand side menu</li>
<li>
<strong>With</strong> launch file: The name of the log group should be <code>robot_application_name</code> and the log stream should be <code>device name</code>
</li>
<li>
<strong>Without</strong> launch file: The name of the log group should be <code>ros_log_group</code> and the log stream should be <code>ros_log_stream</code>
</li>
</ul>

<h2 id="configuration-file-and-parameters">Configuration File and Parameters</h2>

<p>An example configuration file called <code>sample_configuration.yaml</code> is provided. When the parameters are absent in the ROS parameter server, default values are used, thus all parameters are optional. See table below for details.</p>

<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Description</th>
<th>Type</th>
<th>Allowed Values</th>
</tr>
</thead>
<tbody>
<tr>
<td>sub_to_rosout</td>
<td>Whether to subscribe to <em>rosout_agg</em> topic</td>
<td><em>bool</em></td>
<td>true/false</td>
</tr>
<tr>
<td>publish_frequency</td>
<td>Log publishing frequency in seconds</td>
<td><em>double</em></td>
<td>number</td>
</tr>
<tr>
<td>log_group_name</td>
<td>AWS CloudWatch log group name</td>
<td><em>std::string</em></td>
<td>'string'<br><em>note</em>: Log group names must be unique within a region foran AWS account</td>
</tr>
<tr>
<td>log_stream_name</td>
<td>AWS CloudWatch log stream name</td>
<td><em>std::string</em></td>
<td>'string'<br><em>note</em>: The : (colon) and * (asterisk) characters are not allowed</td>
</tr>
<tr>
<td>topics</td>
<td>A list of topics to get logs from (excluding <code>rosout_agg</code>)</td>
<td><em>std::vector<a href="std::string">std::string</a></em></td>
<td>['string', 'string', 'string']</td>
</tr>
<tr>
<td>min_log_verbosity</td>
<td>The minimum log severity for sending logs selectively to AWS CloudWatch Logs, log messages with a severity lower than <code>min_log_verbosity</code> will be ignored</td>
<td><em>std::string</em></td>
<td>DEBUG/INFO/WARN/ERROR/FATAL</td>
</tr>
<tr>
<td>aws_client_configuration</td>
<td>AWS region configuration</td>
<td><em>std::string</em></td>
<td>
<em>region</em>: "us-west-2"/"us-east-1"/"us-east-2"/etc.</td>
</tr>
</tbody>
</table>

<h2 id="performance-and-benchmark-results">Performance and Benchmark Results</h2>

<p>We evaluated the performance of this node by runnning the followning scenario on a Raspberry Pi 3 Model B:
- Launch a baseline graph containing the talker and listener nodes from the <a href="https://wiki.ros.org/roscpp_tutorials">roscpp_tutorials package</a>, plus two additional nodes that collect CPU and memory usage statistics. Allow the nodes to run for 60 seconds.
- Launch the Amazon CloudWatch Logs node using the launch file <code>example.launch</code> as described above. Allow the nodes to run for 180 seconds.
- Terminate the Amazon CloudWatch Logs node, and allow the remaining nodes to run for 60 seconds.</p>

<p>The following graph shows the CPU usage during that scenario. The 1 minute average CPU usage starts at 9.25% during the launch of the baseline graph, and stabilizes at 4.5%. When we launch the <code>cloudwatch_logger</code> node around second 60 the 1 minute average CPU increases up to a peak of 9.5%. After that initial peak, the CPU lowers to around 5% while the <code>cloudwatch_logger</code> node keeps sending the messages sent by the talker node to the AWS CloudWatch Logs service.</p>

<p><img src="https://raw.githubusercontent.com/aws-robotics/cloudwatchlogs-ros1/master/wiki/images/cpu.svg" alt="cpu"></p>

<p>The following graph shows the memory usage during that scenario. We start with a memory usage of 368 MB that increases to a peak of 412 MB (+11.96%) when the <code>cloudwatch_logger</code> node starts running, and stabilizes to 394 (+7%) while the node keeps running. The memory usage goes back to 368 MB after stopping the node.</p>

<p><img src="https://raw.githubusercontent.com/aws-robotics/cloudwatchlogs-ros1/master/wiki/images/memory.svg" alt="memory"></p>

<h2 id="node">Node</h2>

<h3 id="cloudwatch_logger">cloudwatch_logger</h3>

<p>Send logs in a ROS system to AWS CloudWatch Logs service.</p>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li><strong><code>/rosout_agg</code></strong></li>
</ul>

<p>By default in ROS, all logs from applications using ROS standard logging framework are sent to <em>rosout_agg</em> topic. The <em>cloudwatch_logger</em> subscribes to <em>rosout_agg</em> by default.</p>

<ul>
<li><strong><code>/other_topics</code></strong></li>
</ul>

<p>The <em>cloudwatch_logger</em> subscribes to other topics if the parameter server has the topic names in <em>cloudwatch_logger</em> namespace.</p>

<h4 id="published-topics">Published Topics</h4>

<p>None</p>

<h4 id="services">Services</h4>

<p>None</p>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please contact the team directly if you would like to request a feature.</p>

<p>Please report bugs in <a href="https://github.com/aws-robotics/cloudwatchlogs-ros1/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-lunar">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>lunar</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kinetic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aws-robotics/cloudwatchlogs-ros1.git">https://github.com/aws-robotics/cloudwatchlogs-ros1.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-05-20
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/cloudwatch_logger/github-aws-robotics-cloudwatchlogs-ros1">cloudwatch_logger</a></td>
                    <td>2.0.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="cloudwatch_logger">cloudwatch_logger</h1>

<h2 id="overview">Overview</h2>

<p>The <strong><code>cloudwatch_logger</code></strong> node enables logs generated in a ROS system to get sent to AWS CloudWatch Logs. Out of the box, this node provides the ability to subscribe to the <strong><code>/rosout_agg</code></strong>  (rosout aggregated) topic, which all logs using the ROS logging framework will be published to, and sends logs to the AWS CloudWatch Logs service. Logs can be sent to AWS CloudWatch Logs selectively based on log severity. The <strong><code>cloudwatch_logger</code></strong> node can also subscribe to other topics if logs are not sent to <strong><code>/rosout_agg</code></strong>, and it is able to unsubscribe to the rosout_agg topic for getting logs.</p>

<p>The <strong><code>cloudwatch_logger</code></strong> node wraps the <a href="https://github.com/aws/aws-sdk-cpp">aws-sdk-c++</a> in a ROS service API.</p>

<p><strong>Amazon CloudWatch Logs Summary</strong>: AWS CloudWatch Logs can monitor applications and systems using log data. You can create alarms in CloudWatch and receive notifications of particular API activity as captured by CloudTrail and use the notification to perform troubleshooting. By default, logs are kept indefinitely and never expire. You can adjust the retention policy for each log group, keeping the indefinite retention, or choosing a retention periods between 10 years and one day. AWS CloudWatch Logs stores your log data in highly durable storage.</p>

<p><strong>Features in Active Development</strong>:
- Offline caching: now, a batch of logs will be dropped if the node fails to send them to AWS CloudWatch Logs. We will enable offline caching and try to save logs.
- Send logs to different log groups/streams: now, one node will send logs to one log stream within one log group. We will enable a node to send logs to different log groups/streams.</p>

<p><strong>Keywords</strong>: ROS Application logs, System logs, AWS CloudWatch Logs service</p>

<h3 id="license">License</h3>

<p>The source code is released under an <a href="https://aws.amazon.com/apache-2-0/">Apache 2.0</a>.</p>

<p><strong>Author</strong>: AWS RoboMaker<br>
<strong>Affiliation</strong>: <a href="https://aws.amazon.com/">Amazon Web Services (AWS)</a><br>
<strong>Maintainer</strong>: AWS RoboMaker, <a href="mailto:ros-contributions@amazon.com">ros-contributions@amazon.com</a></p>

<h3 id="supported-ros-distributions">Supported ROS Distributions</h3>

<ul>
<li>Kinetic</li>
<li>Melodic</li>
</ul>

<h3 id="build-status">Build status</h3>

<ul>
<li>Travis CI: <a href="https://travis-ci.org/aws-robotics/cloudwatchlogs-ros1"><img src="https://travis-ci.org/aws-robotics/cloudwatchlogs-ros1.svg?branch=master" alt="Build Status"></a>

<ul>
<li>ROS build farm:</li>
<li>ROS Kinetic @ u16.04 Xenial <a href="http://build.ros.org/job/Kbin_uX64__cloudwatch_logger__ubuntu_xenial_amd64__binary"><img src="http://build.ros.org/job/Kbin_uX64__cloudwatch_logger__ubuntu_xenial_amd64__binary/badge/icon" alt="Build Status"></a>
</li>
<li>ROS Melodic @ u18.04 Bionic <a href="http://build.ros.org/job/Mbin_uB64__cloudwatch_logger__ubuntu_bionic_amd64__binary"><img src="http://build.ros.org/job/Mbin_uB64__cloudwatch_logger__ubuntu_bionic_amd64__binary/badge/icon" alt="Build Status"></a>
## Installation</li>
</ul>
</li>
</ul>

<h3 id="aws-credentials">AWS Credentials</h3>

<p>You will need to create an AWS Account and configure the credentials to be able to communicate with AWS services. You may find <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-config-files.html">AWS Configuration and Credential Files</a> helpful.</p>

<p>This node will require the following AWS account IAM role permissions:
- <code>logs:PutLogEvents</code>
- <code>logs:DescribeLogStreams</code>
- <code>logs:CreateLogStream</code>
- <code>logs:CreateLogGroup</code></p>

<h3 id="binaries">Binaries</h3>

<p>On Ubuntu you can install the latest version of this package using the following command</p>
<div class="highlight"><pre><code class="language-" data-lang="">    sudo apt-get update
    sudo apt-get install -y ros-$ROS_DISTRO-cloudwatch-logger
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<p>To build from source you'll need to create a new workspace, clone and checkout the latest release branch of this repository, install all the dependencies, and compile. If you need the latest development features you can clone from the <code>master</code> branch instead of the latest release branch. While we guarantee the release branches are stable, <strong>the <code>master</code> should be considered to have an unstable build</strong> due to ongoing development. </p>

<ul>
<li>
<p>Create a ROS workspace and a source directory</p>
<div class="highlight"><pre><code class="language-" data-lang="">mkdir -p ~/ros-workspace/src
</code></pre></div>
</li>
<li>
<p>Clone the package into the source directory . </p>

<p><em>Note: Replace _</em><code>{MAJOR.VERSION}</code>__ below with the latest major version number to get the latest release branch._</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace/src
git clone https://github.com/aws-robotics/cloudwatchlogs-ros1.git -b release-v{MAJOR.VERSION}
</code></pre></div>
</li>
<li>
<p>Install dependencies</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace 
sudo apt-get update &amp;&amp; rosdep update
rosdep install --from-paths src --ignore-src -r -y
</code></pre></div>
</li>
</ul>

<p><em>Note: If building the master branch instead of a release branch you may need to also checkout and build the master branches of the packages this package depends on.</em></p>

<ul>
<li>
<p>Build the packages</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd ~/ros-workspace &amp;&amp; colcon build
</code></pre></div>
</li>
<li>
<p>Configure ROS library Path</p>
<div class="highlight"><pre><code class="language-" data-lang="">source ~/ros-workspace/install/setup.bash
</code></pre></div>
</li>
<li>
<p>Build and run the unit tests</p>
<div class="highlight"><pre><code class="language-" data-lang="">colcon test --packages-select cloudwatch_logs_common &amp;&amp; colcon test-result --all
</code></pre></div>
</li>
</ul>

<h2 id="launch-files">Launch Files</h2>

<p>An example launch file called <code>sample_application.launch</code> is provided.</p>

<h2 id="usage">Usage</h2>

<h3 id="run-the-node">Run the node</h3>

<ul>
<li>
<p><strong>With</strong> launch file using parameters in .yaml format (example provided)</p>

<ul>
<li>ROS: <code>roslaunch cloudwatch_logger sample_application.launch</code>
</li>
</ul>
</li>
<li>
<p><strong>Without</strong> launch file using default values</p>

<ul>
<li>ROS: <code>rosrun cloudwatch_logger cloudwatch_logger</code>
</li>
</ul>
</li>
</ul>

<h3 id="send-a-test-log-message">Send a test log message</h3>

<ul>
<li><code>rostopic pub -1 /rosout rosgraph_msgs/Log '{header: auto, level: 2, name: test_log, msg: test_cloudwatch_logger, function: test_logs, line: 1}'</code></li>
</ul>

<h3 id="verify-that-the-test-log-message-was-successfully-sent-to-cloudwatch-logs">Verify that the test log message was successfully sent to CloudWatch Logs</h3>

<ul>
<li>Go to your AWS account</li>
<li>Find CloudWatch and click into CloudWatch</li>
<li>On the upper right corner, change region to <code>Oregon</code> if you launched the node using the launch file, or change to <code>N. Virginia</code> if you launched the node without using the launch file</li>
<li>Select <code>Logs</code> from the left-hand side menu</li>
<li>
<strong>With</strong> launch file: The name of the log group should be <code>robot_application_name</code> and the log stream should be <code>device name</code>
</li>
<li>
<strong>Without</strong> launch file: The name of the log group should be <code>ros_log_group</code> and the log stream should be <code>ros_log_stream</code>
</li>
</ul>

<h2 id="configuration-file-and-parameters">Configuration File and Parameters</h2>

<p>An example configuration file called <code>sample_configuration.yaml</code> is provided. When the parameters are absent in the ROS parameter server, default values are used, thus all parameters are optional. See table below for details.</p>

<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Description</th>
<th>Type</th>
<th>Allowed Values</th>
</tr>
</thead>
<tbody>
<tr>
<td>sub_to_rosout</td>
<td>Whether to subscribe to <em>rosout_agg</em> topic</td>
<td><em>bool</em></td>
<td>true/false</td>
</tr>
<tr>
<td>publish_frequency</td>
<td>Log publishing frequency in seconds</td>
<td><em>double</em></td>
<td>number</td>
</tr>
<tr>
<td>log_group_name</td>
<td>AWS CloudWatch log group name</td>
<td><em>std::string</em></td>
<td>'string'<br><em>note</em>: Log group names must be unique within a region foran AWS account</td>
</tr>
<tr>
<td>log_stream_name</td>
<td>AWS CloudWatch log stream name</td>
<td><em>std::string</em></td>
<td>'string'<br><em>note</em>: The : (colon) and * (asterisk) characters are not allowed</td>
</tr>
<tr>
<td>topics</td>
<td>A list of topics to get logs from (excluding <code>rosout_agg</code>)</td>
<td><em>std::vector<a href="std::string">std::string</a></em></td>
<td>['string', 'string', 'string']</td>
</tr>
<tr>
<td>min_log_verbosity</td>
<td>The minimum log severity for sending logs selectively to AWS CloudWatch Logs, log messages with a severity lower than <code>min_log_verbosity</code> will be ignored</td>
<td><em>std::string</em></td>
<td>DEBUG/INFO/WARN/ERROR/FATAL</td>
</tr>
<tr>
<td>aws_client_configuration</td>
<td>AWS region configuration</td>
<td><em>std::string</em></td>
<td>
<em>region</em>: "us-west-2"/"us-east-1"/"us-east-2"/etc.</td>
</tr>
</tbody>
</table>

<h2 id="performance-and-benchmark-results">Performance and Benchmark Results</h2>

<p>We evaluated the performance of this node by runnning the followning scenario on a Raspberry Pi 3 Model B:
- Launch a baseline graph containing the talker and listener nodes from the <a href="https://wiki.ros.org/roscpp_tutorials">roscpp_tutorials package</a>, plus two additional nodes that collect CPU and memory usage statistics. Allow the nodes to run for 60 seconds.
- Launch the Amazon CloudWatch Logs node using the launch file <code>example.launch</code> as described above. Allow the nodes to run for 180 seconds.
- Terminate the Amazon CloudWatch Logs node, and allow the remaining nodes to run for 60 seconds.</p>

<p>The following graph shows the CPU usage during that scenario. The 1 minute average CPU usage starts at 9.25% during the launch of the baseline graph, and stabilizes at 4.5%. When we launch the <code>cloudwatch_logger</code> node around second 60 the 1 minute average CPU increases up to a peak of 9.5%. After that initial peak, the CPU lowers to around 5% while the <code>cloudwatch_logger</code> node keeps sending the messages sent by the talker node to the AWS CloudWatch Logs service.</p>

<p><img src="https://raw.githubusercontent.com/aws-robotics/cloudwatchlogs-ros1/master/wiki/images/cpu.svg" alt="cpu"></p>

<p>The following graph shows the memory usage during that scenario. We start with a memory usage of 368 MB that increases to a peak of 412 MB (+11.96%) when the <code>cloudwatch_logger</code> node starts running, and stabilizes to 394 (+7%) while the node keeps running. The memory usage goes back to 368 MB after stopping the node.</p>

<p><img src="https://raw.githubusercontent.com/aws-robotics/cloudwatchlogs-ros1/master/wiki/images/memory.svg" alt="memory"></p>

<h2 id="node">Node</h2>

<h3 id="cloudwatch_logger">cloudwatch_logger</h3>

<p>Send logs in a ROS system to AWS CloudWatch Logs service.</p>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li><strong><code>/rosout_agg</code></strong></li>
</ul>

<p>By default in ROS, all logs from applications using ROS standard logging framework are sent to <em>rosout_agg</em> topic. The <em>cloudwatch_logger</em> subscribes to <em>rosout_agg</em> by default.</p>

<ul>
<li><strong><code>/other_topics</code></strong></li>
</ul>

<p>The <em>cloudwatch_logger</em> subscribes to other topics if the parameter server has the topic names in <em>cloudwatch_logger</em> namespace.</p>

<h4 id="published-topics">Published Topics</h4>

<p>None</p>

<h4 id="services">Services</h4>

<p>None</p>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please contact the team directly if you would like to request a feature.</p>

<p>Please report bugs in <a href="https://github.com/aws-robotics/cloudwatchlogs-ros1/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>indigo</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-ardent">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>ardent</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("crystal");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/ros-infrastructure" title="Find rosindex in Github">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">ros-infrastructure</span>
          </a>
          |
          <em>generated on 2019-05-24</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
