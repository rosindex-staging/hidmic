<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    <link rel="canonical" href="https://ros-infrastructure.github.io/index.ros.org//r/grid_map/github-anybotics-grid_map/">
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie-1.4.1/jquery.cookie.js type="text/javascript"></script>

    <script type="text/javascript" src=/js/ga.js async></script>
    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">

      <div align="center">
        <br>
        <table id="topnav-table">
          <tr>
            <td valign="middle">
                ROS Resources:
              <a href="http://wiki.ros.org/">Documentation</a>
              |
              <a href="http://wiki.ros.org/Support">Support</a>
              |
              <a href="http://discourse.ros.org/">Discussion Forum</a>
              |
              <a href="http://status.ros.org/">Service Status</a>
              |
              <a href="http://answers.ros.org/">Q&A answers.ros.org</a>
            </td>
          </tr>
        </table> <!-- topnav-table -->
      </div>

      <div class="row">

        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/ros-infrastructure/rosindex/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <ul class="list-inline" style="margin-bottom:0px;">
                <li><a class="btn btn-link" href="/about">About</a></li>

                <li class="dropdown">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Index <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li><a href="/packages/page/1/time/">Package List</a></li>
                    <li><a href="/repos/page/1/time/">Repository List</a></li>

                    <li class="hidden" class="divider"></li>


                    <li class="hidden"><a href="/srvs/">Nodes</a></li>
                    <li class="hidden"><a href="/msgs/">Messages</a></li>
                    <li class="hidden"><a href="/srvs/">Services</a></li>
                    <li class="hidden"><a href="/srvs/">Plugins</a></li>

                    <li class="divider"></li>

                    <li><a href="/deps/">System Dependencies</a></li>
                  </ul>
                </li>

                <li class="dropdown disabled">
                  <button id="dLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Doc <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    
                    <li>
                      <a href="/doc/ros2">
                        ROS2 Overview
                      </a>
                    </li>
                    
                    <li class="hidden" class="divider"></li>

                    <li class="hidden"><a href="/doc/tutorials">Tutorials</a></li>
                    <li class="hidden"><a href="/doc/readmes">Readmes</a></li>
                    <li class="hidden"><a href="/doc/apis">APIs</a></li>
                  </ul>
                </li>

                <li><a class="btn btn-link" href="/contribute">Contribute</a></li>
                <li><a class="btn btn-link" href="/stats">Stats</a></li>
              </ul>

            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form id="top-searchbox" action="/search/" role="form" method="get">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="term" placeholder="Search ROS">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" title="Search ROS" type="submit">
                  <span class="glyphicon glyphicon-search"></span>
                </button>
                <a href="https://lunrjs.com/guides/searching.html"
                   title="Help to Search" class="btn btn-default btn-sm">
                  <span class="glyphicon glyphicon-question-sign"></span>
                </a>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>
  <script type="text/javascript">
    $('#top-searchbox').submit(function() {
        return $('#top-searchbox input:text').filter(function() {
          return $(this).val() == "";
        }).length == 0;
    });
  </script>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">grid_map</li>
        <!--<li class="active">grid_map</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="crystal-option" class="distro-button btn btn-xs btn-default" href="#crystal" data="crystal">
      <input type="radio" name="options" id="crystal-radio" autocomplete="off"> crystal
    </label>
  
    <label id="bouncy-option" class="distro-button btn btn-xs btn-default" href="#bouncy" data="bouncy">
      <input type="radio" name="options" id="bouncy-radio" autocomplete="off"> bouncy
    </label>
  
    <label id="melodic-option" class="distro-button btn btn-xs btn-primary" href="#melodic" data="melodic">
      <input type="radio" name="options" id="melodic-radio" autocomplete="off"> melodic
    </label>
  
    <label id="lunar-option" class="distro-button btn btn-xs btn-primary" href="#lunar" data="lunar">
      <input type="radio" name="options" id="lunar-radio" autocomplete="off"> lunar
    </label>
  
    <label id="kinetic-option" class="distro-button btn btn-xs btn-primary" href="#kinetic" data="kinetic">
      <input type="radio" name="options" id="kinetic-radio" autocomplete="off"> kinetic
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-primary" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="ardent" id="ardent-option" class="disabled older-distro-option"  href="#ardent">
          <a href="#ardent" data="ardent" id="ardent-button">ardent</a>
        </li>
      
        <li data="jade" id="jade-option" class="disabled older-distro-option"  href="#jade">
          <a href="#jade" data="jade" id="jade-button">jade</a>
        </li>
      
        <li data="hydro" id="hydro-option" class="disabled older-distro-option"  href="#hydro">
          <a href="#hydro" data="hydro" id="hydro-button">hydro</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/grid_map">grid_map</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/grid_map"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-anybotics-grid_map
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ethz-asl-grid_map" role="menuitem" tabindex="-1" href="/r/grid_map/github-ethz-asl-grid_map" data="github-ethz-asl-grid_map">
                    <span class="glyphicon glyphicon-none"></span>
                    github-ethz-asl-grid_map
                  </a>
                </li>
              
                <li role="presentation">
                  <a id="github-anybotics-grid_map" role="menuitem" tabindex="-1" href="/r/grid_map/github-anybotics-grid_map" data="github-anybotics-grid_map">
                    <span class="glyphicon glyphicon-star"></span>
                    github-anybotics-grid_map
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-crystal">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>crystal</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-bouncy">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>bouncy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/anybotics/grid_map.git">https://github.com/anybotics/grid_map.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">melodic</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2019-01-23
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/grid_map/github-anybotics-grid_map">grid_map</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_core/github-anybotics-grid_map">grid_map_core</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_costmap_2d/github-anybotics-grid_map">grid_map_costmap_2d</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_cv/github-anybotics-grid_map">grid_map_cv</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_demos/github-anybotics-grid_map">grid_map_demos</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_filters/github-anybotics-grid_map">grid_map_filters</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_loader/github-anybotics-grid_map">grid_map_loader</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_msgs/github-anybotics-grid_map">grid_map_msgs</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_octomap/github-anybotics-grid_map">grid_map_octomap</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_pcl/github-anybotics-grid_map">grid_map_pcl</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_ros/github-anybotics-grid_map">grid_map_ros</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_rviz_plugin/github-anybotics-grid_map">grid_map_rviz_plugin</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_sdf/github-anybotics-grid_map">grid_map_sdf</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_visualization/github-anybotics-grid_map">grid_map_visualization</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="grid-map">Grid Map</h1>

<h2 id="overview">Overview</h2>

<p>This is a C++ library with <a href="http://www.ros.org">ROS</a> interface to manage two-dimensional grid maps with multiple data layers. It is designed for mobile robotic mapping to store data such as elevation, variance, color, friction coefficient, foothold quality, surface normal, traversability etc. It is used in the <a href="https://github.com/anybotics/elevation_mapping">Robot-Centric Elevation Mapping</a> package designed for rough terrain navigation.</p>

<p>Features:</p>

<ul>
<li>
<strong>Multi-layered:</strong> Developed for universal 2.5-dimensional grid mapping with support for any number of layers.</li>
<li>
<strong>Efficient map re-positioning:</strong> Data storage is implemented as two-dimensional circular buffer. This allows for non-destructive shifting of the map's position (e.g. to follow the robot) without copying data in memory.</li>
<li>
<strong>Based on Eigen:</strong> Grid map data is stored as <a href="http://eigen.tuxfamily.org">Eigen</a> data types. Users can apply available Eigen algorithms directly to the map data for versatile and efficient data manipulation.</li>
<li>
<strong>Convenience functions:</strong> Several helper methods allow for convenient and memory safe cell data access. For example, iterator functions for rectangular, circular, polygonal regions and lines are implemented.</li>
<li>
<strong>ROS interface:</strong> Grid maps can be directly converted to and from ROS message types such as PointCloud2, OccupancyGrid, GridCells, and our custom GridMap message. Conversion packages provide compatibility with <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a>, <a href="http://pointclouds.org/">PCL</a>, and <a href="https://octomap.github.io/">OctoMap</a> data types.</li>
<li>
<strong>OpenCV interface:</strong> Grid maps can be seamlessly converted from and to <a href="http://opencv.org/">OpenCV</a> image types to make use of the tools provided by <a href="http://opencv.org/">OpenCV</a>.</li>
<li>
<strong>Visualizations:</strong> The <em>grid_map_rviz_plugin</em> renders grid maps as 3d surface plots (height maps) in <a href="http://wiki.ros.org/rviz">RViz</a>. Additionally, the <em>grid_map_visualization</em> package helps to visualize grid maps as point clouds, occupancy grids, grid cells etc.</li>
<li>
<strong>Filters:</strong> The <em>grid_map_filters</em> provides are range of filters to process grid maps as a sequence of filters. Parsing of mathematical expressions allows to flexibly setup powerful computations such as thresholding, normal vectors, smoothening, variance, inpainting, and matrix kernel convolutions.</li>
</ul>

<p>The grid map package has been tested with <a href="http://www.ros.org">ROS</a> Indigo, Jade (under Ubuntu 14.04) and Kinetic (under Ubuntu 16.04). This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed.</p>

<p>The source code is released under a <a href="https://github.com/anybotics/grid_map/tree/melodic/LICENSE">BSD 3-Clause license</a>.</p>

<p><strong>Author: Péter Fankhauser<br>
Affiliation: <a href="https://www.anybotics.com/">ANYbotics</a><br>
Maintainer: Péter Fankhauser, <a href="mailto:pfankhauser@anybotics.com">pfankhauser@anybotics.com</a><br></strong>
With contributions by: Tanja Baumann, Jeff Delmerico, Remo Diethelm, Perry Franklin, Dominic Jud, Ralph Kaestner, Philipp Krüsi, Alex Millane, Daniel Stonier, Elena Stumm, Martin Wermelinger, Christos Zalidis</p>

<p>This projected was initially developed at ETH Zurich (Autonomous Systems Lab &amp; Robotic Systems Lab).</p>

<p><a href="https://www.anymal-research.org/">This work is conducted as part of ANYmal Research, a community to advance legged robotics.</a></p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_rviz_plugin/doc/grid_map_rviz_plugin_example.png" alt="Grid map example in RViz"></p>

<h2 id="publications">Publications</h2>

<p>If you use this work in an academic context, please cite the following publication:</p>

<blockquote>
<p>P. Fankhauser and M. Hutter,
<strong>"A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation"</strong>,
in Robot Operating System (ROS) – The Complete Reference (Volume 1), A. Koubaa (Ed.), Springer, 2016. (<a href="http://www.researchgate.net/publication/284415855">PDF</a>)</p>
</blockquote>
<div class="highlight"><pre><code class="language-" data-lang="">@incollection{Fankhauser2016GridMapLibrary,
  author = {Fankhauser, P{\'{e}}ter and Hutter, Marco},
  booktitle = {Robot Operating System (ROS) – The Complete Reference (Volume 1)},
  title = {{A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation}},
  chapter = {5},
  editor = {Koubaa, Anis},
  publisher = {Springer},
  year = {2016},
  isbn = {978-3-319-26052-5},
  doi = {10.1007/978-3-319-26054-9{\_}5},
  url = {http://www.springer.com/de/book/9783319260525}
}
</code></pre></div>
<h2 id="documentation">Documentation</h2>

<p>An introduction to the grid map library including a tutorial is given in <a href="http://www.researchgate.net/publication/284415855">this book chapter</a>.</p>

<p>The C++ API is documented here:
* <a href="http://docs.ros.org/kinetic/api/grid_map_core/html/index.html">grid_map_core</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_ros/html/index.html">grid_map_ros</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_costmap_2d/html/index.html">grid_map_costmap_2d</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_cv/html/index.html">grid_map_cv</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_filters/html/index.html">grid_map_filters</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_octomap/html/index.html">grid_map_octomap</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_pcl/html/index.html">grid_map_pcl</a></p>

<h2 id="installation">Installation</h2>

<h3 id="installation-from-packages">Installation from Packages</h3>

<p>To install all packages from the grid map library as Debian packages use</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install ros-kinetic-grid-map
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<h4 id="dependencies">Dependencies</h4>

<p>The <em>grid_map_core</em> package depends only on the linear algebra library <a href="http://eigen.tuxfamily.org">Eigen</a>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install libeigen3-dev
</code></pre></div>
<p>The other packages depend additionally on the <a href="http://www.ros.org">ROS</a> standard installation (<em>roscpp</em>, <em>tf</em>, <em>filters</em>, <em>sensor_msgs</em>, <em>nav_msgs</em>, and <em>cv_bridge</em>). Other format specific conversion packages (e.g. <em>grid_map_cv</em>, <em>grid_map_pcl</em> etc.) depend on packages described below in <em>Packages Overview</em>.</p>

<h4 id="building">Building</h4>

<p>To build from source, clone the latest version from this repository into your catkin workspace and compile the package using</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd catkin_ws/src
git clone https://github.com/anybotics/grid_map.git
cd ../
catkin_make
</code></pre></div>
<p>To maximize performance, make sure to build in <em>Release</em> mode. You can specify the build type by setting</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make -DCMAKE_BUILD_TYPE=Release
</code></pre></div>
<h3 id="packages-overview">Packages Overview</h3>

<p>This repository consists of following packages:</p>

<ul>
<li>
<strong><em>grid_map</em></strong> is the meta-package for the grid map library.</li>
<li>
<strong><em>grid_map_core</em></strong> implements the algorithms of the grid map library. It provides the <code>GridMap</code> class and several helper classes such as the iterators. This package is implemented without <a href="http://www.ros.org">ROS</a> dependencies.</li>
<li>
<strong><em>grid_map_ros</em></strong> is the main package for <a href="http://www.ros.org">ROS</a> dependent projects using the grid map library. It provides the interfaces to convert grid maps from and to several <a href="http://www.ros.org">ROS</a> message types.</li>
<li>
<strong><em>grid_map_demos</em></strong> contains several nodes for demonstration purposes.</li>
<li>
<strong><em>grid_map_filters</em></strong> builds on the <a href="http://wiki.ros.org/filters">ROS Filters</a> package to process grid maps as a sequence of filters.</li>
<li>
<strong><em>grid_map_msgs</em></strong> holds the <a href="http://www.ros.org">ROS</a> message and service definitions around the [grid_map_msg/GridMap] message type.</li>
<li>
<strong><em>grid_map_rviz_plugin</em></strong> is an <a href="http://wiki.ros.org/rviz">RViz</a> plugin to visualize grid maps as 3d surface plots (height maps).</li>
<li>
<strong><em>grid_map_visualization</em></strong> contains a node written to convert GridMap messages to other <a href="http://www.ros.org">ROS</a> message types for example for  visualization in <a href="http://wiki.ros.org/rviz">RViz</a>.</li>
</ul>

<p>Additional conversion packages:</p>

<ul>
<li>
<strong><em>grid_map_costmap_2d</em></strong> provides conversions of grid maps from <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a> map types.</li>
<li>
<strong><em>grid_map_cv</em></strong> provides conversions of grid maps from and to <a href="http://opencv.org/">OpenCV</a> image types.</li>
<li>
<strong><em>grid_map_octomap</em></strong> provides conversions of grid maps from OctoMap (<a href="https://octomap.github.io/">OctoMap</a>) maps.</li>
<li>
<strong><em>grid_map_pcl</em></strong> provides conversions of grid maps from Point Cloud Library (<a href="http://pointclouds.org/">PCL</a>) polygon meshes.</li>
</ul>

<h3 id="unit-tests">Unit Tests</h3>

<p>Run the unit tests with</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make run_tests_grid_map_core run_tests_grid_map_ros
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin build grid_map --no-deps --verbose --catkin-make-args run_tests
</code></pre></div>
<p>if you are using <a href="http://catkin-tools.readthedocs.org/">catkin tools</a>.</p>

<h2 id="usage">Usage</h2>

<h3 id="demonstrations">Demonstrations</h3>

<p>The <em>grid_map_demos</em> package contains several demonstration nodes. Use this code to verify your installation of the grid map packages and to get you started with your own usage of the library.</p>

<ul>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/simple_demo_node.cpp">simple_demo</a></em> demonstrates a simple example for using the grid map library. This ROS node creates a grid map, adds data to it, and publishes it. To see the result in RViz, execute the command</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos simple_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/tutorial_demo_node.cpp">tutorial_demo</a></em> is an extended demonstration of the library's functionalities. Launch the <em>tutorial_demo</em> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos tutorial_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> showcases the usage of the grid map iterators. Launch it with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos iterators_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/ImageToGridmapDemo.cpp">image_to_gridmap_demo</a></em> demonstrates how to convert data from an <a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/data/eth_logo.png">image</a> to a grid map. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos image_to_gridmap_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_demos/doc/image_to_grid_map_demo_result.png" alt="Image to grid map demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/opencv_demo_node.cpp">opencv_demo</a></em> demonstrates map manipulations with help of <a href="http://opencv.org/">OpenCV</a> functions. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos opencv_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_demos/doc/opencv_demo_result.gif" alt="OpenCV demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/resolution_change_demo_node.cpp">resolution_change_demo</a></em> shows how the resolution of a grid map can be changed with help of the <a href="http://opencv.org/">OpenCV</a> image scaling methods. The see the results, use</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos resolution_change_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/FiltersDemo.cpp">filters_demo</a></em> uses a chain of <a href="http://wiki.ros.org/filters">ROS Filters</a> to process a grid map. Starting from the elevation of a terrain map, the demo uses several filters to show how to compute surface normals, use inpainting to fill holes, smoothen/blur the map, and use math expressions to detect edges, compute roughness and traversability. The filter chain setup is configured in the <a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/config/filters_demo_filter_chain.yaml"><code>filters_demo_filter_chain.yaml</code></a> file. Launch the demo with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos filters_demo.launch
</code></pre></div>
<p><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/doc/filters_demo.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_demos/doc/filters_demo_preview.gif" alt="Filters demo results"></a></p>
</li>
</ul>

<p>For more information about grid map filters, see <a href="https://github.com/anybotics/grid_map/tree/melodic/#grid_map_filters">grid_map_filters</a>.</p>

<h3 id="conventions-definitions">Conventions &amp; Definitions</h3>

<p><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/grid_map_layers.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/grid_map_layers.png" alt="Grid map layers"></a></p>

<p><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/grid_map_conventions.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/grid_map_conventions.png" alt="Grid map conventions"></a></p>

<h3 id="iterators">Iterators</h3>

<p>The grid map library contains various iterators for convenience.</p>

<table>
<thead>
<tr>
<th style="text-align: center">Grid map</th>
<th style="text-align: center">Submap</th>
<th style="text-align: center">Circle</th>
<th style="text-align: center">Line</th>
<th style="text-align: center">Polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/grid_map_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/grid_map_iterator_preview.gif" alt="Grid map iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/submap_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/submap_iterator_preview.gif" alt="Submap iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/circle_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/circle_iterator_preview.gif" alt="Circle iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/line_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/line_iterator_preview.gif" alt="Line iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/polygon_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/polygon_iterator_preview.gif" alt="Polygon iterator"></a></td>
</tr>
<tr>
<td style="text-align: center"><strong>Ellipse</strong></td>
<td style="text-align: center"><strong>Spiral</strong></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/ellipse_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/ellipse_iterator_preview.gif" alt="Ellipse iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_core/doc/iterators/spiral_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/iterators/spiral_iterator_preview.gif" alt="Spiral iterator"></a></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<p>Using the iterator in a <code>for</code> loop is common. For example, iterate over the entire grid map with the <code>GridMapIterator</code> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">for (grid_map::GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    cout &lt;&lt; "The value at index " &lt;&lt; (*iterator).transpose() &lt;&lt; " is " &lt;&lt; map.at("layer", *iterator) &lt;&lt; endl;
}
</code></pre></div>
<p>The other grid map iterators follow the same form. You can find more examples on how to use the different iterators in the <em><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> node.</p>

<p>Note: For maximum efficiency when using iterators, it is recommended to locally store direct access to the data layers of the grid map with <code>grid_map::Matrix&amp; data = map["layer"]</code> outside the <code>for</code> loop:</p>
<div class="highlight"><pre><code class="language-" data-lang="">grid_map::Matrix&amp; data = map["layer"];
for (GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    const Index index(*iterator);
    cout &lt;&lt; "The value at index " &lt;&lt; index.transpose() &lt;&lt; " is " &lt;&lt; data(index(0), index(1)) &lt;&lt; endl;
}
</code></pre></div>
<p>You can find a benchmarking of the performance of the iterators in the <code>iterator_benchmark</code> node of the <code>grid_map_demos</code> package which can be run with</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun grid_map_demos iterator_benchmark
</code></pre></div>
<p>Beware that while iterators are convenient, it is often the cleanest and most efficient to make use of the built-in <a href="http://eigen.tuxfamily.org">Eigen</a> methods. Here are some examples:</p>

<ul>
<li>
<p>Setting a constant value to all cells of a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"].setConstant(3.0);
</code></pre></div>
</li>
<li>
<p>Adding two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["sum"] = map["layer_1"] + map["layer_2"];
</code></pre></div>
</li>
<li>
<p>Scaling a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"] = 2.0 * map["layer"];
</code></pre></div>
</li>
<li>
<p>Max. values between two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["max"] = map["layer_1"].cwiseMax(map["layer_2"]);
</code></pre></div>
</li>
<li>
<p>Compute the root mean squared error:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map.add("error", (map.get("layer_1") - map.get("layer_2")).cwiseAbs());
unsigned int nCells = map.getSize().prod();
double rootMeanSquaredError = sqrt((map["error"].array().pow(2).sum()) / nCells);
</code></pre></div>
</li>
</ul>

<h3 id="changing-the-position-of-the-map">Changing the Position of the Map</h3>

<p>There are two different methods to change the position of the map:
* <code>setPosition(...)</code>: Changes the position of the map without changing data stored in the map. This changes the corresponce between the data and the map frame.
* <code>move(...)</code>: Relocates the grid map such that the corresponce between data and the map frame does not change. Data in the overlapping region before and after the position change remains stored. Data that falls outside of the map at its new position is discarded. Cells that cover previously unknown regions are emptied (set to nan). The data storage is implemented as two-dimensional circular buffer to minimize computational effort.</p>

<table>
<thead>
<tr>
<th style="text-align: center"><code>setPosition(...)</code></th>
<th style="text-align: center"><code>move(...)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/setposition_method.gif" alt="Grid map iterator"></td>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_core/doc/move_method.gif" alt="Submap iterator"></td>
</tr>
</tbody>
</table>

<h2 id="packages">Packages</h2>

<h3 id="grid_map_rviz_plugin">grid_map_rviz_plugin</h3>

<p>This <a href="http://wiki.ros.org/rviz">RViz</a> plugin visualizes a grid map layer as 3d surface plot (height map). A separate layer can be chosen as layer for the color information.</p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_rviz_plugin/doc/grid_map_rviz_plugin.png" alt="Grid map visualization in RViz"></p>

<h3 id="grid_map_visualization">grid_map_visualization</h3>

<p>This node subscribes to a topic of type <a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a> and publishes messages that can be visualized in <a href="http://wiki.ros.org/rviz">RViz</a>. The published topics of the visualizer can be fully configure with a YAML parameter file. Any number of visualizations with different parameters can be added. An example is <a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/config/tutorial_demo.yaml">here</a> for the configuration file of the <em>tutorial_demo</em>.</p>

<table>
<thead>
<tr>
<th>Point cloud</th>
<th>Vectors</th>
<th>Occupancy grid</th>
<th>Grid cells</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_visualization/doc/point_cloud.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_visualization/doc/point_cloud_preview.jpg" alt="Point cloud"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_visualization/doc/vectors.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_visualization/doc/vectors_preview.jpg" alt="Vectors"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_visualization/doc/occupancy_grid.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_visualization/doc/occupancy_grid_preview.jpg" alt="Occupancy grid"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_visualization/doc/grid_cells.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/melodic/grid_map_visualization/doc/grid_cells_preview.jpg" alt="Grid cells"></a></td>
</tr>
</tbody>
</table>

<h4 id="parameters">Parameters</h4>

<ul>
<li>
<p><strong><code>grid_map_topic</code></strong> (string, default: "/grid_map")</p>

<p>The name of the grid map topic to be visualized. See below for the description of the visualizers.</p>
</li>
</ul>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li>
<p><strong><code>/grid_map</code></strong> (<a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a>)</p>

<p>The grid map to visualize.</p>
</li>
</ul>

<h4 id="published-topics">Published Topics</h4>

<p>The published topics are configured with the <a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_demos/config/tutorial_demo.yaml">YAML parameter file</a>. Possible topics are:</p>

<ul>
<li>
<p><strong><code>point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a point cloud. Select which layer to transform as points with the <code>layer</code> parameter.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation
type: point_cloud
params:
 layer: elevation
 flat: false # optional
</code></pre></div>
</li>
<li>
<p><strong><code>flat_point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a "flat" point cloud, i.e. with all points at the same height <em>z</em>. This is convenient to visualize 2d maps or images (or even video streams) in <a href="http://wiki.ros.org/rviz">RViz</a> with help of its <code>Color Transformer</code>. The parameter <code>height</code> determines the desired <em>z</em>-position of the flat point cloud.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: flat_grid
type: flat_point_cloud
params:
 height: 0.0
</code></pre></div>
<p>Note: In order to omit points in the flat point cloud from empty/invalid cells, specify the layers which should be checked for validity with <code>setBasicLayers(...)</code>.</p>
</li>
<li>
<p><strong><code>vectors</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Visualizes vector data of the grid map as visual markers. Specify the layers which hold the <em>x</em>-, <em>y</em>-, and <em>z</em>-components of the vectors with the <code>layer_prefix</code> parameter. The parameter <code>position_layer</code> defines the layer to be used as start point of the vectors.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: vectors
params:
 layer_prefix: normal_
 position_layer: elevation
 scale: 0.06
 line_width: 0.005
 color: 15600153 # red
</code></pre></div>
</li>
<li>
<p><strong><code>occupancy_grid</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/OccupancyGrid.html">nav_msgs/OccupancyGrid</a>)</p>

<p>Visualizes a layer of the grid map as occupancy grid. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bound with <code>data_min</code> and <code>data_max</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: traversability_grid
type: occupancy_grid
params:
 layer: traversability
 data_min: -0.15
 data_max: 0.15
</code></pre></div>
</li>
<li>
<p><strong><code>grid_cells</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/GridCells.html">nav_msgs/GridCells</a>)</p>

<p>Visualizes a layer of the grid map as grid cells. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bounds with <code>lower_threshold</code> and <code>upper_threshold</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation_cells
type: grid_cells
params:
 layer: elevation
 lower_threshold: -0.08 # optional, default: -inf
 upper_threshold: 0.08 # optional, default: inf
</code></pre></div>
</li>
<li>
<p><strong><code>region</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Shows the boundary of the grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: map_region
type: map_region
params:
 color: 3289650
 line_width: 0.003
</code></pre></div>
</li>
</ul>

<p><em>Note: Color values are in RGB form as concatenated integers (for each channel value 0-255). The values can be generated like <a href="http://www.wolframalpha.com/input/?i=BitOr%5BBitShiftLeft%5Br%2C16%5D%2C+BitShiftLeft%5Bg%2C8%5D%2C+b%5D+where+%7Br%3D0%2C+g%3D255%2C+b%3D0%7D">this</a> as an example for the color green (red: 0, green: 255, blue: 0).</em></p>

<h3 id="grid_map_filters">grid_map_filters</h3>

<p>The <em>grid_map_filters</em> package containts several filters which can be applied a grid map to perform computations on the data in the layers. The grid map filters are based on <a href="http://wiki.ros.org/filters">ROS Filters</a>, which means that a chain of filters can be configured as a YAML file. Furthermore, additional filters can be written and made available through the ROS plugin mechanism, such as the <a href="https://github.com/anybotics/grid_map/tree/melodic/grid_map_cv/include/grid_map_cv/InpaintFilter.hpp"><code>InpaintFilter</code></a> from the <code>grid_map_cv</code> package.</p>

<p>Several basic filters are provided in the <em>grid_map_filters</em> package:</p>

<ul>
<li>
<p><strong><code>gridMapFilters/ThresholdFilter</code></strong></p>

<p>Set values below/above a threshold to a specified value.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: lower_threshold
type: gridMapFilters/ThresholdFilter
params:
  layer: layer_name
  lower_threshold: 0.0 # alternative: upper_threshold
  set_to: 0.0 # # Other uses: .nan, .inf
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MeanInRadiusFilter</code></strong></p>

<p>Compute for each cell of a layer the mean value inside a radius.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: mean_in_radius
type: gridMapFilters/MeanInRadiusFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.06 # in m.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalVectorsFilter</code></strong></p>

<p>Compute the normal vectors of a layer in a map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalVectorsFilter
params:
  input_layer: input
  output_layers_prefix: normal_vectors_
  radius: 0.05
  normal_vector_positive_axis: z
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalColorMapFilter</code></strong></p>

<p>Compute a new color layer based on normal vectors layers.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalColorMapFilter
params:
  input_layers_prefix: normal_vectors_
  output_layer: normal_color
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression with layers of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/MathExpressionFilter
params:
  output_layer: output
  expression: acos(normal_vectors_z) # Slope.
  # expression: abs(elevation - elevation_smooth) # Surface roughness.
  # expression: 0.5 * (1.0 - (slope / 0.6)) + 0.5 * (1.0 - (roughness / 0.1)) # Weighted and normalized sum.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/SlidingWindowMathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression within a sliding window on a layer of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/SlidingWindowMathExpressionFilter
params:
  input_layer: input
  output_layer: output
  expression: meanOfFinites(input) # Box blur
  # expression: sqrt(sumOfFinites(square(input - meanOfFinites(input))) ./ numberOfFinites(input)) # Standard deviation
  # expression: 'sumOfFinites([0,-1,0;-1,5,-1;0,-1,0].*elevation_inpainted)' # Sharpen with kernel matrix
  compute_empty_cells: true
  edge_handling: crop # options: inside, crop, empty, mean
  window_size: 5 # in number of cells (optional, default: 3), make sure to make this compatible with the kernel matrix
  # window_length: 0.05 # instead of window_size, in m
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DuplicationFilter</code></strong></p>

<p>Duplicate a layer of a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: duplicate
type: gridMapFilters/DuplicationFilter
params:
  input_layer: input
  output_layer: output
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DeletionFilter</code></strong></p>

<p>Delete layers from a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: delete
type: gridMapFilters/DeletionFilter
params:
  layers: [color, score] # List of layers.
</code></pre></div>
</li>
</ul>

<p>Additionally, the <em>grid_map_cv</em> package provides the following filters:</p>

<ul>
<li>
<p><strong><code>gridMapCv/InpaintFilter</code></strong></p>

<p>Use OpenCV to inpaint/fill holes in a layer.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: inpaint
type: gridMapCv/InpaintFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.05 # in m
</code></pre></div>
</li>
</ul>

<h2 id="build-status">Build Status</h2>

<h3 id="devel-job-status">Devel Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Idev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdev__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdev__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
<tr>
<td>doc</td>
<td><a href="http://build.ros.org/job/Idoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdoc__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdoc__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h3 id="release-job-status">Release Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_core</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_ros</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_msgs</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_rviz_plugin</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_visualization</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_filters</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_loader</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_demos</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please report bugs and request features using the <a href="https://github.com/anybotics/grid_map/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-lunar">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/anybotics/grid_map.git">https://github.com/anybotics/grid_map.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-07
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/grid_map/github-anybotics-grid_map">grid_map</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_core/github-anybotics-grid_map">grid_map_core</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_costmap_2d/github-anybotics-grid_map">grid_map_costmap_2d</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_cv/github-anybotics-grid_map">grid_map_cv</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_demos/github-anybotics-grid_map">grid_map_demos</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_filters/github-anybotics-grid_map">grid_map_filters</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_loader/github-anybotics-grid_map">grid_map_loader</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_msgs/github-anybotics-grid_map">grid_map_msgs</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_octomap/github-anybotics-grid_map">grid_map_octomap</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_pcl/github-anybotics-grid_map">grid_map_pcl</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_ros/github-anybotics-grid_map">grid_map_ros</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_rviz_plugin/github-anybotics-grid_map">grid_map_rviz_plugin</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_sdf/github-anybotics-grid_map">grid_map_sdf</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_visualization/github-anybotics-grid_map">grid_map_visualization</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="grid-map">Grid Map</h1>

<h2 id="overview">Overview</h2>

<p>This is a C++ library with <a href="http://www.ros.org">ROS</a> interface to manage two-dimensional grid maps with multiple data layers. It is designed for mobile robotic mapping to store data such as elevation, variance, color, friction coefficient, foothold quality, surface normal, traversability etc. It is used in the <a href="https://github.com/anybotics/elevation_mapping">Robot-Centric Elevation Mapping</a> package designed for rough terrain navigation.</p>

<p>Features:</p>

<ul>
<li>
<strong>Multi-layered:</strong> Developed for universal 2.5-dimensional grid mapping with support for any number of layers.</li>
<li>
<strong>Efficient map re-positioning:</strong> Data storage is implemented as two-dimensional circular buffer. This allows for non-destructive shifting of the map's position (e.g. to follow the robot) without copying data in memory.</li>
<li>
<strong>Based on Eigen:</strong> Grid map data is stored as <a href="http://eigen.tuxfamily.org">Eigen</a> data types. Users can apply available Eigen algorithms directly to the map data for versatile and efficient data manipulation.</li>
<li>
<strong>Convenience functions:</strong> Several helper methods allow for convenient and memory safe cell data access. For example, iterator functions for rectangular, circular, polygonal regions and lines are implemented.</li>
<li>
<strong>ROS interface:</strong> Grid maps can be directly converted to and from ROS message types such as PointCloud2, OccupancyGrid, GridCells, and our custom GridMap message. Conversion packages provide compatibility with <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a>, <a href="http://pointclouds.org/">PCL</a>, and <a href="https://octomap.github.io/">OctoMap</a> data types.</li>
<li>
<strong>OpenCV interface:</strong> Grid maps can be seamlessly converted from and to <a href="http://opencv.org/">OpenCV</a> image types to make use of the tools provided by <a href="http://opencv.org/">OpenCV</a>.</li>
<li>
<strong>Visualizations:</strong> The <em>grid_map_rviz_plugin</em> renders grid maps as 3d surface plots (height maps) in <a href="http://wiki.ros.org/rviz">RViz</a>. Additionally, the <em>grid_map_visualization</em> package helps to visualize grid maps as point clouds, occupancy grids, grid cells etc.</li>
<li>
<strong>Filters:</strong> The <em>grid_map_filters</em> provides are range of filters to process grid maps as a sequence of filters. Parsing of mathematical expressions allows to flexibly setup powerful computations such as thresholding, normal vectors, smoothening, variance, inpainting, and matrix kernel convolutions.</li>
</ul>

<p>The grid map package has been tested with <a href="http://www.ros.org">ROS</a> Indigo, Jade (under Ubuntu 14.04) and Kinetic (under Ubuntu 16.04). This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed.</p>

<p>The source code is released under a <a href="https://github.com/anybotics/grid_map/tree/master/LICENSE">BSD 3-Clause license</a>.</p>

<p><strong>Author: Péter Fankhauser<br>
Affiliation: <a href="https://www.anybotics.com/">ANYbotics</a><br>
Maintainer: Péter Fankhauser, <a href="mailto:pfankhauser@anybotics.com">pfankhauser@anybotics.com</a><br></strong>
With contributions by: Tanja Baumann, Jeff Delmerico, Remo Diethelm, Perry Franklin, Dominic Jud, Ralph Kaestner, Philipp Krüsi, Alex Millane, Daniel Stonier, Elena Stumm, Martin Wermelinger, Christos Zalidis</p>

<p>This projected was initially developed at ETH Zurich (Autonomous Systems Lab &amp; Robotic Systems Lab).</p>

<p><a href="https://www.anymal-research.org/">This work is conducted as part of ANYmal Research, a community to advance legged robotics.</a></p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin_example.png" alt="Grid map example in RViz"></p>

<h2 id="publications">Publications</h2>

<p>If you use this work in an academic context, please cite the following publication:</p>

<blockquote>
<p>P. Fankhauser and M. Hutter,
<strong>"A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation"</strong>,
in Robot Operating System (ROS) – The Complete Reference (Volume 1), A. Koubaa (Ed.), Springer, 2016. (<a href="http://www.researchgate.net/publication/284415855">PDF</a>)</p>
</blockquote>
<div class="highlight"><pre><code class="language-" data-lang="">@incollection{Fankhauser2016GridMapLibrary,
  author = {Fankhauser, P{\'{e}}ter and Hutter, Marco},
  booktitle = {Robot Operating System (ROS) – The Complete Reference (Volume 1)},
  title = {{A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation}},
  chapter = {5},
  editor = {Koubaa, Anis},
  publisher = {Springer},
  year = {2016},
  isbn = {978-3-319-26052-5},
  doi = {10.1007/978-3-319-26054-9{\_}5},
  url = {http://www.springer.com/de/book/9783319260525}
}
</code></pre></div>
<h2 id="documentation">Documentation</h2>

<p>An introduction to the grid map library including a tutorial is given in <a href="http://www.researchgate.net/publication/284415855">this book chapter</a>.</p>

<p>The C++ API is documented here:
* <a href="http://docs.ros.org/kinetic/api/grid_map_core/html/index.html">grid_map_core</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_ros/html/index.html">grid_map_ros</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_costmap_2d/html/index.html">grid_map_costmap_2d</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_cv/html/index.html">grid_map_cv</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_filters/html/index.html">grid_map_filters</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_octomap/html/index.html">grid_map_octomap</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_pcl/html/index.html">grid_map_pcl</a></p>

<h2 id="installation">Installation</h2>

<h3 id="installation-from-packages">Installation from Packages</h3>

<p>To install all packages from the grid map library as Debian packages use</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install ros-kinetic-grid-map
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<h4 id="dependencies">Dependencies</h4>

<p>The <em>grid_map_core</em> package depends only on the linear algebra library <a href="http://eigen.tuxfamily.org">Eigen</a>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install libeigen3-dev
</code></pre></div>
<p>The other packages depend additionally on the <a href="http://www.ros.org">ROS</a> standard installation (<em>roscpp</em>, <em>tf</em>, <em>filters</em>, <em>sensor_msgs</em>, <em>nav_msgs</em>, and <em>cv_bridge</em>). Other format specific conversion packages (e.g. <em>grid_map_cv</em>, <em>grid_map_pcl</em> etc.) depend on packages described below in <em>Packages Overview</em>.</p>

<h4 id="building">Building</h4>

<p>To build from source, clone the latest version from this repository into your catkin workspace and compile the package using</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd catkin_ws/src
git clone https://github.com/anybotics/grid_map.git
cd ../
catkin_make
</code></pre></div>
<p>To maximize performance, make sure to build in <em>Release</em> mode. You can specify the build type by setting</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make -DCMAKE_BUILD_TYPE=Release
</code></pre></div>
<h3 id="packages-overview">Packages Overview</h3>

<p>This repository consists of following packages:</p>

<ul>
<li>
<strong><em>grid_map</em></strong> is the meta-package for the grid map library.</li>
<li>
<strong><em>grid_map_core</em></strong> implements the algorithms of the grid map library. It provides the <code>GridMap</code> class and several helper classes such as the iterators. This package is implemented without <a href="http://www.ros.org">ROS</a> dependencies.</li>
<li>
<strong><em>grid_map_ros</em></strong> is the main package for <a href="http://www.ros.org">ROS</a> dependent projects using the grid map library. It provides the interfaces to convert grid maps from and to several <a href="http://www.ros.org">ROS</a> message types.</li>
<li>
<strong><em>grid_map_demos</em></strong> contains several nodes for demonstration purposes.</li>
<li>
<strong><em>grid_map_filters</em></strong> builds on the <a href="http://wiki.ros.org/filters">ROS Filters</a> package to process grid maps as a sequence of filters.</li>
<li>
<strong><em>grid_map_msgs</em></strong> holds the <a href="http://www.ros.org">ROS</a> message and service definitions around the [grid_map_msg/GridMap] message type.</li>
<li>
<strong><em>grid_map_rviz_plugin</em></strong> is an <a href="http://wiki.ros.org/rviz">RViz</a> plugin to visualize grid maps as 3d surface plots (height maps).</li>
<li>
<strong><em>grid_map_visualization</em></strong> contains a node written to convert GridMap messages to other <a href="http://www.ros.org">ROS</a> message types for example for  visualization in <a href="http://wiki.ros.org/rviz">RViz</a>.</li>
</ul>

<p>Additional conversion packages:</p>

<ul>
<li>
<strong><em>grid_map_costmap_2d</em></strong> provides conversions of grid maps from <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a> map types.</li>
<li>
<strong><em>grid_map_cv</em></strong> provides conversions of grid maps from and to <a href="http://opencv.org/">OpenCV</a> image types.</li>
<li>
<strong><em>grid_map_octomap</em></strong> provides conversions of grid maps from OctoMap (<a href="https://octomap.github.io/">OctoMap</a>) maps.</li>
<li>
<strong><em>grid_map_pcl</em></strong> provides conversions of grid maps from Point Cloud Library (<a href="http://pointclouds.org/">PCL</a>) polygon meshes.</li>
</ul>

<h3 id="unit-tests">Unit Tests</h3>

<p>Run the unit tests with</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make run_tests_grid_map_core run_tests_grid_map_ros
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin build grid_map --no-deps --verbose --catkin-make-args run_tests
</code></pre></div>
<p>if you are using <a href="http://catkin-tools.readthedocs.org/">catkin tools</a>.</p>

<h2 id="usage">Usage</h2>

<h3 id="demonstrations">Demonstrations</h3>

<p>The <em>grid_map_demos</em> package contains several demonstration nodes. Use this code to verify your installation of the grid map packages and to get you started with your own usage of the library.</p>

<ul>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/simple_demo_node.cpp">simple_demo</a></em> demonstrates a simple example for using the grid map library. This ROS node creates a grid map, adds data to it, and publishes it. To see the result in RViz, execute the command</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos simple_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/tutorial_demo_node.cpp">tutorial_demo</a></em> is an extended demonstration of the library's functionalities. Launch the <em>tutorial_demo</em> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos tutorial_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> showcases the usage of the grid map iterators. Launch it with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos iterators_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/ImageToGridmapDemo.cpp">image_to_gridmap_demo</a></em> demonstrates how to convert data from an <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/data/eth_logo.png">image</a> to a grid map. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos image_to_gridmap_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/image_to_grid_map_demo_result.png" alt="Image to grid map demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/opencv_demo_node.cpp">opencv_demo</a></em> demonstrates map manipulations with help of <a href="http://opencv.org/">OpenCV</a> functions. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos opencv_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/opencv_demo_result.gif" alt="OpenCV demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/resolution_change_demo_node.cpp">resolution_change_demo</a></em> shows how the resolution of a grid map can be changed with help of the <a href="http://opencv.org/">OpenCV</a> image scaling methods. The see the results, use</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos resolution_change_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/FiltersDemo.cpp">filters_demo</a></em> uses a chain of <a href="http://wiki.ros.org/filters">ROS Filters</a> to process a grid map. Starting from the elevation of a terrain map, the demo uses several filters to show how to compute surface normals, use inpainting to fill holes, smoothen/blur the map, and use math expressions to detect edges, compute roughness and traversability. The filter chain setup is configured in the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/filters_demo_filter_chain.yaml"><code>filters_demo_filter_chain.yaml</code></a> file. Launch the demo with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos filters_demo.launch
</code></pre></div>
<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/doc/filters_demo.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/filters_demo_preview.gif" alt="Filters demo results"></a></p>
</li>
</ul>

<p>For more information about grid map filters, see <a href="https://github.com/anybotics/grid_map/tree/master/#grid_map_filters">grid_map_filters</a>.</p>

<h3 id="conventions-definitions">Conventions &amp; Definitions</h3>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_layers.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_layers.png" alt="Grid map layers"></a></p>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_conventions.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_conventions.png" alt="Grid map conventions"></a></p>

<h3 id="iterators">Iterators</h3>

<p>The grid map library contains various iterators for convenience.</p>

<table>
<thead>
<tr>
<th style="text-align: center">Grid map</th>
<th style="text-align: center">Submap</th>
<th style="text-align: center">Circle</th>
<th style="text-align: center">Line</th>
<th style="text-align: center">Polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/grid_map_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/grid_map_iterator_preview.gif" alt="Grid map iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/submap_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/submap_iterator_preview.gif" alt="Submap iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/circle_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/circle_iterator_preview.gif" alt="Circle iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/line_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/line_iterator_preview.gif" alt="Line iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/polygon_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/polygon_iterator_preview.gif" alt="Polygon iterator"></a></td>
</tr>
<tr>
<td style="text-align: center"><strong>Ellipse</strong></td>
<td style="text-align: center"><strong>Spiral</strong></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/ellipse_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/ellipse_iterator_preview.gif" alt="Ellipse iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/spiral_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/spiral_iterator_preview.gif" alt="Spiral iterator"></a></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<p>Using the iterator in a <code>for</code> loop is common. For example, iterate over the entire grid map with the <code>GridMapIterator</code> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">for (grid_map::GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    cout &lt;&lt; "The value at index " &lt;&lt; (*iterator).transpose() &lt;&lt; " is " &lt;&lt; map.at("layer", *iterator) &lt;&lt; endl;
}
</code></pre></div>
<p>The other grid map iterators follow the same form. You can find more examples on how to use the different iterators in the <em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> node.</p>

<p>Note: For maximum efficiency when using iterators, it is recommended to locally store direct access to the data layers of the grid map with <code>grid_map::Matrix&amp; data = map["layer"]</code> outside the <code>for</code> loop:</p>
<div class="highlight"><pre><code class="language-" data-lang="">grid_map::Matrix&amp; data = map["layer"];
for (GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    const Index index(*iterator);
    cout &lt;&lt; "The value at index " &lt;&lt; index.transpose() &lt;&lt; " is " &lt;&lt; data(index(0), index(1)) &lt;&lt; endl;
}
</code></pre></div>
<p>You can find a benchmarking of the performance of the iterators in the <code>iterator_benchmark</code> node of the <code>grid_map_demos</code> package which can be run with</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun grid_map_demos iterator_benchmark
</code></pre></div>
<p>Beware that while iterators are convenient, it is often the cleanest and most efficient to make use of the built-in <a href="http://eigen.tuxfamily.org">Eigen</a> methods. Here are some examples:</p>

<ul>
<li>
<p>Setting a constant value to all cells of a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"].setConstant(3.0);
</code></pre></div>
</li>
<li>
<p>Adding two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["sum"] = map["layer_1"] + map["layer_2"];
</code></pre></div>
</li>
<li>
<p>Scaling a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"] = 2.0 * map["layer"];
</code></pre></div>
</li>
<li>
<p>Max. values between two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["max"] = map["layer_1"].cwiseMax(map["layer_2"]);
</code></pre></div>
</li>
<li>
<p>Compute the root mean squared error:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map.add("error", (map.get("layer_1") - map.get("layer_2")).cwiseAbs());
unsigned int nCells = map.getSize().prod();
double rootMeanSquaredError = sqrt((map["error"].array().pow(2).sum()) / nCells);
</code></pre></div>
</li>
</ul>

<h3 id="changing-the-position-of-the-map">Changing the Position of the Map</h3>

<p>There are two different methods to change the position of the map:
* <code>setPosition(...)</code>: Changes the position of the map without changing data stored in the map. This changes the corresponce between the data and the map frame.
* <code>move(...)</code>: Relocates the grid map such that the corresponce between data and the map frame does not change. Data in the overlapping region before and after the position change remains stored. Data that falls outside of the map at its new position is discarded. Cells that cover previously unknown regions are emptied (set to nan). The data storage is implemented as two-dimensional circular buffer to minimize computational effort.</p>

<table>
<thead>
<tr>
<th style="text-align: center"><code>setPosition(...)</code></th>
<th style="text-align: center"><code>move(...)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/setposition_method.gif" alt="Grid map iterator"></td>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/move_method.gif" alt="Submap iterator"></td>
</tr>
</tbody>
</table>

<h2 id="packages">Packages</h2>

<h3 id="grid_map_rviz_plugin">grid_map_rviz_plugin</h3>

<p>This <a href="http://wiki.ros.org/rviz">RViz</a> plugin visualizes a grid map layer as 3d surface plot (height map). A separate layer can be chosen as layer for the color information.</p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin.png" alt="Grid map visualization in RViz"></p>

<h3 id="grid_map_visualization">grid_map_visualization</h3>

<p>This node subscribes to a topic of type <a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a> and publishes messages that can be visualized in <a href="http://wiki.ros.org/rviz">RViz</a>. The published topics of the visualizer can be fully configure with a YAML parameter file. Any number of visualizations with different parameters can be added. An example is <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">here</a> for the configuration file of the <em>tutorial_demo</em>.</p>

<table>
<thead>
<tr>
<th>Point cloud</th>
<th>Vectors</th>
<th>Occupancy grid</th>
<th>Grid cells</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/point_cloud.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/point_cloud_preview.jpg" alt="Point cloud"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/vectors.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/vectors_preview.jpg" alt="Vectors"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/occupancy_grid.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/occupancy_grid_preview.jpg" alt="Occupancy grid"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/grid_cells.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/grid_cells_preview.jpg" alt="Grid cells"></a></td>
</tr>
</tbody>
</table>

<h4 id="parameters">Parameters</h4>

<ul>
<li>
<p><strong><code>grid_map_topic</code></strong> (string, default: "/grid_map")</p>

<p>The name of the grid map topic to be visualized. See below for the description of the visualizers.</p>
</li>
</ul>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li>
<p><strong><code>/grid_map</code></strong> (<a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a>)</p>

<p>The grid map to visualize.</p>
</li>
</ul>

<h4 id="published-topics">Published Topics</h4>

<p>The published topics are configured with the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">YAML parameter file</a>. Possible topics are:</p>

<ul>
<li>
<p><strong><code>point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a point cloud. Select which layer to transform as points with the <code>layer</code> parameter.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation
type: point_cloud
params:
 layer: elevation
 flat: false # optional
</code></pre></div>
</li>
<li>
<p><strong><code>flat_point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a "flat" point cloud, i.e. with all points at the same height <em>z</em>. This is convenient to visualize 2d maps or images (or even video streams) in <a href="http://wiki.ros.org/rviz">RViz</a> with help of its <code>Color Transformer</code>. The parameter <code>height</code> determines the desired <em>z</em>-position of the flat point cloud.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: flat_grid
type: flat_point_cloud
params:
 height: 0.0
</code></pre></div>
<p>Note: In order to omit points in the flat point cloud from empty/invalid cells, specify the layers which should be checked for validity with <code>setBasicLayers(...)</code>.</p>
</li>
<li>
<p><strong><code>vectors</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Visualizes vector data of the grid map as visual markers. Specify the layers which hold the <em>x</em>-, <em>y</em>-, and <em>z</em>-components of the vectors with the <code>layer_prefix</code> parameter. The parameter <code>position_layer</code> defines the layer to be used as start point of the vectors.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: vectors
params:
 layer_prefix: normal_
 position_layer: elevation
 scale: 0.06
 line_width: 0.005
 color: 15600153 # red
</code></pre></div>
</li>
<li>
<p><strong><code>occupancy_grid</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/OccupancyGrid.html">nav_msgs/OccupancyGrid</a>)</p>

<p>Visualizes a layer of the grid map as occupancy grid. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bound with <code>data_min</code> and <code>data_max</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: traversability_grid
type: occupancy_grid
params:
 layer: traversability
 data_min: -0.15
 data_max: 0.15
</code></pre></div>
</li>
<li>
<p><strong><code>grid_cells</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/GridCells.html">nav_msgs/GridCells</a>)</p>

<p>Visualizes a layer of the grid map as grid cells. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bounds with <code>lower_threshold</code> and <code>upper_threshold</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation_cells
type: grid_cells
params:
 layer: elevation
 lower_threshold: -0.08 # optional, default: -inf
 upper_threshold: 0.08 # optional, default: inf
</code></pre></div>
</li>
<li>
<p><strong><code>region</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Shows the boundary of the grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: map_region
type: map_region
params:
 color: 3289650
 line_width: 0.003
</code></pre></div>
</li>
</ul>

<p><em>Note: Color values are in RGB form as concatenated integers (for each channel value 0-255). The values can be generated like <a href="http://www.wolframalpha.com/input/?i=BitOr%5BBitShiftLeft%5Br%2C16%5D%2C+BitShiftLeft%5Bg%2C8%5D%2C+b%5D+where+%7Br%3D0%2C+g%3D255%2C+b%3D0%7D">this</a> as an example for the color green (red: 0, green: 255, blue: 0).</em></p>

<h3 id="grid_map_filters">grid_map_filters</h3>

<p>The <em>grid_map_filters</em> package containts several filters which can be applied a grid map to perform computations on the data in the layers. The grid map filters are based on <a href="http://wiki.ros.org/filters">ROS Filters</a>, which means that a chain of filters can be configured as a YAML file. Furthermore, additional filters can be written and made available through the ROS plugin mechanism, such as the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_cv/include/grid_map_cv/InpaintFilter.hpp"><code>InpaintFilter</code></a> from the <code>grid_map_cv</code> package.</p>

<p>Several basic filters are provided in the <em>grid_map_filters</em> package:</p>

<ul>
<li>
<p><strong><code>gridMapFilters/ThresholdFilter</code></strong></p>

<p>Set values below/above a threshold to a specified value.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: lower_threshold
type: gridMapFilters/ThresholdFilter
params:
  layer: layer_name
  lower_threshold: 0.0 # alternative: upper_threshold
  set_to: 0.0 # # Other uses: .nan, .inf
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MeanInRadiusFilter</code></strong></p>

<p>Compute for each cell of a layer the mean value inside a radius.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: mean_in_radius
type: gridMapFilters/MeanInRadiusFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.06 # in m.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalVectorsFilter</code></strong></p>

<p>Compute the normal vectors of a layer in a map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalVectorsFilter
params:
  input_layer: input
  output_layers_prefix: normal_vectors_
  radius: 0.05
  normal_vector_positive_axis: z
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalColorMapFilter</code></strong></p>

<p>Compute a new color layer based on normal vectors layers.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalColorMapFilter
params:
  input_layers_prefix: normal_vectors_
  output_layer: normal_color
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression with layers of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/MathExpressionFilter
params:
  output_layer: output
  expression: acos(normal_vectors_z) # Slope.
  # expression: abs(elevation - elevation_smooth) # Surface roughness.
  # expression: 0.5 * (1.0 - (slope / 0.6)) + 0.5 * (1.0 - (roughness / 0.1)) # Weighted and normalized sum.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/SlidingWindowMathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression within a sliding window on a layer of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/SlidingWindowMathExpressionFilter
params:
  input_layer: input
  output_layer: output
  expression: meanOfFinites(input) # Box blur
  # expression: sqrt(sumOfFinites(square(input - meanOfFinites(input))) ./ numberOfFinites(input)) # Standard deviation
  # expression: 'sumOfFinites([0,-1,0;-1,5,-1;0,-1,0].*elevation_inpainted)' # Sharpen with kernel matrix
  compute_empty_cells: true
  edge_handling: crop # options: inside, crop, empty, mean
  window_size: 5 # in number of cells (optional, default: 3), make sure to make this compatible with the kernel matrix
  # window_length: 0.05 # instead of window_size, in m
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DuplicationFilter</code></strong></p>

<p>Duplicate a layer of a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: duplicate
type: gridMapFilters/DuplicationFilter
params:
  input_layer: input
  output_layer: output
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DeletionFilter</code></strong></p>

<p>Delete layers from a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: delete
type: gridMapFilters/DeletionFilter
params:
  layers: [color, score] # List of layers.
</code></pre></div>
</li>
</ul>

<p>Additionally, the <em>grid_map_cv</em> package provides the following filters:</p>

<ul>
<li>
<p><strong><code>gridMapCv/InpaintFilter</code></strong></p>

<p>Use OpenCV to inpaint/fill holes in a layer.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: inpaint
type: gridMapCv/InpaintFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.05 # in m
</code></pre></div>
</li>
</ul>

<h2 id="build-status">Build Status</h2>

<h3 id="devel-job-status">Devel Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Idev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdev__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdev__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
<tr>
<td>doc</td>
<td><a href="http://build.ros.org/job/Idoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdoc__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdoc__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h3 id="release-job-status">Release Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_core</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_ros</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_msgs</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_rviz_plugin</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_visualization</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_filters</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_loader</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_demos</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please report bugs and request features using the <a href="https://github.com/anybotics/grid_map/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-kinetic">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/anybotics/grid_map.git">https://github.com/anybotics/grid_map.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-07
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/grid_map/github-anybotics-grid_map">grid_map</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_core/github-anybotics-grid_map">grid_map_core</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_costmap_2d/github-anybotics-grid_map">grid_map_costmap_2d</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_cv/github-anybotics-grid_map">grid_map_cv</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_demos/github-anybotics-grid_map">grid_map_demos</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_filters/github-anybotics-grid_map">grid_map_filters</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_loader/github-anybotics-grid_map">grid_map_loader</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_msgs/github-anybotics-grid_map">grid_map_msgs</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_octomap/github-anybotics-grid_map">grid_map_octomap</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_pcl/github-anybotics-grid_map">grid_map_pcl</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_ros/github-anybotics-grid_map">grid_map_ros</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_rviz_plugin/github-anybotics-grid_map">grid_map_rviz_plugin</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_sdf/github-anybotics-grid_map">grid_map_sdf</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_visualization/github-anybotics-grid_map">grid_map_visualization</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="grid-map">Grid Map</h1>

<h2 id="overview">Overview</h2>

<p>This is a C++ library with <a href="http://www.ros.org">ROS</a> interface to manage two-dimensional grid maps with multiple data layers. It is designed for mobile robotic mapping to store data such as elevation, variance, color, friction coefficient, foothold quality, surface normal, traversability etc. It is used in the <a href="https://github.com/anybotics/elevation_mapping">Robot-Centric Elevation Mapping</a> package designed for rough terrain navigation.</p>

<p>Features:</p>

<ul>
<li>
<strong>Multi-layered:</strong> Developed for universal 2.5-dimensional grid mapping with support for any number of layers.</li>
<li>
<strong>Efficient map re-positioning:</strong> Data storage is implemented as two-dimensional circular buffer. This allows for non-destructive shifting of the map's position (e.g. to follow the robot) without copying data in memory.</li>
<li>
<strong>Based on Eigen:</strong> Grid map data is stored as <a href="http://eigen.tuxfamily.org">Eigen</a> data types. Users can apply available Eigen algorithms directly to the map data for versatile and efficient data manipulation.</li>
<li>
<strong>Convenience functions:</strong> Several helper methods allow for convenient and memory safe cell data access. For example, iterator functions for rectangular, circular, polygonal regions and lines are implemented.</li>
<li>
<strong>ROS interface:</strong> Grid maps can be directly converted to and from ROS message types such as PointCloud2, OccupancyGrid, GridCells, and our custom GridMap message. Conversion packages provide compatibility with <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a>, <a href="http://pointclouds.org/">PCL</a>, and <a href="https://octomap.github.io/">OctoMap</a> data types.</li>
<li>
<strong>OpenCV interface:</strong> Grid maps can be seamlessly converted from and to <a href="http://opencv.org/">OpenCV</a> image types to make use of the tools provided by <a href="http://opencv.org/">OpenCV</a>.</li>
<li>
<strong>Visualizations:</strong> The <em>grid_map_rviz_plugin</em> renders grid maps as 3d surface plots (height maps) in <a href="http://wiki.ros.org/rviz">RViz</a>. Additionally, the <em>grid_map_visualization</em> package helps to visualize grid maps as point clouds, occupancy grids, grid cells etc.</li>
<li>
<strong>Filters:</strong> The <em>grid_map_filters</em> provides are range of filters to process grid maps as a sequence of filters. Parsing of mathematical expressions allows to flexibly setup powerful computations such as thresholding, normal vectors, smoothening, variance, inpainting, and matrix kernel convolutions.</li>
</ul>

<p>The grid map package has been tested with <a href="http://www.ros.org">ROS</a> Indigo, Jade (under Ubuntu 14.04) and Kinetic (under Ubuntu 16.04). This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed.</p>

<p>The source code is released under a <a href="https://github.com/anybotics/grid_map/tree/master/LICENSE">BSD 3-Clause license</a>.</p>

<p><strong>Author: Péter Fankhauser<br>
Affiliation: <a href="https://www.anybotics.com/">ANYbotics</a><br>
Maintainer: Péter Fankhauser, <a href="mailto:pfankhauser@anybotics.com">pfankhauser@anybotics.com</a><br></strong>
With contributions by: Tanja Baumann, Jeff Delmerico, Remo Diethelm, Perry Franklin, Dominic Jud, Ralph Kaestner, Philipp Krüsi, Alex Millane, Daniel Stonier, Elena Stumm, Martin Wermelinger, Christos Zalidis</p>

<p>This projected was initially developed at ETH Zurich (Autonomous Systems Lab &amp; Robotic Systems Lab).</p>

<p><a href="https://www.anymal-research.org/">This work is conducted as part of ANYmal Research, a community to advance legged robotics.</a></p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin_example.png" alt="Grid map example in RViz"></p>

<h2 id="publications">Publications</h2>

<p>If you use this work in an academic context, please cite the following publication:</p>

<blockquote>
<p>P. Fankhauser and M. Hutter,
<strong>"A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation"</strong>,
in Robot Operating System (ROS) – The Complete Reference (Volume 1), A. Koubaa (Ed.), Springer, 2016. (<a href="http://www.researchgate.net/publication/284415855">PDF</a>)</p>
</blockquote>
<div class="highlight"><pre><code class="language-" data-lang="">@incollection{Fankhauser2016GridMapLibrary,
  author = {Fankhauser, P{\'{e}}ter and Hutter, Marco},
  booktitle = {Robot Operating System (ROS) – The Complete Reference (Volume 1)},
  title = {{A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation}},
  chapter = {5},
  editor = {Koubaa, Anis},
  publisher = {Springer},
  year = {2016},
  isbn = {978-3-319-26052-5},
  doi = {10.1007/978-3-319-26054-9{\_}5},
  url = {http://www.springer.com/de/book/9783319260525}
}
</code></pre></div>
<h2 id="documentation">Documentation</h2>

<p>An introduction to the grid map library including a tutorial is given in <a href="http://www.researchgate.net/publication/284415855">this book chapter</a>.</p>

<p>The C++ API is documented here:
* <a href="http://docs.ros.org/kinetic/api/grid_map_core/html/index.html">grid_map_core</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_ros/html/index.html">grid_map_ros</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_costmap_2d/html/index.html">grid_map_costmap_2d</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_cv/html/index.html">grid_map_cv</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_filters/html/index.html">grid_map_filters</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_octomap/html/index.html">grid_map_octomap</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_pcl/html/index.html">grid_map_pcl</a></p>

<h2 id="installation">Installation</h2>

<h3 id="installation-from-packages">Installation from Packages</h3>

<p>To install all packages from the grid map library as Debian packages use</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install ros-kinetic-grid-map
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<h4 id="dependencies">Dependencies</h4>

<p>The <em>grid_map_core</em> package depends only on the linear algebra library <a href="http://eigen.tuxfamily.org">Eigen</a>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install libeigen3-dev
</code></pre></div>
<p>The other packages depend additionally on the <a href="http://www.ros.org">ROS</a> standard installation (<em>roscpp</em>, <em>tf</em>, <em>filters</em>, <em>sensor_msgs</em>, <em>nav_msgs</em>, and <em>cv_bridge</em>). Other format specific conversion packages (e.g. <em>grid_map_cv</em>, <em>grid_map_pcl</em> etc.) depend on packages described below in <em>Packages Overview</em>.</p>

<h4 id="building">Building</h4>

<p>To build from source, clone the latest version from this repository into your catkin workspace and compile the package using</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd catkin_ws/src
git clone https://github.com/anybotics/grid_map.git
cd ../
catkin_make
</code></pre></div>
<p>To maximize performance, make sure to build in <em>Release</em> mode. You can specify the build type by setting</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make -DCMAKE_BUILD_TYPE=Release
</code></pre></div>
<h3 id="packages-overview">Packages Overview</h3>

<p>This repository consists of following packages:</p>

<ul>
<li>
<strong><em>grid_map</em></strong> is the meta-package for the grid map library.</li>
<li>
<strong><em>grid_map_core</em></strong> implements the algorithms of the grid map library. It provides the <code>GridMap</code> class and several helper classes such as the iterators. This package is implemented without <a href="http://www.ros.org">ROS</a> dependencies.</li>
<li>
<strong><em>grid_map_ros</em></strong> is the main package for <a href="http://www.ros.org">ROS</a> dependent projects using the grid map library. It provides the interfaces to convert grid maps from and to several <a href="http://www.ros.org">ROS</a> message types.</li>
<li>
<strong><em>grid_map_demos</em></strong> contains several nodes for demonstration purposes.</li>
<li>
<strong><em>grid_map_filters</em></strong> builds on the <a href="http://wiki.ros.org/filters">ROS Filters</a> package to process grid maps as a sequence of filters.</li>
<li>
<strong><em>grid_map_msgs</em></strong> holds the <a href="http://www.ros.org">ROS</a> message and service definitions around the [grid_map_msg/GridMap] message type.</li>
<li>
<strong><em>grid_map_rviz_plugin</em></strong> is an <a href="http://wiki.ros.org/rviz">RViz</a> plugin to visualize grid maps as 3d surface plots (height maps).</li>
<li>
<strong><em>grid_map_visualization</em></strong> contains a node written to convert GridMap messages to other <a href="http://www.ros.org">ROS</a> message types for example for  visualization in <a href="http://wiki.ros.org/rviz">RViz</a>.</li>
</ul>

<p>Additional conversion packages:</p>

<ul>
<li>
<strong><em>grid_map_costmap_2d</em></strong> provides conversions of grid maps from <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a> map types.</li>
<li>
<strong><em>grid_map_cv</em></strong> provides conversions of grid maps from and to <a href="http://opencv.org/">OpenCV</a> image types.</li>
<li>
<strong><em>grid_map_octomap</em></strong> provides conversions of grid maps from OctoMap (<a href="https://octomap.github.io/">OctoMap</a>) maps.</li>
<li>
<strong><em>grid_map_pcl</em></strong> provides conversions of grid maps from Point Cloud Library (<a href="http://pointclouds.org/">PCL</a>) polygon meshes.</li>
</ul>

<h3 id="unit-tests">Unit Tests</h3>

<p>Run the unit tests with</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make run_tests_grid_map_core run_tests_grid_map_ros
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin build grid_map --no-deps --verbose --catkin-make-args run_tests
</code></pre></div>
<p>if you are using <a href="http://catkin-tools.readthedocs.org/">catkin tools</a>.</p>

<h2 id="usage">Usage</h2>

<h3 id="demonstrations">Demonstrations</h3>

<p>The <em>grid_map_demos</em> package contains several demonstration nodes. Use this code to verify your installation of the grid map packages and to get you started with your own usage of the library.</p>

<ul>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/simple_demo_node.cpp">simple_demo</a></em> demonstrates a simple example for using the grid map library. This ROS node creates a grid map, adds data to it, and publishes it. To see the result in RViz, execute the command</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos simple_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/tutorial_demo_node.cpp">tutorial_demo</a></em> is an extended demonstration of the library's functionalities. Launch the <em>tutorial_demo</em> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos tutorial_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> showcases the usage of the grid map iterators. Launch it with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos iterators_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/ImageToGridmapDemo.cpp">image_to_gridmap_demo</a></em> demonstrates how to convert data from an <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/data/eth_logo.png">image</a> to a grid map. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos image_to_gridmap_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/image_to_grid_map_demo_result.png" alt="Image to grid map demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/opencv_demo_node.cpp">opencv_demo</a></em> demonstrates map manipulations with help of <a href="http://opencv.org/">OpenCV</a> functions. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos opencv_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/opencv_demo_result.gif" alt="OpenCV demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/resolution_change_demo_node.cpp">resolution_change_demo</a></em> shows how the resolution of a grid map can be changed with help of the <a href="http://opencv.org/">OpenCV</a> image scaling methods. The see the results, use</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos resolution_change_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/FiltersDemo.cpp">filters_demo</a></em> uses a chain of <a href="http://wiki.ros.org/filters">ROS Filters</a> to process a grid map. Starting from the elevation of a terrain map, the demo uses several filters to show how to compute surface normals, use inpainting to fill holes, smoothen/blur the map, and use math expressions to detect edges, compute roughness and traversability. The filter chain setup is configured in the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/filters_demo_filter_chain.yaml"><code>filters_demo_filter_chain.yaml</code></a> file. Launch the demo with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos filters_demo.launch
</code></pre></div>
<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/doc/filters_demo.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/filters_demo_preview.gif" alt="Filters demo results"></a></p>
</li>
</ul>

<p>For more information about grid map filters, see <a href="https://github.com/anybotics/grid_map/tree/master/#grid_map_filters">grid_map_filters</a>.</p>

<h3 id="conventions-definitions">Conventions &amp; Definitions</h3>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_layers.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_layers.png" alt="Grid map layers"></a></p>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_conventions.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_conventions.png" alt="Grid map conventions"></a></p>

<h3 id="iterators">Iterators</h3>

<p>The grid map library contains various iterators for convenience.</p>

<table>
<thead>
<tr>
<th style="text-align: center">Grid map</th>
<th style="text-align: center">Submap</th>
<th style="text-align: center">Circle</th>
<th style="text-align: center">Line</th>
<th style="text-align: center">Polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/grid_map_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/grid_map_iterator_preview.gif" alt="Grid map iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/submap_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/submap_iterator_preview.gif" alt="Submap iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/circle_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/circle_iterator_preview.gif" alt="Circle iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/line_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/line_iterator_preview.gif" alt="Line iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/polygon_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/polygon_iterator_preview.gif" alt="Polygon iterator"></a></td>
</tr>
<tr>
<td style="text-align: center"><strong>Ellipse</strong></td>
<td style="text-align: center"><strong>Spiral</strong></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/ellipse_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/ellipse_iterator_preview.gif" alt="Ellipse iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/spiral_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/spiral_iterator_preview.gif" alt="Spiral iterator"></a></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<p>Using the iterator in a <code>for</code> loop is common. For example, iterate over the entire grid map with the <code>GridMapIterator</code> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">for (grid_map::GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    cout &lt;&lt; "The value at index " &lt;&lt; (*iterator).transpose() &lt;&lt; " is " &lt;&lt; map.at("layer", *iterator) &lt;&lt; endl;
}
</code></pre></div>
<p>The other grid map iterators follow the same form. You can find more examples on how to use the different iterators in the <em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> node.</p>

<p>Note: For maximum efficiency when using iterators, it is recommended to locally store direct access to the data layers of the grid map with <code>grid_map::Matrix&amp; data = map["layer"]</code> outside the <code>for</code> loop:</p>
<div class="highlight"><pre><code class="language-" data-lang="">grid_map::Matrix&amp; data = map["layer"];
for (GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    const Index index(*iterator);
    cout &lt;&lt; "The value at index " &lt;&lt; index.transpose() &lt;&lt; " is " &lt;&lt; data(index(0), index(1)) &lt;&lt; endl;
}
</code></pre></div>
<p>You can find a benchmarking of the performance of the iterators in the <code>iterator_benchmark</code> node of the <code>grid_map_demos</code> package which can be run with</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun grid_map_demos iterator_benchmark
</code></pre></div>
<p>Beware that while iterators are convenient, it is often the cleanest and most efficient to make use of the built-in <a href="http://eigen.tuxfamily.org">Eigen</a> methods. Here are some examples:</p>

<ul>
<li>
<p>Setting a constant value to all cells of a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"].setConstant(3.0);
</code></pre></div>
</li>
<li>
<p>Adding two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["sum"] = map["layer_1"] + map["layer_2"];
</code></pre></div>
</li>
<li>
<p>Scaling a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"] = 2.0 * map["layer"];
</code></pre></div>
</li>
<li>
<p>Max. values between two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["max"] = map["layer_1"].cwiseMax(map["layer_2"]);
</code></pre></div>
</li>
<li>
<p>Compute the root mean squared error:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map.add("error", (map.get("layer_1") - map.get("layer_2")).cwiseAbs());
unsigned int nCells = map.getSize().prod();
double rootMeanSquaredError = sqrt((map["error"].array().pow(2).sum()) / nCells);
</code></pre></div>
</li>
</ul>

<h3 id="changing-the-position-of-the-map">Changing the Position of the Map</h3>

<p>There are two different methods to change the position of the map:
* <code>setPosition(...)</code>: Changes the position of the map without changing data stored in the map. This changes the corresponce between the data and the map frame.
* <code>move(...)</code>: Relocates the grid map such that the corresponce between data and the map frame does not change. Data in the overlapping region before and after the position change remains stored. Data that falls outside of the map at its new position is discarded. Cells that cover previously unknown regions are emptied (set to nan). The data storage is implemented as two-dimensional circular buffer to minimize computational effort.</p>

<table>
<thead>
<tr>
<th style="text-align: center"><code>setPosition(...)</code></th>
<th style="text-align: center"><code>move(...)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/setposition_method.gif" alt="Grid map iterator"></td>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/move_method.gif" alt="Submap iterator"></td>
</tr>
</tbody>
</table>

<h2 id="packages">Packages</h2>

<h3 id="grid_map_rviz_plugin">grid_map_rviz_plugin</h3>

<p>This <a href="http://wiki.ros.org/rviz">RViz</a> plugin visualizes a grid map layer as 3d surface plot (height map). A separate layer can be chosen as layer for the color information.</p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin.png" alt="Grid map visualization in RViz"></p>

<h3 id="grid_map_visualization">grid_map_visualization</h3>

<p>This node subscribes to a topic of type <a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a> and publishes messages that can be visualized in <a href="http://wiki.ros.org/rviz">RViz</a>. The published topics of the visualizer can be fully configure with a YAML parameter file. Any number of visualizations with different parameters can be added. An example is <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">here</a> for the configuration file of the <em>tutorial_demo</em>.</p>

<table>
<thead>
<tr>
<th>Point cloud</th>
<th>Vectors</th>
<th>Occupancy grid</th>
<th>Grid cells</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/point_cloud.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/point_cloud_preview.jpg" alt="Point cloud"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/vectors.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/vectors_preview.jpg" alt="Vectors"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/occupancy_grid.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/occupancy_grid_preview.jpg" alt="Occupancy grid"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/grid_cells.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/grid_cells_preview.jpg" alt="Grid cells"></a></td>
</tr>
</tbody>
</table>

<h4 id="parameters">Parameters</h4>

<ul>
<li>
<p><strong><code>grid_map_topic</code></strong> (string, default: "/grid_map")</p>

<p>The name of the grid map topic to be visualized. See below for the description of the visualizers.</p>
</li>
</ul>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li>
<p><strong><code>/grid_map</code></strong> (<a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a>)</p>

<p>The grid map to visualize.</p>
</li>
</ul>

<h4 id="published-topics">Published Topics</h4>

<p>The published topics are configured with the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">YAML parameter file</a>. Possible topics are:</p>

<ul>
<li>
<p><strong><code>point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a point cloud. Select which layer to transform as points with the <code>layer</code> parameter.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation
type: point_cloud
params:
 layer: elevation
 flat: false # optional
</code></pre></div>
</li>
<li>
<p><strong><code>flat_point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a "flat" point cloud, i.e. with all points at the same height <em>z</em>. This is convenient to visualize 2d maps or images (or even video streams) in <a href="http://wiki.ros.org/rviz">RViz</a> with help of its <code>Color Transformer</code>. The parameter <code>height</code> determines the desired <em>z</em>-position of the flat point cloud.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: flat_grid
type: flat_point_cloud
params:
 height: 0.0
</code></pre></div>
<p>Note: In order to omit points in the flat point cloud from empty/invalid cells, specify the layers which should be checked for validity with <code>setBasicLayers(...)</code>.</p>
</li>
<li>
<p><strong><code>vectors</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Visualizes vector data of the grid map as visual markers. Specify the layers which hold the <em>x</em>-, <em>y</em>-, and <em>z</em>-components of the vectors with the <code>layer_prefix</code> parameter. The parameter <code>position_layer</code> defines the layer to be used as start point of the vectors.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: vectors
params:
 layer_prefix: normal_
 position_layer: elevation
 scale: 0.06
 line_width: 0.005
 color: 15600153 # red
</code></pre></div>
</li>
<li>
<p><strong><code>occupancy_grid</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/OccupancyGrid.html">nav_msgs/OccupancyGrid</a>)</p>

<p>Visualizes a layer of the grid map as occupancy grid. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bound with <code>data_min</code> and <code>data_max</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: traversability_grid
type: occupancy_grid
params:
 layer: traversability
 data_min: -0.15
 data_max: 0.15
</code></pre></div>
</li>
<li>
<p><strong><code>grid_cells</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/GridCells.html">nav_msgs/GridCells</a>)</p>

<p>Visualizes a layer of the grid map as grid cells. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bounds with <code>lower_threshold</code> and <code>upper_threshold</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation_cells
type: grid_cells
params:
 layer: elevation
 lower_threshold: -0.08 # optional, default: -inf
 upper_threshold: 0.08 # optional, default: inf
</code></pre></div>
</li>
<li>
<p><strong><code>region</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Shows the boundary of the grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: map_region
type: map_region
params:
 color: 3289650
 line_width: 0.003
</code></pre></div>
</li>
</ul>

<p><em>Note: Color values are in RGB form as concatenated integers (for each channel value 0-255). The values can be generated like <a href="http://www.wolframalpha.com/input/?i=BitOr%5BBitShiftLeft%5Br%2C16%5D%2C+BitShiftLeft%5Bg%2C8%5D%2C+b%5D+where+%7Br%3D0%2C+g%3D255%2C+b%3D0%7D">this</a> as an example for the color green (red: 0, green: 255, blue: 0).</em></p>

<h3 id="grid_map_filters">grid_map_filters</h3>

<p>The <em>grid_map_filters</em> package containts several filters which can be applied a grid map to perform computations on the data in the layers. The grid map filters are based on <a href="http://wiki.ros.org/filters">ROS Filters</a>, which means that a chain of filters can be configured as a YAML file. Furthermore, additional filters can be written and made available through the ROS plugin mechanism, such as the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_cv/include/grid_map_cv/InpaintFilter.hpp"><code>InpaintFilter</code></a> from the <code>grid_map_cv</code> package.</p>

<p>Several basic filters are provided in the <em>grid_map_filters</em> package:</p>

<ul>
<li>
<p><strong><code>gridMapFilters/ThresholdFilter</code></strong></p>

<p>Set values below/above a threshold to a specified value.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: lower_threshold
type: gridMapFilters/ThresholdFilter
params:
  layer: layer_name
  lower_threshold: 0.0 # alternative: upper_threshold
  set_to: 0.0 # # Other uses: .nan, .inf
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MeanInRadiusFilter</code></strong></p>

<p>Compute for each cell of a layer the mean value inside a radius.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: mean_in_radius
type: gridMapFilters/MeanInRadiusFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.06 # in m.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalVectorsFilter</code></strong></p>

<p>Compute the normal vectors of a layer in a map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalVectorsFilter
params:
  input_layer: input
  output_layers_prefix: normal_vectors_
  radius: 0.05
  normal_vector_positive_axis: z
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalColorMapFilter</code></strong></p>

<p>Compute a new color layer based on normal vectors layers.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalColorMapFilter
params:
  input_layers_prefix: normal_vectors_
  output_layer: normal_color
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression with layers of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/MathExpressionFilter
params:
  output_layer: output
  expression: acos(normal_vectors_z) # Slope.
  # expression: abs(elevation - elevation_smooth) # Surface roughness.
  # expression: 0.5 * (1.0 - (slope / 0.6)) + 0.5 * (1.0 - (roughness / 0.1)) # Weighted and normalized sum.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/SlidingWindowMathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression within a sliding window on a layer of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/SlidingWindowMathExpressionFilter
params:
  input_layer: input
  output_layer: output
  expression: meanOfFinites(input) # Box blur
  # expression: sqrt(sumOfFinites(square(input - meanOfFinites(input))) ./ numberOfFinites(input)) # Standard deviation
  # expression: 'sumOfFinites([0,-1,0;-1,5,-1;0,-1,0].*elevation_inpainted)' # Sharpen with kernel matrix
  compute_empty_cells: true
  edge_handling: crop # options: inside, crop, empty, mean
  window_size: 5 # in number of cells (optional, default: 3), make sure to make this compatible with the kernel matrix
  # window_length: 0.05 # instead of window_size, in m
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DuplicationFilter</code></strong></p>

<p>Duplicate a layer of a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: duplicate
type: gridMapFilters/DuplicationFilter
params:
  input_layer: input
  output_layer: output
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DeletionFilter</code></strong></p>

<p>Delete layers from a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: delete
type: gridMapFilters/DeletionFilter
params:
  layers: [color, score] # List of layers.
</code></pre></div>
</li>
</ul>

<p>Additionally, the <em>grid_map_cv</em> package provides the following filters:</p>

<ul>
<li>
<p><strong><code>gridMapCv/InpaintFilter</code></strong></p>

<p>Use OpenCV to inpaint/fill holes in a layer.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: inpaint
type: gridMapCv/InpaintFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.05 # in m
</code></pre></div>
</li>
</ul>

<h2 id="build-status">Build Status</h2>

<h3 id="devel-job-status">Devel Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Idev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdev__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdev__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
<tr>
<td>doc</td>
<td><a href="http://build.ros.org/job/Idoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdoc__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdoc__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h3 id="release-job-status">Release Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_core</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_ros</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_msgs</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_rviz_plugin</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_visualization</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_filters</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_loader</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_demos</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please report bugs and request features using the <a href="https://github.com/anybotics/grid_map/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/anybotics/grid_map.git">https://github.com/anybotics/grid_map.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2018-08-07
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/grid_map/github-anybotics-grid_map">grid_map</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_core/github-anybotics-grid_map">grid_map_core</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_costmap_2d/github-anybotics-grid_map">grid_map_costmap_2d</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_cv/github-anybotics-grid_map">grid_map_cv</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_demos/github-anybotics-grid_map">grid_map_demos</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_filters/github-anybotics-grid_map">grid_map_filters</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_loader/github-anybotics-grid_map">grid_map_loader</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_msgs/github-anybotics-grid_map">grid_map_msgs</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_octomap/github-anybotics-grid_map">grid_map_octomap</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_pcl/github-anybotics-grid_map">grid_map_pcl</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_ros/github-anybotics-grid_map">grid_map_ros</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_rviz_plugin/github-anybotics-grid_map">grid_map_rviz_plugin</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_sdf/github-anybotics-grid_map">grid_map_sdf</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/grid_map_visualization/github-anybotics-grid_map">grid_map_visualization</a></td>
                    <td>1.6.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="grid-map">Grid Map</h1>

<h2 id="overview">Overview</h2>

<p>This is a C++ library with <a href="http://www.ros.org">ROS</a> interface to manage two-dimensional grid maps with multiple data layers. It is designed for mobile robotic mapping to store data such as elevation, variance, color, friction coefficient, foothold quality, surface normal, traversability etc. It is used in the <a href="https://github.com/anybotics/elevation_mapping">Robot-Centric Elevation Mapping</a> package designed for rough terrain navigation.</p>

<p>Features:</p>

<ul>
<li>
<strong>Multi-layered:</strong> Developed for universal 2.5-dimensional grid mapping with support for any number of layers.</li>
<li>
<strong>Efficient map re-positioning:</strong> Data storage is implemented as two-dimensional circular buffer. This allows for non-destructive shifting of the map's position (e.g. to follow the robot) without copying data in memory.</li>
<li>
<strong>Based on Eigen:</strong> Grid map data is stored as <a href="http://eigen.tuxfamily.org">Eigen</a> data types. Users can apply available Eigen algorithms directly to the map data for versatile and efficient data manipulation.</li>
<li>
<strong>Convenience functions:</strong> Several helper methods allow for convenient and memory safe cell data access. For example, iterator functions for rectangular, circular, polygonal regions and lines are implemented.</li>
<li>
<strong>ROS interface:</strong> Grid maps can be directly converted to and from ROS message types such as PointCloud2, OccupancyGrid, GridCells, and our custom GridMap message. Conversion packages provide compatibility with <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a>, <a href="http://pointclouds.org/">PCL</a>, and <a href="https://octomap.github.io/">OctoMap</a> data types.</li>
<li>
<strong>OpenCV interface:</strong> Grid maps can be seamlessly converted from and to <a href="http://opencv.org/">OpenCV</a> image types to make use of the tools provided by <a href="http://opencv.org/">OpenCV</a>.</li>
<li>
<strong>Visualizations:</strong> The <em>grid_map_rviz_plugin</em> renders grid maps as 3d surface plots (height maps) in <a href="http://wiki.ros.org/rviz">RViz</a>. Additionally, the <em>grid_map_visualization</em> package helps to visualize grid maps as point clouds, occupancy grids, grid cells etc.</li>
<li>
<strong>Filters:</strong> The <em>grid_map_filters</em> provides are range of filters to process grid maps as a sequence of filters. Parsing of mathematical expressions allows to flexibly setup powerful computations such as thresholding, normal vectors, smoothening, variance, inpainting, and matrix kernel convolutions.</li>
</ul>

<p>The grid map package has been tested with <a href="http://www.ros.org">ROS</a> Indigo, Jade (under Ubuntu 14.04) and Kinetic (under Ubuntu 16.04). This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed.</p>

<p>The source code is released under a <a href="https://github.com/anybotics/grid_map/tree/master/LICENSE">BSD 3-Clause license</a>.</p>

<p><strong>Author: Péter Fankhauser<br>
Affiliation: <a href="https://www.anybotics.com/">ANYbotics</a><br>
Maintainer: Péter Fankhauser, <a href="mailto:pfankhauser@anybotics.com">pfankhauser@anybotics.com</a><br></strong>
With contributions by: Tanja Baumann, Jeff Delmerico, Remo Diethelm, Perry Franklin, Dominic Jud, Ralph Kaestner, Philipp Krüsi, Alex Millane, Daniel Stonier, Elena Stumm, Martin Wermelinger, Christos Zalidis</p>

<p>This projected was initially developed at ETH Zurich (Autonomous Systems Lab &amp; Robotic Systems Lab).</p>

<p><a href="https://www.anymal-research.org/">This work is conducted as part of ANYmal Research, a community to advance legged robotics.</a></p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin_example.png" alt="Grid map example in RViz"></p>

<h2 id="publications">Publications</h2>

<p>If you use this work in an academic context, please cite the following publication:</p>

<blockquote>
<p>P. Fankhauser and M. Hutter,
<strong>"A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation"</strong>,
in Robot Operating System (ROS) – The Complete Reference (Volume 1), A. Koubaa (Ed.), Springer, 2016. (<a href="http://www.researchgate.net/publication/284415855">PDF</a>)</p>
</blockquote>
<div class="highlight"><pre><code class="language-" data-lang="">@incollection{Fankhauser2016GridMapLibrary,
  author = {Fankhauser, P{\'{e}}ter and Hutter, Marco},
  booktitle = {Robot Operating System (ROS) – The Complete Reference (Volume 1)},
  title = {{A Universal Grid Map Library: Implementation and Use Case for Rough Terrain Navigation}},
  chapter = {5},
  editor = {Koubaa, Anis},
  publisher = {Springer},
  year = {2016},
  isbn = {978-3-319-26052-5},
  doi = {10.1007/978-3-319-26054-9{\_}5},
  url = {http://www.springer.com/de/book/9783319260525}
}
</code></pre></div>
<h2 id="documentation">Documentation</h2>

<p>An introduction to the grid map library including a tutorial is given in <a href="http://www.researchgate.net/publication/284415855">this book chapter</a>.</p>

<p>The C++ API is documented here:
* <a href="http://docs.ros.org/kinetic/api/grid_map_core/html/index.html">grid_map_core</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_ros/html/index.html">grid_map_ros</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_costmap_2d/html/index.html">grid_map_costmap_2d</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_cv/html/index.html">grid_map_cv</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_filters/html/index.html">grid_map_filters</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_octomap/html/index.html">grid_map_octomap</a>
* <a href="http://docs.ros.org/kinetic/api/grid_map_pcl/html/index.html">grid_map_pcl</a></p>

<h2 id="installation">Installation</h2>

<h3 id="installation-from-packages">Installation from Packages</h3>

<p>To install all packages from the grid map library as Debian packages use</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install ros-kinetic-grid-map
</code></pre></div>
<h3 id="building-from-source">Building from Source</h3>

<h4 id="dependencies">Dependencies</h4>

<p>The <em>grid_map_core</em> package depends only on the linear algebra library <a href="http://eigen.tuxfamily.org">Eigen</a>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">sudo apt-get install libeigen3-dev
</code></pre></div>
<p>The other packages depend additionally on the <a href="http://www.ros.org">ROS</a> standard installation (<em>roscpp</em>, <em>tf</em>, <em>filters</em>, <em>sensor_msgs</em>, <em>nav_msgs</em>, and <em>cv_bridge</em>). Other format specific conversion packages (e.g. <em>grid_map_cv</em>, <em>grid_map_pcl</em> etc.) depend on packages described below in <em>Packages Overview</em>.</p>

<h4 id="building">Building</h4>

<p>To build from source, clone the latest version from this repository into your catkin workspace and compile the package using</p>
<div class="highlight"><pre><code class="language-" data-lang="">cd catkin_ws/src
git clone https://github.com/anybotics/grid_map.git
cd ../
catkin_make
</code></pre></div>
<p>To maximize performance, make sure to build in <em>Release</em> mode. You can specify the build type by setting</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make -DCMAKE_BUILD_TYPE=Release
</code></pre></div>
<h3 id="packages-overview">Packages Overview</h3>

<p>This repository consists of following packages:</p>

<ul>
<li>
<strong><em>grid_map</em></strong> is the meta-package for the grid map library.</li>
<li>
<strong><em>grid_map_core</em></strong> implements the algorithms of the grid map library. It provides the <code>GridMap</code> class and several helper classes such as the iterators. This package is implemented without <a href="http://www.ros.org">ROS</a> dependencies.</li>
<li>
<strong><em>grid_map_ros</em></strong> is the main package for <a href="http://www.ros.org">ROS</a> dependent projects using the grid map library. It provides the interfaces to convert grid maps from and to several <a href="http://www.ros.org">ROS</a> message types.</li>
<li>
<strong><em>grid_map_demos</em></strong> contains several nodes for demonstration purposes.</li>
<li>
<strong><em>grid_map_filters</em></strong> builds on the <a href="http://wiki.ros.org/filters">ROS Filters</a> package to process grid maps as a sequence of filters.</li>
<li>
<strong><em>grid_map_msgs</em></strong> holds the <a href="http://www.ros.org">ROS</a> message and service definitions around the [grid_map_msg/GridMap] message type.</li>
<li>
<strong><em>grid_map_rviz_plugin</em></strong> is an <a href="http://wiki.ros.org/rviz">RViz</a> plugin to visualize grid maps as 3d surface plots (height maps).</li>
<li>
<strong><em>grid_map_visualization</em></strong> contains a node written to convert GridMap messages to other <a href="http://www.ros.org">ROS</a> message types for example for  visualization in <a href="http://wiki.ros.org/rviz">RViz</a>.</li>
</ul>

<p>Additional conversion packages:</p>

<ul>
<li>
<strong><em>grid_map_costmap_2d</em></strong> provides conversions of grid maps from <a href="http://wiki.ros.org/costmap_2d">costmap_2d</a> map types.</li>
<li>
<strong><em>grid_map_cv</em></strong> provides conversions of grid maps from and to <a href="http://opencv.org/">OpenCV</a> image types.</li>
<li>
<strong><em>grid_map_octomap</em></strong> provides conversions of grid maps from OctoMap (<a href="https://octomap.github.io/">OctoMap</a>) maps.</li>
<li>
<strong><em>grid_map_pcl</em></strong> provides conversions of grid maps from Point Cloud Library (<a href="http://pointclouds.org/">PCL</a>) polygon meshes.</li>
</ul>

<h3 id="unit-tests">Unit Tests</h3>

<p>Run the unit tests with</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin_make run_tests_grid_map_core run_tests_grid_map_ros
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-" data-lang="">catkin build grid_map --no-deps --verbose --catkin-make-args run_tests
</code></pre></div>
<p>if you are using <a href="http://catkin-tools.readthedocs.org/">catkin tools</a>.</p>

<h2 id="usage">Usage</h2>

<h3 id="demonstrations">Demonstrations</h3>

<p>The <em>grid_map_demos</em> package contains several demonstration nodes. Use this code to verify your installation of the grid map packages and to get you started with your own usage of the library.</p>

<ul>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/simple_demo_node.cpp">simple_demo</a></em> demonstrates a simple example for using the grid map library. This ROS node creates a grid map, adds data to it, and publishes it. To see the result in RViz, execute the command</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos simple_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/tutorial_demo_node.cpp">tutorial_demo</a></em> is an extended demonstration of the library's functionalities. Launch the <em>tutorial_demo</em> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos tutorial_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> showcases the usage of the grid map iterators. Launch it with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos iterators_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/ImageToGridmapDemo.cpp">image_to_gridmap_demo</a></em> demonstrates how to convert data from an <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/data/eth_logo.png">image</a> to a grid map. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos image_to_gridmap_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/image_to_grid_map_demo_result.png" alt="Image to grid map demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/opencv_demo_node.cpp">opencv_demo</a></em> demonstrates map manipulations with help of <a href="http://opencv.org/">OpenCV</a> functions. Start the demonstration with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos opencv_demo.launch
</code></pre></div>
<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/opencv_demo_result.gif" alt="OpenCV demo result"></p>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/resolution_change_demo_node.cpp">resolution_change_demo</a></em> shows how the resolution of a grid map can be changed with help of the <a href="http://opencv.org/">OpenCV</a> image scaling methods. The see the results, use</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos resolution_change_demo.launch
</code></pre></div>
</li>
<li>
<p><em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/FiltersDemo.cpp">filters_demo</a></em> uses a chain of <a href="http://wiki.ros.org/filters">ROS Filters</a> to process a grid map. Starting from the elevation of a terrain map, the demo uses several filters to show how to compute surface normals, use inpainting to fill holes, smoothen/blur the map, and use math expressions to detect edges, compute roughness and traversability. The filter chain setup is configured in the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/filters_demo_filter_chain.yaml"><code>filters_demo_filter_chain.yaml</code></a> file. Launch the demo with</p>
<div class="highlight"><pre><code class="language-" data-lang="">roslaunch grid_map_demos filters_demo.launch
</code></pre></div>
<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/doc/filters_demo.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_demos/doc/filters_demo_preview.gif" alt="Filters demo results"></a></p>
</li>
</ul>

<p>For more information about grid map filters, see <a href="https://github.com/anybotics/grid_map/tree/master/#grid_map_filters">grid_map_filters</a>.</p>

<h3 id="conventions-definitions">Conventions &amp; Definitions</h3>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_layers.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_layers.png" alt="Grid map layers"></a></p>

<p><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/grid_map_conventions.pdf"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/grid_map_conventions.png" alt="Grid map conventions"></a></p>

<h3 id="iterators">Iterators</h3>

<p>The grid map library contains various iterators for convenience.</p>

<table>
<thead>
<tr>
<th style="text-align: center">Grid map</th>
<th style="text-align: center">Submap</th>
<th style="text-align: center">Circle</th>
<th style="text-align: center">Line</th>
<th style="text-align: center">Polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/grid_map_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/grid_map_iterator_preview.gif" alt="Grid map iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/submap_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/submap_iterator_preview.gif" alt="Submap iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/circle_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/circle_iterator_preview.gif" alt="Circle iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/line_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/line_iterator_preview.gif" alt="Line iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/polygon_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/polygon_iterator_preview.gif" alt="Polygon iterator"></a></td>
</tr>
<tr>
<td style="text-align: center"><strong>Ellipse</strong></td>
<td style="text-align: center"><strong>Spiral</strong></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/ellipse_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/ellipse_iterator_preview.gif" alt="Ellipse iterator"></a></td>
<td style="text-align: center"><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_core/doc/iterators/spiral_iterator.gif"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/iterators/spiral_iterator_preview.gif" alt="Spiral iterator"></a></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<p>Using the iterator in a <code>for</code> loop is common. For example, iterate over the entire grid map with the <code>GridMapIterator</code> with</p>
<div class="highlight"><pre><code class="language-" data-lang="">for (grid_map::GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    cout &lt;&lt; "The value at index " &lt;&lt; (*iterator).transpose() &lt;&lt; " is " &lt;&lt; map.at("layer", *iterator) &lt;&lt; endl;
}
</code></pre></div>
<p>The other grid map iterators follow the same form. You can find more examples on how to use the different iterators in the <em><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/src/IteratorsDemo.cpp">iterators_demo</a></em> node.</p>

<p>Note: For maximum efficiency when using iterators, it is recommended to locally store direct access to the data layers of the grid map with <code>grid_map::Matrix&amp; data = map["layer"]</code> outside the <code>for</code> loop:</p>
<div class="highlight"><pre><code class="language-" data-lang="">grid_map::Matrix&amp; data = map["layer"];
for (GridMapIterator iterator(map); !iterator.isPastEnd(); ++iterator) {
    const Index index(*iterator);
    cout &lt;&lt; "The value at index " &lt;&lt; index.transpose() &lt;&lt; " is " &lt;&lt; data(index(0), index(1)) &lt;&lt; endl;
}
</code></pre></div>
<p>You can find a benchmarking of the performance of the iterators in the <code>iterator_benchmark</code> node of the <code>grid_map_demos</code> package which can be run with</p>
<div class="highlight"><pre><code class="language-" data-lang="">rosrun grid_map_demos iterator_benchmark
</code></pre></div>
<p>Beware that while iterators are convenient, it is often the cleanest and most efficient to make use of the built-in <a href="http://eigen.tuxfamily.org">Eigen</a> methods. Here are some examples:</p>

<ul>
<li>
<p>Setting a constant value to all cells of a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"].setConstant(3.0);
</code></pre></div>
</li>
<li>
<p>Adding two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["sum"] = map["layer_1"] + map["layer_2"];
</code></pre></div>
</li>
<li>
<p>Scaling a layer:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["layer"] = 2.0 * map["layer"];
</code></pre></div>
</li>
<li>
<p>Max. values between two layers:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map["max"] = map["layer_1"].cwiseMax(map["layer_2"]);
</code></pre></div>
</li>
<li>
<p>Compute the root mean squared error:</p>
<div class="highlight"><pre><code class="language-" data-lang="">map.add("error", (map.get("layer_1") - map.get("layer_2")).cwiseAbs());
unsigned int nCells = map.getSize().prod();
double rootMeanSquaredError = sqrt((map["error"].array().pow(2).sum()) / nCells);
</code></pre></div>
</li>
</ul>

<h3 id="changing-the-position-of-the-map">Changing the Position of the Map</h3>

<p>There are two different methods to change the position of the map:
* <code>setPosition(...)</code>: Changes the position of the map without changing data stored in the map. This changes the corresponce between the data and the map frame.
* <code>move(...)</code>: Relocates the grid map such that the corresponce between data and the map frame does not change. Data in the overlapping region before and after the position change remains stored. Data that falls outside of the map at its new position is discarded. Cells that cover previously unknown regions are emptied (set to nan). The data storage is implemented as two-dimensional circular buffer to minimize computational effort.</p>

<table>
<thead>
<tr>
<th style="text-align: center"><code>setPosition(...)</code></th>
<th style="text-align: center"><code>move(...)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/setposition_method.gif" alt="Grid map iterator"></td>
<td style="text-align: center"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_core/doc/move_method.gif" alt="Submap iterator"></td>
</tr>
</tbody>
</table>

<h2 id="packages">Packages</h2>

<h3 id="grid_map_rviz_plugin">grid_map_rviz_plugin</h3>

<p>This <a href="http://wiki.ros.org/rviz">RViz</a> plugin visualizes a grid map layer as 3d surface plot (height map). A separate layer can be chosen as layer for the color information.</p>

<p><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_rviz_plugin/doc/grid_map_rviz_plugin.png" alt="Grid map visualization in RViz"></p>

<h3 id="grid_map_visualization">grid_map_visualization</h3>

<p>This node subscribes to a topic of type <a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a> and publishes messages that can be visualized in <a href="http://wiki.ros.org/rviz">RViz</a>. The published topics of the visualizer can be fully configure with a YAML parameter file. Any number of visualizations with different parameters can be added. An example is <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">here</a> for the configuration file of the <em>tutorial_demo</em>.</p>

<table>
<thead>
<tr>
<th>Point cloud</th>
<th>Vectors</th>
<th>Occupancy grid</th>
<th>Grid cells</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/point_cloud.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/point_cloud_preview.jpg" alt="Point cloud"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/vectors.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/vectors_preview.jpg" alt="Vectors"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/occupancy_grid.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/occupancy_grid_preview.jpg" alt="Occupancy grid"></a></td>
<td><a href="https://github.com/anybotics/grid_map/tree/master/grid_map_visualization/doc/grid_cells.jpg"><img src="https://raw.githubusercontent.com/anybotics/grid_map/master/grid_map_visualization/doc/grid_cells_preview.jpg" alt="Grid cells"></a></td>
</tr>
</tbody>
</table>

<h4 id="parameters">Parameters</h4>

<ul>
<li>
<p><strong><code>grid_map_topic</code></strong> (string, default: "/grid_map")</p>

<p>The name of the grid map topic to be visualized. See below for the description of the visualizers.</p>
</li>
</ul>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<ul>
<li>
<p><strong><code>/grid_map</code></strong> (<a href="http://docs.ros.org/api/grid_map_msgs/html/msg/GridMap.html">grid_map_msgs/GridMap</a>)</p>

<p>The grid map to visualize.</p>
</li>
</ul>

<h4 id="published-topics">Published Topics</h4>

<p>The published topics are configured with the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_demos/config/tutorial_demo.yaml">YAML parameter file</a>. Possible topics are:</p>

<ul>
<li>
<p><strong><code>point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a point cloud. Select which layer to transform as points with the <code>layer</code> parameter.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation
type: point_cloud
params:
 layer: elevation
 flat: false # optional
</code></pre></div>
</li>
<li>
<p><strong><code>flat_point_cloud</code></strong> (<a href="http://docs.ros.org/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>

<p>Shows the grid map as a "flat" point cloud, i.e. with all points at the same height <em>z</em>. This is convenient to visualize 2d maps or images (or even video streams) in <a href="http://wiki.ros.org/rviz">RViz</a> with help of its <code>Color Transformer</code>. The parameter <code>height</code> determines the desired <em>z</em>-position of the flat point cloud.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: flat_grid
type: flat_point_cloud
params:
 height: 0.0
</code></pre></div>
<p>Note: In order to omit points in the flat point cloud from empty/invalid cells, specify the layers which should be checked for validity with <code>setBasicLayers(...)</code>.</p>
</li>
<li>
<p><strong><code>vectors</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Visualizes vector data of the grid map as visual markers. Specify the layers which hold the <em>x</em>-, <em>y</em>-, and <em>z</em>-components of the vectors with the <code>layer_prefix</code> parameter. The parameter <code>position_layer</code> defines the layer to be used as start point of the vectors.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: vectors
params:
 layer_prefix: normal_
 position_layer: elevation
 scale: 0.06
 line_width: 0.005
 color: 15600153 # red
</code></pre></div>
</li>
<li>
<p><strong><code>occupancy_grid</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/OccupancyGrid.html">nav_msgs/OccupancyGrid</a>)</p>

<p>Visualizes a layer of the grid map as occupancy grid. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bound with <code>data_min</code> and <code>data_max</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: traversability_grid
type: occupancy_grid
params:
 layer: traversability
 data_min: -0.15
 data_max: 0.15
</code></pre></div>
</li>
<li>
<p><strong><code>grid_cells</code></strong> (<a href="http://docs.ros.org/api/nav_msgs/html/msg/GridCells.html">nav_msgs/GridCells</a>)</p>

<p>Visualizes a layer of the grid map as grid cells. Specify the layer to be visualized with the <code>layer</code> parameter, and the upper and lower bounds with <code>lower_threshold</code> and <code>upper_threshold</code>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: elevation_cells
type: grid_cells
params:
 layer: elevation
 lower_threshold: -0.08 # optional, default: -inf
 upper_threshold: 0.08 # optional, default: inf
</code></pre></div>
</li>
<li>
<p><strong><code>region</code></strong> (<a href="http://docs.ros.org/api/visualization_msgs/html/msg/Marker.html">visualization_msgs/Marker</a>)</p>

<p>Shows the boundary of the grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: map_region
type: map_region
params:
 color: 3289650
 line_width: 0.003
</code></pre></div>
</li>
</ul>

<p><em>Note: Color values are in RGB form as concatenated integers (for each channel value 0-255). The values can be generated like <a href="http://www.wolframalpha.com/input/?i=BitOr%5BBitShiftLeft%5Br%2C16%5D%2C+BitShiftLeft%5Bg%2C8%5D%2C+b%5D+where+%7Br%3D0%2C+g%3D255%2C+b%3D0%7D">this</a> as an example for the color green (red: 0, green: 255, blue: 0).</em></p>

<h3 id="grid_map_filters">grid_map_filters</h3>

<p>The <em>grid_map_filters</em> package containts several filters which can be applied a grid map to perform computations on the data in the layers. The grid map filters are based on <a href="http://wiki.ros.org/filters">ROS Filters</a>, which means that a chain of filters can be configured as a YAML file. Furthermore, additional filters can be written and made available through the ROS plugin mechanism, such as the <a href="https://github.com/anybotics/grid_map/tree/master/grid_map_cv/include/grid_map_cv/InpaintFilter.hpp"><code>InpaintFilter</code></a> from the <code>grid_map_cv</code> package.</p>

<p>Several basic filters are provided in the <em>grid_map_filters</em> package:</p>

<ul>
<li>
<p><strong><code>gridMapFilters/ThresholdFilter</code></strong></p>

<p>Set values below/above a threshold to a specified value.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: lower_threshold
type: gridMapFilters/ThresholdFilter
params:
  layer: layer_name
  lower_threshold: 0.0 # alternative: upper_threshold
  set_to: 0.0 # # Other uses: .nan, .inf
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MeanInRadiusFilter</code></strong></p>

<p>Compute for each cell of a layer the mean value inside a radius.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: mean_in_radius
type: gridMapFilters/MeanInRadiusFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.06 # in m.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalVectorsFilter</code></strong></p>

<p>Compute the normal vectors of a layer in a map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalVectorsFilter
params:
  input_layer: input
  output_layers_prefix: normal_vectors_
  radius: 0.05
  normal_vector_positive_axis: z
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/NormalColorMapFilter</code></strong></p>

<p>Compute a new color layer based on normal vectors layers.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: surface_normals
type: gridMapFilters/NormalColorMapFilter
params:
  input_layers_prefix: normal_vectors_
  output_layer: normal_color
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/MathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression with layers of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/MathExpressionFilter
params:
  output_layer: output
  expression: acos(normal_vectors_z) # Slope.
  # expression: abs(elevation - elevation_smooth) # Surface roughness.
  # expression: 0.5 * (1.0 - (slope / 0.6)) + 0.5 * (1.0 - (roughness / 0.1)) # Weighted and normalized sum.
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/SlidingWindowMathExpressionFilter</code></strong></p>

<p>Parse and evaluate a mathematical matrix expression within a sliding window on a layer of a grid map. See <a href="https://github.com/leggedrobotics/EigenLab">EigenLab</a> for the documentation of the expressions.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: math_expression
type: gridMapFilters/SlidingWindowMathExpressionFilter
params:
  input_layer: input
  output_layer: output
  expression: meanOfFinites(input) # Box blur
  # expression: sqrt(sumOfFinites(square(input - meanOfFinites(input))) ./ numberOfFinites(input)) # Standard deviation
  # expression: 'sumOfFinites([0,-1,0;-1,5,-1;0,-1,0].*elevation_inpainted)' # Sharpen with kernel matrix
  compute_empty_cells: true
  edge_handling: crop # options: inside, crop, empty, mean
  window_size: 5 # in number of cells (optional, default: 3), make sure to make this compatible with the kernel matrix
  # window_length: 0.05 # instead of window_size, in m
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DuplicationFilter</code></strong></p>

<p>Duplicate a layer of a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: duplicate
type: gridMapFilters/DuplicationFilter
params:
  input_layer: input
  output_layer: output
</code></pre></div>
</li>
<li>
<p><strong><code>gridMapFilters/DeletionFilter</code></strong></p>

<p>Delete layers from a grid map.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: delete
type: gridMapFilters/DeletionFilter
params:
  layers: [color, score] # List of layers.
</code></pre></div>
</li>
</ul>

<p>Additionally, the <em>grid_map_cv</em> package provides the following filters:</p>

<ul>
<li>
<p><strong><code>gridMapCv/InpaintFilter</code></strong></p>

<p>Use OpenCV to inpaint/fill holes in a layer.</p>
<div class="highlight"><pre><code class="language-" data-lang="">name: inpaint
type: gridMapCv/InpaintFilter
params:
  input_layer: input
  output_layer: output
  radius: 0.05 # in m
</code></pre></div>
</li>
</ul>

<h2 id="build-status">Build Status</h2>

<h3 id="devel-job-status">Devel Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Idev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdev__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdev__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdev__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdev__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
<tr>
<td>doc</td>
<td><a href="http://build.ros.org/job/Idoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Idoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jdoc__grid_map__ubuntu_trusty_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Jdoc__grid_map__ubuntu_trusty_amd64" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kdoc__grid_map__ubuntu_xenial_amd64/"><img src="http://build.ros.org/buildStatus/icon?job=Kdoc__grid_map__ubuntu_xenial_amd64" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h3 id="release-job-status">Release Job Status</h3>

<table>
<thead>
<tr>
<th></th>
<th>Indigo</th>
<th>Jade</th>
<th>Kinetic</th>
</tr>
</thead>
<tbody>
<tr>
<td>grid_map</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_core</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_core__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_core__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_ros</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_ros__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_ros__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_msgs</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_msgs__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_msgs__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_rviz_plugin</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_rviz_plugin__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_rviz_plugin__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_visualization</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_visualization__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_visualization__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_filters</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_filters__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_filters__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_loader</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_loader__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_loader__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
<tr>
<td>grid_map_demos</td>
<td><a href="http://build.ros.org/job/Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Ibin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Jbin_uT64__grid_map_demos__ubuntu_trusty_amd64__binary" alt="Build Status"></a></td>
<td><a href="http://build.ros.org/job/Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary/"><img src="http://build.ros.org/buildStatus/icon?job=Kbin_uX64__grid_map_demos__ubuntu_xenial_amd64__binary" alt="Build Status"></a></td>
</tr>
</tbody>
</table>

<h2 id="bugs-feature-requests">Bugs &amp; Feature Requests</h2>

<p>Please report bugs and request features using the <a href="https://github.com/anybotics/grid_map/issues">Issue Tracker</a>.</p>
</div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-ardent">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>ardent</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("crystal");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/ros-infrastructure" title="Find rosindex in Github">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">ros-infrastructure</span>
          </a>
          |
          <em>generated on 2019-01-24</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
